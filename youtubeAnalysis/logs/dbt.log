[0m21:00:50.851890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eefa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f60940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f60760>]}


============================== 21:00:50.855647 | 086d7b84-11c8-46fb-9158-ce4cd32f3a3b ==============================
[0m21:00:50.855647 [info ] [MainThread]: Running with dbt=1.10.8
[0m21:00:50.855994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:50.864352 [info ] [MainThread]: dbt version: 1.10.8
[0m21:00:50.864599 [info ] [MainThread]: python version: 3.9.7
[0m21:00:50.864793 [info ] [MainThread]: python path: /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/venv/bin/python
[0m21:00:50.864974 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m21:00:52.649240 [info ] [MainThread]: Using profiles dir at /Users/divya21raj/.dbt
[0m21:00:52.649668 [info ] [MainThread]: Using profiles.yml file at /Users/divya21raj/.dbt/profiles.yml
[0m21:00:52.649975 [info ] [MainThread]: Using dbt_project.yml file at /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/dbt_project.yml
[0m21:00:52.650216 [info ] [MainThread]: adapter type: bigquery
[0m21:00:52.650401 [info ] [MainThread]: adapter version: 1.10.1
[0m21:00:52.708956 [info ] [MainThread]: Configuration:
[0m21:00:52.709281 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:00:52.709500 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:00:52.709695 [info ] [MainThread]: Required dependencies:
[0m21:00:52.709960 [debug] [MainThread]: Executing "git --help"
[0m21:00:52.734809 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:00:52.735388 [debug] [MainThread]: STDERR: "b''"
[0m21:00:52.735627 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:00:52.735858 [info ] [MainThread]: Connection:
[0m21:00:52.736159 [info ] [MainThread]:   method: service-account
[0m21:00:52.736334 [info ] [MainThread]:   database: third-flare-425403-c0
[0m21:00:52.736501 [info ] [MainThread]:   execution_project: third-flare-425403-c0
[0m21:00:52.736674 [info ] [MainThread]:   schema: youtubeAnalysis
[0m21:00:52.736835 [info ] [MainThread]:   location: US
[0m21:00:52.737007 [info ] [MainThread]:   priority: interactive
[0m21:00:52.737184 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:00:52.737346 [info ] [MainThread]:   impersonate_service_account: None
[0m21:00:52.737506 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:00:52.737686 [info ] [MainThread]:   job_retries: 1
[0m21:00:52.737847 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:00:52.738006 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m21:00:52.738164 [info ] [MainThread]:   timeout_seconds: 300
[0m21:00:52.738323 [info ] [MainThread]:   client_id: None
[0m21:00:52.738480 [info ] [MainThread]:   token_uri: None
[0m21:00:52.738637 [info ] [MainThread]:   compute_region: None
[0m21:00:52.738791 [info ] [MainThread]:   dataproc_cluster_name: None
[0m21:00:52.738948 [info ] [MainThread]:   gcs_bucket: None
[0m21:00:52.739105 [info ] [MainThread]:   dataproc_batch: None
[0m21:00:52.739492 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:00:52.898800 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:00:52.899161 [debug] [MainThread]: On debug: select 1 as id
[0m21:00:52.899375 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:53.568833 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:1d3eebe4-e0b2-45bb-b83f-40b7829ff561&page=queryresults
[0m21:00:54.061235 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:00:54.061793 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:00:54.064417 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.2615964, "process_in_blocks": "0", "process_kernel_time": 0.340379, "process_mem_max_rss": "337068032", "process_out_blocks": "0", "process_user_time": 1.949471}
[0m21:00:54.064872 [debug] [MainThread]: Command `dbt debug` succeeded at 21:00:54.064778 after 3.26 seconds
[0m21:00:54.065183 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:00:54.065497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eefa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba06670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b98ee20>]}
[0m21:00:54.065851 [debug] [MainThread]: Flushing usage events
[0m21:00:54.493868 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:31:00.784258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10364ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054bd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054bd670>]}


============================== 23:31:00.787275 | 9ce88104-b056-4d61-91ff-05e5c50a6443 ==============================
[0m23:31:00.787275 [info ] [MainThread]: Running with dbt=1.10.8
[0m23:31:00.787631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:00.796121 [info ] [MainThread]: dbt version: 1.10.8
[0m23:31:00.796360 [info ] [MainThread]: python version: 3.9.7
[0m23:31:00.796547 [info ] [MainThread]: python path: /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/venv/bin/python
[0m23:31:00.796725 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m23:31:02.849868 [info ] [MainThread]: Using profiles dir at /Users/divya21raj/.dbt
[0m23:31:02.850327 [info ] [MainThread]: Using profiles.yml file at /Users/divya21raj/.dbt/profiles.yml
[0m23:31:02.850557 [info ] [MainThread]: Using dbt_project.yml file at /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/dbt_project.yml
[0m23:31:02.850763 [info ] [MainThread]: adapter type: bigquery
[0m23:31:02.850952 [info ] [MainThread]: adapter version: 1.10.1
[0m23:31:02.910247 [info ] [MainThread]: Configuration:
[0m23:31:02.910556 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:31:02.910772 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:31:02.910983 [info ] [MainThread]: Required dependencies:
[0m23:31:02.911213 [debug] [MainThread]: Executing "git --help"
[0m23:31:02.934498 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:31:02.935141 [debug] [MainThread]: STDERR: "b''"
[0m23:31:02.935402 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:31:02.935629 [info ] [MainThread]: Connection:
[0m23:31:02.935892 [info ] [MainThread]:   method: service-account
[0m23:31:02.936062 [info ] [MainThread]:   database: third-flare-425403-c0
[0m23:31:02.936230 [info ] [MainThread]:   execution_project: third-flare-425403-c0
[0m23:31:02.936399 [info ] [MainThread]:   schema: youtubeDataAnalysis
[0m23:31:02.936560 [info ] [MainThread]:   location: US
[0m23:31:02.936724 [info ] [MainThread]:   priority: interactive
[0m23:31:02.936887 [info ] [MainThread]:   maximum_bytes_billed: None
[0m23:31:02.937053 [info ] [MainThread]:   impersonate_service_account: None
[0m23:31:02.937212 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m23:31:02.937372 [info ] [MainThread]:   job_retries: 1
[0m23:31:02.937535 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m23:31:02.937695 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m23:31:02.937856 [info ] [MainThread]:   timeout_seconds: 300
[0m23:31:02.938014 [info ] [MainThread]:   client_id: None
[0m23:31:02.938172 [info ] [MainThread]:   token_uri: None
[0m23:31:02.938331 [info ] [MainThread]:   compute_region: None
[0m23:31:02.938488 [info ] [MainThread]:   dataproc_cluster_name: None
[0m23:31:02.938645 [info ] [MainThread]:   gcs_bucket: None
[0m23:31:02.938809 [info ] [MainThread]:   dataproc_batch: None
[0m23:31:02.939334 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m23:31:03.127789 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m23:31:03.128183 [debug] [MainThread]: On debug: select 1 as id
[0m23:31:03.128406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:31:04.016421 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:175be6d0-5dcc-48cf-8699-6440a41427e7&page=queryresults
[0m23:31:04.492992 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:31:04.494294 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:31:04.509922 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.7822561, "process_in_blocks": "0", "process_kernel_time": 0.360803, "process_mem_max_rss": "337674240", "process_out_blocks": "0", "process_user_time": 1.946798}
[0m23:31:04.510956 [debug] [MainThread]: Command `dbt debug` succeeded at 23:31:04.510780 after 3.78 seconds
[0m23:31:04.511561 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:31:04.512147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10364ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eadbc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eb6b820>]}
[0m23:31:04.512714 [debug] [MainThread]: Flushing usage events
[0m23:31:04.965267 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:22.259641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041386a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ab5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ab3d0>]}


============================== 15:06:22.262291 | aa249c93-f2a9-44d5-8129-f27786f1bdbe ==============================
[0m15:06:22.262291 [info ] [MainThread]: Running with dbt=1.10.8
[0m15:06:22.262673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:06:22.330086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa249c93-f2a9-44d5-8129-f27786f1bdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105235790>]}
[0m15:06:22.338064 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:06:22.338483 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:06:22.340423 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13109687, "process_in_blocks": "0", "process_kernel_time": 0.070911, "process_mem_max_rss": "101253120", "process_out_blocks": "0", "process_user_time": 0.794057}
[0m15:06:22.340681 [debug] [MainThread]: Command `cli deps` succeeded at 15:06:22.340623 after 0.13 seconds
[0m15:06:22.340882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041386a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105638130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105482a30>]}
[0m15:06:22.341084 [debug] [MainThread]: Flushing usage events
[0m15:06:22.781191 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:00.615821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dda6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e4d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e4d370>]}


============================== 15:42:00.619983 | 183c0ada-9be7-423b-b791-1caf17c6c678 ==============================
[0m15:42:00.619983 [info ] [MainThread]: Running with dbt=1.10.8
[0m15:42:00.620358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'profiles_dir': '/Users/divya21raj/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:42:00.628835 [info ] [MainThread]: dbt version: 1.10.8
[0m15:42:00.629114 [info ] [MainThread]: python version: 3.9.7
[0m15:42:00.629310 [info ] [MainThread]: python path: /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/venv/bin/python
[0m15:42:00.629517 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m15:42:02.421618 [info ] [MainThread]: Using profiles dir at /Users/divya21raj/.dbt
[0m15:42:02.422046 [info ] [MainThread]: Using profiles.yml file at /Users/divya21raj/.dbt/profiles.yml
[0m15:42:02.422284 [info ] [MainThread]: Using dbt_project.yml file at /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/dbt_project.yml
[0m15:42:02.422482 [info ] [MainThread]: adapter type: bigquery
[0m15:42:02.422663 [info ] [MainThread]: adapter version: 1.10.1
[0m15:42:02.480906 [info ] [MainThread]: Configuration:
[0m15:42:02.481263 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:42:02.481464 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:42:02.481648 [info ] [MainThread]: Required dependencies:
[0m15:42:02.481879 [debug] [MainThread]: Executing "git --help"
[0m15:42:02.529609 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:42:02.533738 [debug] [MainThread]: STDERR: "b''"
[0m15:42:02.534070 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:42:02.534317 [info ] [MainThread]: Connection:
[0m15:42:02.534617 [info ] [MainThread]:   method: service-account
[0m15:42:02.534798 [info ] [MainThread]:   database: third-flare-425403-c0
[0m15:42:02.534969 [info ] [MainThread]:   execution_project: third-flare-425403-c0
[0m15:42:02.535139 [info ] [MainThread]:   schema: youtubeDataAnalysis
[0m15:42:02.535303 [info ] [MainThread]:   location: US
[0m15:42:02.535467 [info ] [MainThread]:   priority: interactive
[0m15:42:02.535628 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:42:02.535790 [info ] [MainThread]:   impersonate_service_account: None
[0m15:42:02.535953 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:42:02.536169 [info ] [MainThread]:   job_retries: 1
[0m15:42:02.536332 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:42:02.536490 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:42:02.536676 [info ] [MainThread]:   timeout_seconds: 300
[0m15:42:02.536834 [info ] [MainThread]:   client_id: None
[0m15:42:02.536994 [info ] [MainThread]:   token_uri: None
[0m15:42:02.537154 [info ] [MainThread]:   compute_region: None
[0m15:42:02.537314 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:42:02.537473 [info ] [MainThread]:   gcs_bucket: None
[0m15:42:02.537635 [info ] [MainThread]:   dataproc_batch: None
[0m15:42:02.538073 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m15:42:02.703607 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:42:02.703981 [debug] [MainThread]: On debug: select 1 as id
[0m15:42:02.704200 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:03.413415 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:18357db5-893a-4585-9d70-51681c032373&page=queryresults
[0m15:42:04.163102 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:42:04.163950 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:42:04.168515 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.6006572, "process_in_blocks": "0", "process_kernel_time": 0.349896, "process_mem_max_rss": "333201408", "process_out_blocks": "0", "process_user_time": 1.955135}
[0m15:42:04.169613 [debug] [MainThread]: Command `dbt debug` succeeded at 15:42:04.169284 after 3.60 seconds
[0m15:42:04.170528 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:42:04.171206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dda6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f507c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1409cbb50>]}
[0m15:42:04.171901 [debug] [MainThread]: Flushing usage events
[0m15:42:04.644631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:51:48.972120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ca640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a3f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a3f640>]}


============================== 15:51:48.977612 | 63449bb8-1a7d-4380-97d6-2b16e588bbce ==============================
[0m15:51:48.977612 [info ] [MainThread]: Running with dbt=1.10.8
[0m15:51:48.977972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:51:50.937774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63449bb8-1a7d-4380-97d6-2b16e588bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b39c250>]}
[0m15:51:50.970469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63449bb8-1a7d-4380-97d6-2b16e588bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a0f820>]}
[0m15:51:50.970863 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m15:51:51.143670 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m15:51:51.205769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:51:51.206052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:51:51.209846 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.example
[0m15:51:51.224699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63449bb8-1a7d-4380-97d6-2b16e588bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b95a130>]}
[0m15:51:51.266688 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m15:51:51.270482 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m15:51:51.281633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63449bb8-1a7d-4380-97d6-2b16e588bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b97dfa0>]}
[0m15:51:51.281941 [info ] [MainThread]: Found 1 model, 496 macros
[0m15:51:51.282162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63449bb8-1a7d-4380-97d6-2b16e588bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b49a5b0>]}
[0m15:51:51.282866 [info ] [MainThread]: 
[0m15:51:51.283093 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:51:51.283268 [info ] [MainThread]: 
[0m15:51:51.283551 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:51:51.284089 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m15:51:51.284339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:51.773432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m15:51:51.773990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:52.238910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63449bb8-1a7d-4380-97d6-2b16e588bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b49a5b0>]}
[0m15:51:52.239905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:52.245244 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m15:51:52.246067 [info ] [Thread-1  ]: 1 of 1 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m15:51:52.246724 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_videos)
[0m15:51:52.247246 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m15:51:52.259810 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m15:51:52.260829 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m15:51:52.285559 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m15:51:52.286299 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS
(
    SELECT * FROM `youtubeDataAnalysis.video_data`
);


[0m15:51:52.286638 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:51:52.713528 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:5bd6b472-1b9e-438d-ab88-b89107f6921b&page=queryresults
[0m15:51:52.715023 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:5bd6b472-1b9e-438d-ab88-b89107f6921b&page=queryresults
[0m15:51:52.725980 [debug] [Thread-1  ]: Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Unexpected ";" at [9:2]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m15:51:52.728974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63449bb8-1a7d-4380-97d6-2b16e588bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba4f5b0>]}
[0m15:51:52.729944 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model youtubeDataAnalysis.src_videos ............ [[31mERROR[0m in 0.48s]
[0m15:51:52.730712 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m15:51:52.731442 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.src_videos' to be skipped because of status 'error'.  Reason: Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Unexpected ";" at [9:2]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql.
[0m15:51:52.732886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:51:52.734711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:52.735064 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m15:51:52.735427 [info ] [MainThread]: 
[0m15:51:52.736039 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m15:51:52.736763 [debug] [MainThread]: Command end result
[0m15:51:52.761234 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m15:51:52.762396 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m15:51:52.767095 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m15:51:52.767341 [info ] [MainThread]: 
[0m15:51:52.767620 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:51:52.767951 [info ] [MainThread]: 
[0m15:51:52.768260 [error] [MainThread]: [31mFailure in model src_videos (models/staging/src_videos.sql)[0m
[0m15:51:52.768519 [error] [MainThread]:   Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Unexpected ";" at [9:2]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m15:51:52.768727 [info ] [MainThread]: 
[0m15:51:52.768964 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/staging/src_videos.sql
[0m15:51:52.769164 [info ] [MainThread]: 
[0m15:51:52.769386 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:51:52.771525 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.8489559, "process_in_blocks": "0", "process_kernel_time": 0.35106, "process_mem_max_rss": "344113152", "process_out_blocks": "0", "process_user_time": 2.269662}
[0m15:51:52.771815 [debug] [MainThread]: Command `dbt run` failed at 15:51:52.771761 after 3.85 seconds
[0m15:51:52.772107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ca640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b973970>]}
[0m15:51:52.772363 [debug] [MainThread]: Flushing usage events
[0m15:51:53.191477 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:41.820484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de6670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5b8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5b700>]}


============================== 15:52:41.823819 | 8024d89f-8b0e-47fe-a215-a625eca7d911 ==============================
[0m15:52:41.823819 [info ] [MainThread]: Running with dbt=1.10.8
[0m15:52:41.824162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:52:43.366868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8024d89f-8b0e-47fe-a215-a625eca7d911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13081f880>]}
[0m15:52:43.402300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8024d89f-8b0e-47fe-a215-a625eca7d911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106701a60>]}
[0m15:52:43.402690 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m15:52:43.584511 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m15:52:43.644838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:52:43.645065 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:52:43.648702 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.example
[0m15:52:43.663717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8024d89f-8b0e-47fe-a215-a625eca7d911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e9b130>]}
[0m15:52:43.706886 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m15:52:43.708448 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m15:52:43.723368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8024d89f-8b0e-47fe-a215-a625eca7d911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130ebfa60>]}
[0m15:52:43.723683 [info ] [MainThread]: Found 1 model, 496 macros
[0m15:52:43.723934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8024d89f-8b0e-47fe-a215-a625eca7d911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130920160>]}
[0m15:52:43.724651 [info ] [MainThread]: 
[0m15:52:43.724866 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:52:43.725039 [info ] [MainThread]: 
[0m15:52:43.725336 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:52:43.725884 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m15:52:43.726141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:44.191549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m15:52:44.192429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:44.714919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8024d89f-8b0e-47fe-a215-a625eca7d911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13082a280>]}
[0m15:52:44.716624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:52:44.723675 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m15:52:44.724667 [info ] [Thread-1  ]: 1 of 1 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m15:52:44.725478 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_videos)
[0m15:52:44.726114 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m15:52:44.739867 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m15:52:44.741066 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m15:52:44.767910 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m15:52:44.768476 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS
(
    SELECT * FROM `youtubeDataAnalysis.video_data`
)
SELECT video_id FROM raw_videos;;


[0m15:52:44.768799 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:52:45.270981 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:c1d5f6fb-1ece-4ffc-8b18-169675f4b07e&page=queryresults
[0m15:52:45.272877 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:c1d5f6fb-1ece-4ffc-8b18-169675f4b07e&page=queryresults
[0m15:52:45.285479 [debug] [Thread-1  ]: Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Unexpected ";" at [10:33]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m15:52:45.289396 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8024d89f-8b0e-47fe-a215-a625eca7d911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130f8eca0>]}
[0m15:52:45.290561 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model youtubeDataAnalysis.src_videos ............ [[31mERROR[0m in 0.56s]
[0m15:52:45.291350 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m15:52:45.292019 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.src_videos' to be skipped because of status 'error'.  Reason: Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Unexpected ";" at [10:33]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql.
[0m15:52:45.293501 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:52:45.295787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:45.296228 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m15:52:45.296658 [info ] [MainThread]: 
[0m15:52:45.297037 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m15:52:45.297872 [debug] [MainThread]: Command end result
[0m15:52:45.323602 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m15:52:45.324875 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m15:52:45.329626 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m15:52:45.329883 [info ] [MainThread]: 
[0m15:52:45.330173 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:52:45.330425 [info ] [MainThread]: 
[0m15:52:45.330713 [error] [MainThread]: [31mFailure in model src_videos (models/staging/src_videos.sql)[0m
[0m15:52:45.330986 [error] [MainThread]:   Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Unexpected ";" at [10:33]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m15:52:45.331200 [info ] [MainThread]: 
[0m15:52:45.331452 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/staging/src_videos.sql
[0m15:52:45.331660 [info ] [MainThread]: 
[0m15:52:45.331896 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:52:45.333525 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5582318, "process_in_blocks": "0", "process_kernel_time": 0.295188, "process_mem_max_rss": "332759040", "process_out_blocks": "0", "process_user_time": 2.268979}
[0m15:52:45.333810 [debug] [MainThread]: Command `dbt run` failed at 15:52:45.333758 after 3.56 seconds
[0m15:52:45.334076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de6670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106701a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130eb00d0>]}
[0m15:52:45.334329 [debug] [MainThread]: Flushing usage events
[0m15:52:45.703814 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:53:48.645202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3a670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119ae670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119ae490>]}


============================== 15:53:48.648296 | be8504d7-fed5-4177-bb00-ed019eec8584 ==============================
[0m15:53:48.648296 [info ] [MainThread]: Running with dbt=1.10.8
[0m15:53:48.648655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:53:50.527251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be8504d7-fed5-4177-bb00-ed019eec8584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c159400>]}
[0m15:53:50.559751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be8504d7-fed5-4177-bb00-ed019eec8584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111081220>]}
[0m15:53:50.560108 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m15:53:50.740006 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m15:53:50.811813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:53:50.812047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:53:50.815589 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.example
[0m15:53:50.830264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be8504d7-fed5-4177-bb00-ed019eec8584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c71b130>]}
[0m15:53:50.871378 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m15:53:50.872905 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m15:53:50.883829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be8504d7-fed5-4177-bb00-ed019eec8584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c733c40>]}
[0m15:53:50.884114 [info ] [MainThread]: Found 1 model, 496 macros
[0m15:53:50.884321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be8504d7-fed5-4177-bb00-ed019eec8584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c6d95b0>]}
[0m15:53:50.885016 [info ] [MainThread]: 
[0m15:53:50.885239 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:53:50.885411 [info ] [MainThread]: 
[0m15:53:50.885694 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:53:50.886199 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m15:53:50.886436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:51.326881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m15:53:51.327988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:51.754799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be8504d7-fed5-4177-bb00-ed019eec8584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c6d0940>]}
[0m15:53:51.755688 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:53:51.761428 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m15:53:51.762394 [info ] [Thread-1  ]: 1 of 1 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m15:53:51.763110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_videos)
[0m15:53:51.763684 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m15:53:51.773079 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m15:53:51.773714 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m15:53:51.794630 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m15:53:51.839643 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT * FROM `youtubeDataAnalysis.video_data`
)
SELECT
    video_id
FROM raw_videos;


[0m15:53:51.840029 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:53:52.482311 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:f67b78c7-3ac9-46a4-9e7b-0339a0c943c4&page=queryresults
[0m15:53:52.912574 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8504d7-fed5-4177-bb00-ed019eec8584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111968c70>]}
[0m15:53:52.913082 [info ] [Thread-1  ]: 1 of 1 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m15:53:52.913508 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m15:53:52.914171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:53:52.915234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:52.915446 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m15:53:52.915652 [info ] [MainThread]: 
[0m15:53:52.915889 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m15:53:52.916310 [debug] [MainThread]: Command end result
[0m15:53:52.934431 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m15:53:52.935633 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m15:53:52.946357 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m15:53:52.949175 [info ] [MainThread]: 
[0m15:53:52.955510 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:53:52.955725 [info ] [MainThread]: 
[0m15:53:52.956034 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:53:52.958479 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.364982, "process_in_blocks": "0", "process_kernel_time": 0.368606, "process_mem_max_rss": "344670208", "process_out_blocks": "0", "process_user_time": 2.272163}
[0m15:53:52.958777 [debug] [MainThread]: Command `dbt run` succeeded at 15:53:52.958719 after 4.37 seconds
[0m15:53:52.959038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3a670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111081220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c734af0>]}
[0m15:53:52.959297 [debug] [MainThread]: Flushing usage events
[0m15:53:53.383060 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:35.813655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077fe6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088737c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088735e0>]}


============================== 16:44:35.816965 | 8c652145-9781-4e6e-914d-9f7e0f77dc1d ==============================
[0m16:44:35.816965 [info ] [MainThread]: Running with dbt=1.10.8
[0m16:44:35.817333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:44:37.665351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c652145-9781-4e6e-914d-9f7e0f77dc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108855070>]}
[0m16:44:37.697899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c652145-9781-4e6e-914d-9f7e0f77dc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1448f14f0>]}
[0m16:44:37.698268 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:44:37.864828 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m16:44:37.927011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:37.927251 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:37.930870 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.example
[0m16:44:37.945814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c652145-9781-4e6e-914d-9f7e0f77dc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144d9a130>]}
[0m16:44:37.988827 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m16:44:37.993550 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m16:44:38.010443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c652145-9781-4e6e-914d-9f7e0f77dc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1448feee0>]}
[0m16:44:38.010723 [info ] [MainThread]: Found 1 model, 496 macros
[0m16:44:38.010936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c652145-9781-4e6e-914d-9f7e0f77dc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1449045e0>]}
[0m16:44:38.011591 [info ] [MainThread]: 
[0m16:44:38.011812 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:38.011988 [info ] [MainThread]: 
[0m16:44:38.012263 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:44:38.012769 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m16:44:38.013005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:38.500052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m16:44:38.501764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:38.916739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c652145-9781-4e6e-914d-9f7e0f77dc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f6460>]}
[0m16:44:38.918019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:38.925083 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m16:44:38.926154 [info ] [Thread-1  ]: 1 of 1 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m16:44:38.926752 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_videos)
[0m16:44:38.927038 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m16:44:38.937340 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m16:44:38.938116 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m16:44:38.965275 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m16:44:38.966321 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    defaultLanguage
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    IFNULL(
        CAST(
            REGEXP_EXTRACT(duration, r'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?') AS STRING
        ), 0
    ) AS duration(sec),
    dimension,
    definition,
    -- Convert caption to BOOLEAN
    CASE
        WHEN LOWER(caption) = 'true' THEN TRUE
        WHEN LOWER(caption) = 'false' THEN FALSE
        ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    country

FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m16:44:38.967064 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:44:39.421454 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:3708782e-af3e-4b41-bbe9-7d1a66bd2ee3&page=queryresults
[0m16:44:39.423267 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:3708782e-af3e-4b41-bbe9-7d1a66bd2ee3&page=queryresults
[0m16:44:39.435429 [debug] [Thread-1  ]: Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Expected ")" but got "(" at [18:11]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m16:44:39.438725 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c652145-9781-4e6e-914d-9f7e0f77dc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144e90460>]}
[0m16:44:39.439687 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model youtubeDataAnalysis.src_videos ............ [[31mERROR[0m in 0.51s]
[0m16:44:39.440356 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m16:44:39.441182 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.src_videos' to be skipped because of status 'error'.  Reason: Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Expected ")" but got "(" at [18:11]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql.
[0m16:44:39.442846 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:39.444728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:39.445082 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m16:44:39.446049 [info ] [MainThread]: 
[0m16:44:39.447091 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m16:44:39.448349 [debug] [MainThread]: Command end result
[0m16:44:39.475084 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m16:44:39.477041 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m16:44:39.482291 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m16:44:39.482522 [info ] [MainThread]: 
[0m16:44:39.482790 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:44:39.483009 [info ] [MainThread]: 
[0m16:44:39.483270 [error] [MainThread]: [31mFailure in model src_videos (models/staging/src_videos.sql)[0m
[0m16:44:39.483513 [error] [MainThread]:   Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Expected ")" but got "(" at [18:11]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m16:44:39.483707 [info ] [MainThread]: 
[0m16:44:39.483935 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/staging/src_videos.sql
[0m16:44:39.484129 [info ] [MainThread]: 
[0m16:44:39.484361 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:44:39.486708 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.7227156, "process_in_blocks": "0", "process_kernel_time": 0.379057, "process_mem_max_rss": "337559552", "process_out_blocks": "0", "process_user_time": 2.231381}
[0m16:44:39.487018 [debug] [MainThread]: Command `dbt run` failed at 16:44:39.486966 after 3.72 seconds
[0m16:44:39.487303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077fe6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144db3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108855070>]}
[0m16:44:39.487559 [debug] [MainThread]: Flushing usage events
[0m16:44:39.899610 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:49.842788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a726d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae76d0>]}


============================== 16:48:49.845792 | cda100e9-e1c8-473e-900d-80df7de858a5 ==============================
[0m16:48:49.845792 [info ] [MainThread]: Running with dbt=1.10.8
[0m16:48:49.846167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:48:51.676376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cda100e9-e1c8-473e-900d-80df7de858a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b41d3d0>]}
[0m16:48:51.708202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cda100e9-e1c8-473e-900d-80df7de858a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2eaf0>]}
[0m16:48:51.708539 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:48:51.888102 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m16:48:51.945268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:51.945508 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:51.949044 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.example
[0m16:48:51.963467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cda100e9-e1c8-473e-900d-80df7de858a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba1b130>]}
[0m16:48:52.009402 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m16:48:52.010930 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m16:48:52.022679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cda100e9-e1c8-473e-900d-80df7de858a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba36e50>]}
[0m16:48:52.023000 [info ] [MainThread]: Found 1 model, 496 macros
[0m16:48:52.023215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cda100e9-e1c8-473e-900d-80df7de858a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b573130>]}
[0m16:48:52.023887 [info ] [MainThread]: 
[0m16:48:52.024114 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:48:52.024289 [info ] [MainThread]: 
[0m16:48:52.024563 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:48:52.025085 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m16:48:52.025311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:52.493177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m16:48:52.494657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:52.929301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cda100e9-e1c8-473e-900d-80df7de858a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b573130>]}
[0m16:48:52.930687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:48:52.939345 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m16:48:52.940298 [info ] [Thread-1  ]: 1 of 1 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m16:48:52.941050 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_videos)
[0m16:48:52.941661 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m16:48:52.954670 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m16:48:52.955374 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m16:48:52.980934 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m16:48:52.981537 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    defaultLanguage
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    IFNULL(
        CAST(
            REGEXP_EXTRACT(duration, r'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?') AS STRING
        ), 0
    ) AS duration_sec,
    dimension,
    definition,
    -- Convert caption to BOOLEAN
    CASE
        WHEN LOWER(caption) = 'true' THEN TRUE
        WHEN LOWER(caption) = 'false' THEN FALSE
        ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    country

FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m16:48:52.981903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:48:53.394512 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:b951a387-78e0-4c06-9bdc-d389ef46ef28&page=queryresults
[0m16:48:53.396375 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:b951a387-78e0-4c06-9bdc-d389ef46ef28&page=queryresults
[0m16:48:53.407339 [debug] [Thread-1  ]: Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Expected ")" but got "(" at [18:11]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m16:48:53.410908 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cda100e9-e1c8-473e-900d-80df7de858a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb0ed60>]}
[0m16:48:53.411885 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model youtubeDataAnalysis.src_videos ............ [[31mERROR[0m in 0.47s]
[0m16:48:53.412639 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m16:48:53.413222 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.src_videos' to be skipped because of status 'error'.  Reason: Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Expected ")" but got "(" at [18:11]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql.
[0m16:48:53.414467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:48:53.416288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:53.416665 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m16:48:53.417025 [info ] [MainThread]: 
[0m16:48:53.417633 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m16:48:53.418547 [debug] [MainThread]: Command end result
[0m16:48:53.444439 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m16:48:53.445663 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m16:48:53.450483 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m16:48:53.450799 [info ] [MainThread]: 
[0m16:48:53.451080 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:48:53.451304 [info ] [MainThread]: 
[0m16:48:53.451574 [error] [MainThread]: [31mFailure in model src_videos (models/staging/src_videos.sql)[0m
[0m16:48:53.451825 [error] [MainThread]:   Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Expected ")" but got "(" at [18:11]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m16:48:53.452034 [info ] [MainThread]: 
[0m16:48:53.452270 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/staging/src_videos.sql
[0m16:48:53.452475 [info ] [MainThread]: 
[0m16:48:53.452693 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:48:53.454835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.6585488, "process_in_blocks": "0", "process_kernel_time": 0.361498, "process_mem_max_rss": "333234176", "process_out_blocks": "0", "process_user_time": 2.248025}
[0m16:48:53.455109 [debug] [MainThread]: Command `dbt run` failed at 16:48:53.455059 after 3.66 seconds
[0m16:48:53.455359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a726d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b49d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba30be0>]}
[0m16:48:53.455604 [debug] [MainThread]: Flushing usage events
[0m16:48:53.945216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:48.840554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055fe670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066728e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106672700>]}


============================== 16:50:48.843508 | df48d6ae-c074-4448-8786-cb79cb6be881 ==============================
[0m16:50:48.843508 [info ] [MainThread]: Running with dbt=1.10.8
[0m16:50:48.843871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:50:50.633451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df48d6ae-c074-4448-8786-cb79cb6be881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fd2250>]}
[0m16:50:50.665528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df48d6ae-c074-4448-8786-cb79cb6be881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd52d60>]}
[0m16:50:50.665876 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:50:50.840718 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m16:50:50.901424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:50.901666 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:50.905242 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.example
[0m16:50:50.919526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df48d6ae-c074-4448-8786-cb79cb6be881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11959a130>]}
[0m16:50:50.963294 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m16:50:50.964971 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m16:50:50.975471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df48d6ae-c074-4448-8786-cb79cb6be881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193db040>]}
[0m16:50:50.975755 [info ] [MainThread]: Found 1 model, 496 macros
[0m16:50:50.975967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df48d6ae-c074-4448-8786-cb79cb6be881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11955c520>]}
[0m16:50:50.976649 [info ] [MainThread]: 
[0m16:50:50.976873 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:50:50.977048 [info ] [MainThread]: 
[0m16:50:50.977321 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:50:50.977826 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m16:50:50.978058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:51.382172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m16:50:51.383497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:51.808594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df48d6ae-c074-4448-8786-cb79cb6be881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119060790>]}
[0m16:50:51.810089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:51.816734 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m16:50:51.817695 [info ] [Thread-1  ]: 1 of 1 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m16:50:51.818480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_videos)
[0m16:50:51.819101 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m16:50:51.832494 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m16:50:51.833716 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m16:50:51.860585 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m16:50:51.861303 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    defaultLanguage,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    IFNULL(
        CAST(
            REGEXP_EXTRACT(duration, r'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?') AS STRING
        ), 0
    ) AS duration_sec,
    dimension,
    definition,
    -- Convert caption to BOOLEAN
    CASE
        WHEN LOWER(caption) = 'true' THEN TRUE
        WHEN LOWER(caption) = 'false' THEN FALSE
        ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    country

FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m16:50:51.861708 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:50:52.570613 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:e208e85b-9df5-4b26-861b-7113fba59e90&page=queryresults
[0m16:50:52.764058 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:e208e85b-9df5-4b26-861b-7113fba59e90&page=queryresults
[0m16:50:52.776878 [debug] [Thread-1  ]: Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function IFNULL
    Argument types: STRING, INT64
    Signature: IFNULL(T1, T1)
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [18:5]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m16:50:52.780064 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df48d6ae-c074-4448-8786-cb79cb6be881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041edca0>]}
[0m16:50:52.781031 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model youtubeDataAnalysis.src_videos ............ [[31mERROR[0m in 0.96s]
[0m16:50:52.781718 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m16:50:52.782291 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.src_videos' to be skipped because of status 'error'.  Reason: Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function IFNULL
    Argument types: STRING, INT64
    Signature: IFNULL(T1, T1)
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [18:5]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql.
[0m16:50:52.783733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:52.785845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:52.786281 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m16:50:52.786673 [info ] [MainThread]: 
[0m16:50:52.787057 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.81 seconds (1.81s).
[0m16:50:52.787856 [debug] [MainThread]: Command end result
[0m16:50:52.813940 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m16:50:52.815100 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m16:50:52.819996 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m16:50:52.820230 [info ] [MainThread]: 
[0m16:50:52.820488 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:50:52.820728 [info ] [MainThread]: 
[0m16:50:52.820998 [error] [MainThread]: [31mFailure in model src_videos (models/staging/src_videos.sql)[0m
[0m16:50:52.821262 [error] [MainThread]:   Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function IFNULL
    Argument types: STRING, INT64
    Signature: IFNULL(T1, T1)
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [18:5]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m16:50:52.821475 [info ] [MainThread]: 
[0m16:50:52.821713 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/staging/src_videos.sql
[0m16:50:52.821912 [info ] [MainThread]: 
[0m16:50:52.822131 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:50:52.824244 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.0316515, "process_in_blocks": "0", "process_kernel_time": 0.359266, "process_mem_max_rss": "333840384", "process_out_blocks": "0", "process_user_time": 2.283214}
[0m16:50:52.824570 [debug] [MainThread]: Command `dbt run` failed at 16:50:52.824508 after 4.03 seconds
[0m16:50:52.824840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055fe670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fd2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193db3a0>]}
[0m16:50:52.825095 [debug] [MainThread]: Flushing usage events
[0m16:50:53.248668 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:10.574655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103be2640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c56820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c56640>]}


============================== 16:52:10.578248 | 31cf7d64-4b55-4ede-ac6c-b32c929e3cec ==============================
[0m16:52:10.578248 [info ] [MainThread]: Running with dbt=1.10.8
[0m16:52:10.578588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:52:12.355727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31cf7d64-4b55-4ede-ac6c-b32c929e3cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113588280>]}
[0m16:52:12.387644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31cf7d64-4b55-4ede-ac6c-b32c929e3cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be9a90>]}
[0m16:52:12.387985 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:52:12.557697 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m16:52:12.615045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:12.615309 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:12.618850 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.example
[0m16:52:12.633385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31cf7d64-4b55-4ede-ac6c-b32c929e3cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142c9a130>]}
[0m16:52:12.676038 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m16:52:12.677598 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m16:52:12.688010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31cf7d64-4b55-4ede-ac6c-b32c929e3cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142cac9d0>]}
[0m16:52:12.688288 [info ] [MainThread]: Found 1 model, 496 macros
[0m16:52:12.688500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31cf7d64-4b55-4ede-ac6c-b32c929e3cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142c56490>]}
[0m16:52:12.689167 [info ] [MainThread]: 
[0m16:52:12.689387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:12.689557 [info ] [MainThread]: 
[0m16:52:12.689830 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:52:12.690357 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m16:52:12.690588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:13.145808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m16:52:13.147234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:13.680309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31cf7d64-4b55-4ede-ac6c-b32c929e3cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cdb400>]}
[0m16:52:13.681911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:13.689145 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m16:52:13.690196 [info ] [Thread-1  ]: 1 of 1 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m16:52:13.691004 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_videos)
[0m16:52:13.691586 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m16:52:13.704686 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m16:52:13.705593 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m16:52:13.731934 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m16:52:13.732538 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    defaultLanguage,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    IFNULL(
        CAST(
            REGEXP_EXTRACT(duration, r'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?') AS STRING
        ), '0'
    ) AS duration_sec,
    dimension,
    definition,
    -- Convert caption to BOOLEAN
    CASE
        WHEN LOWER(caption) = 'true' THEN TRUE
        WHEN LOWER(caption) = 'false' THEN FALSE
        ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    country

FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m16:52:13.732923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:52:14.409320 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:c56907c5-6996-48d3-a13f-1316576a1476&page=queryresults
[0m16:52:14.889267 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31cf7d64-4b55-4ede-ac6c-b32c929e3cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142d8efa0>]}
[0m16:52:14.889756 [info ] [Thread-1  ]: 1 of 1 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m16:52:14.890132 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m16:52:14.890714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:52:14.891719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:14.891917 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m16:52:14.892112 [info ] [MainThread]: 
[0m16:52:14.892309 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m16:52:14.892684 [debug] [MainThread]: Command end result
[0m16:52:14.909082 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m16:52:14.910085 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m16:52:14.913825 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m16:52:14.914027 [info ] [MainThread]: 
[0m16:52:14.914281 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:52:14.914464 [info ] [MainThread]: 
[0m16:52:14.914660 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:52:14.916676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3898087, "process_in_blocks": "0", "process_kernel_time": 0.365905, "process_mem_max_rss": "342884352", "process_out_blocks": "0", "process_user_time": 2.298662}
[0m16:52:14.916911 [debug] [MainThread]: Command `dbt run` succeeded at 16:52:14.916866 after 4.39 seconds
[0m16:52:14.917127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103be2640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142cb2b80>]}
[0m16:52:14.917329 [debug] [MainThread]: Flushing usage events
[0m16:52:15.398263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:14.138317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182ee8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182ee6d0>]}


============================== 16:55:14.142785 | f61c1648-6be8-4044-ae90-4386f913fab7 ==============================
[0m16:55:14.142785 [info ] [MainThread]: Running with dbt=1.10.8
[0m16:55:14.143161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:55:16.038721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f61c1648-6be8-4044-ae90-4386f913fab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143324d90>]}
[0m16:55:16.072418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f61c1648-6be8-4044-ae90-4386f913fab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d537f0>]}
[0m16:55:16.073093 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:55:16.259910 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m16:55:16.334068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:16.334323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:16.337959 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.example
[0m16:55:16.351593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f61c1648-6be8-4044-ae90-4386f913fab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14399afa0>]}
[0m16:55:16.397483 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m16:55:16.399001 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m16:55:16.409843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f61c1648-6be8-4044-ae90-4386f913fab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1439afac0>]}
[0m16:55:16.410148 [info ] [MainThread]: Found 1 model, 496 macros
[0m16:55:16.410358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f61c1648-6be8-4044-ae90-4386f913fab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14395c520>]}
[0m16:55:16.411070 [info ] [MainThread]: 
[0m16:55:16.411299 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:16.411477 [info ] [MainThread]: 
[0m16:55:16.411762 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:55:16.412307 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m16:55:16.412565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:16.966926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m16:55:16.967640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:17.405958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f61c1648-6be8-4044-ae90-4386f913fab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1439ad670>]}
[0m16:55:17.407521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:17.413693 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m16:55:17.414705 [info ] [Thread-1  ]: 1 of 1 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m16:55:17.415428 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_videos)
[0m16:55:17.415942 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m16:55:17.428918 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m16:55:17.429867 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m16:55:17.455920 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m16:55:17.456595 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    defaultLanguage,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    IFNULL(
        CAST(
            REGEXP_EXTRACT(duration, r'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?') AS STRING
        ), '0'
    ) AS duration_sec,
    dimension,
    definition,
    -- Convert caption to BOOLEAN
    CASE
        WHEN LOWER(caption) = 'true' THEN TRUE
        WHEN LOWER(caption) = 'false' THEN FALSE
        ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    country

FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m16:55:17.456937 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:55:18.095406 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:3e852f80-8cb1-4084-bc05-5a8deb4d420a&page=queryresults
[0m16:55:18.974232 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61c1648-6be8-4044-ae90-4386f913fab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118266970>]}
[0m16:55:18.974747 [info ] [Thread-1  ]: 1 of 1 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.56s]
[0m16:55:18.975159 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m16:55:18.975788 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:18.976883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:18.977098 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m16:55:18.977317 [info ] [MainThread]: 
[0m16:55:18.977539 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m16:55:18.977985 [debug] [MainThread]: Command end result
[0m16:55:18.996951 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m16:55:18.998071 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m16:55:19.002020 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m16:55:19.002214 [info ] [MainThread]: 
[0m16:55:19.002468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:19.002653 [info ] [MainThread]: 
[0m16:55:19.002854 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:55:19.004825 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.921621, "process_in_blocks": "0", "process_kernel_time": 0.373745, "process_mem_max_rss": "335052800", "process_out_blocks": "0", "process_user_time": 2.32895}
[0m16:55:19.005096 [debug] [MainThread]: Command `dbt run` succeeded at 16:55:19.005044 after 4.92 seconds
[0m16:55:19.005315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d537f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143324d90>]}
[0m16:55:19.005539 [debug] [MainThread]: Flushing usage events
[0m16:55:19.445961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:06.974502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f56700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fca850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fca670>]}


============================== 16:58:06.978483 | e5974702-d450-4ab1-897c-5f294c8ad40a ==============================
[0m16:58:06.978483 [info ] [MainThread]: Running with dbt=1.10.8
[0m16:58:06.978840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:58:08.862615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5974702-d450-4ab1-897c-5f294c8ad40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1179045e0>]}
[0m16:58:08.894576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5974702-d450-4ab1-897c-5f294c8ad40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147d1a90>]}
[0m16:58:08.894925 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:58:09.067236 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m16:58:09.124224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:58:09.124452 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:58:09.127959 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.example
[0m16:58:09.142146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5974702-d450-4ab1-897c-5f294c8ad40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117eda130>]}
[0m16:58:09.185263 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m16:58:09.186897 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m16:58:09.197671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5974702-d450-4ab1-897c-5f294c8ad40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117efe6a0>]}
[0m16:58:09.197959 [info ] [MainThread]: Found 1 model, 496 macros
[0m16:58:09.198171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5974702-d450-4ab1-897c-5f294c8ad40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a60190>]}
[0m16:58:09.198850 [info ] [MainThread]: 
[0m16:58:09.199068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:58:09.199240 [info ] [MainThread]: 
[0m16:58:09.199524 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:58:09.200063 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m16:58:09.200301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:09.730081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m16:58:09.731394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:10.246245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5974702-d450-4ab1-897c-5f294c8ad40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a60190>]}
[0m16:58:10.247549 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:58:10.253764 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m16:58:10.254567 [info ] [Thread-1  ]: 1 of 1 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m16:58:10.255277 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_videos)
[0m16:58:10.255788 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m16:58:10.268738 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m16:58:10.269815 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m16:58:10.295739 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m16:58:10.299228 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    defaultLanguage,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    dimension,
    definition,
    -- Convert caption to BOOLEAN
    CASE
        WHEN LOWER(caption) = 'true' THEN TRUE
        WHEN LOWER(caption) = 'false' THEN FALSE
        ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    country

FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m16:58:10.300366 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:58:11.021790 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:9c63c04d-c53e-4097-ba3c-2bfff91f630e&page=queryresults
[0m16:58:11.489096 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5974702-d450-4ab1-897c-5f294c8ad40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117fcce80>]}
[0m16:58:11.489615 [info ] [Thread-1  ]: 1 of 1 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m16:58:11.490039 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m16:58:11.490718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:58:11.491826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:11.492037 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m16:58:11.492247 [info ] [MainThread]: 
[0m16:58:11.492472 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.29 seconds (2.29s).
[0m16:58:11.492886 [debug] [MainThread]: Command end result
[0m16:58:11.511383 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m16:58:11.512392 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m16:58:11.516601 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m16:58:11.516813 [info ] [MainThread]: 
[0m16:58:11.517066 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:58:11.517251 [info ] [MainThread]: 
[0m16:58:11.517447 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:58:11.519424 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5922976, "process_in_blocks": "0", "process_kernel_time": 0.374689, "process_mem_max_rss": "331907072", "process_out_blocks": "0", "process_user_time": 2.30114}
[0m16:58:11.519690 [debug] [MainThread]: Command `dbt run` succeeded at 16:58:11.519636 after 4.59 seconds
[0m16:58:11.519916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f56700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041ef8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11800ad90>]}
[0m16:58:11.520126 [debug] [MainThread]: Flushing usage events
[0m16:58:11.942571 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:37:48.118510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104312700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105387850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105387670>]}


============================== 17:37:48.121616 | 0d17022a-024b-4702-9985-1e77a59a08a0 ==============================
[0m17:37:48.121616 [info ] [MainThread]: Running with dbt=1.10.8
[0m17:37:48.121987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/divya21raj/.dbt', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:37:50.438726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d17022a-024b-4702-9985-1e77a59a08a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b17dc0>]}
[0m17:37:50.471771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d17022a-024b-4702-9985-1e77a59a08a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125b17b80>]}
[0m17:37:50.472207 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:37:50.663353 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m17:37:50.728555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:37:50.728863 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:37:50.733506 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.example
[0m17:37:50.749558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d17022a-024b-4702-9985-1e77a59a08a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126aa5eb0>]}
[0m17:37:50.797325 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m17:37:50.798980 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m17:37:50.810620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d17022a-024b-4702-9985-1e77a59a08a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126a51f10>]}
[0m17:37:50.810995 [info ] [MainThread]: Found 2 models, 496 macros
[0m17:37:50.811216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d17022a-024b-4702-9985-1e77a59a08a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126a595b0>]}
[0m17:37:50.811999 [info ] [MainThread]: 
[0m17:37:50.812231 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:37:50.812408 [info ] [MainThread]: 
[0m17:37:50.812712 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:37:50.815352 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m17:37:50.815629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:51.261951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m17:37:51.263344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:51.680405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d17022a-024b-4702-9985-1e77a59a08a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125bc4b80>]}
[0m17:37:51.681488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:51.689872 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m17:37:51.690957 [info ] [Thread-1  ]: 1 of 2 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m17:37:51.691767 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m17:37:51.692389 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m17:37:51.705307 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m17:37:51.706521 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m17:37:51.732557 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m17:37:51.733255 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    category_title
)
SELECT * FROM raw_categories;


[0m17:37:51.733589 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:52.404876 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:75f13920-13ad-49a4-bf8b-b764eda9044b&page=queryresults
[0m17:37:52.593430 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:75f13920-13ad-49a4-bf8b-b764eda9044b&page=queryresults
[0m17:37:52.608811 [debug] [Thread-1  ]: Database Error in model src_categories (models/staging/src_categories.sql)
  Unrecognized name: region_code at [7:12]
  compiled code at target/run/youtubeAnalysis/models/staging/src_categories.sql
[0m17:37:52.612591 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d17022a-024b-4702-9985-1e77a59a08a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f01d30>]}
[0m17:37:52.613758 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model youtubeDataAnalysis.src_categories ........ [[31mERROR[0m in 0.92s]
[0m17:37:52.614546 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m17:37:52.615089 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m17:37:52.615794 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.src_categories' to be skipped because of status 'error'.  Reason: Database Error in model src_categories (models/staging/src_categories.sql)
  Unrecognized name: region_code at [7:12]
  compiled code at target/run/youtubeAnalysis/models/staging/src_categories.sql.
[0m17:37:52.616609 [info ] [Thread-1  ]: 2 of 2 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m17:37:52.617509 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m17:37:52.618084 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m17:37:52.621611 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m17:37:52.622688 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m17:37:52.626247 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m17:37:52.627015 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    defaultLanguage,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    dimension,
    definition,
    -- Convert caption to BOOLEAN
    CASE
        WHEN LOWER(caption) = 'true' THEN TRUE
        WHEN LOWER(caption) = 'false' THEN FALSE
        ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    country

FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m17:37:52.627533 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:53.338292 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:b40afa72-6f73-45de-8ce1-598e2ee324c9&page=queryresults
[0m17:37:53.957044 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d17022a-024b-4702-9985-1e77a59a08a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b9730>]}
[0m17:37:53.957649 [info ] [Thread-1  ]: 2 of 2 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m17:37:53.958106 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m17:37:53.958758 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:37:53.959882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:53.960098 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m17:37:53.960387 [info ] [MainThread]: 
[0m17:37:53.960645 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m17:37:53.961187 [debug] [MainThread]: Command end result
[0m17:37:53.992261 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m17:37:53.993397 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m17:37:53.997464 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m17:37:53.997670 [info ] [MainThread]: 
[0m17:37:53.997896 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:37:53.998092 [info ] [MainThread]: 
[0m17:37:53.998325 [error] [MainThread]: [31mFailure in model src_categories (models/staging/src_categories.sql)[0m
[0m17:37:53.998542 [error] [MainThread]:   Database Error in model src_categories (models/staging/src_categories.sql)
  Unrecognized name: region_code at [7:12]
  compiled code at target/run/youtubeAnalysis/models/staging/src_categories.sql
[0m17:37:53.998710 [info ] [MainThread]: 
[0m17:37:53.998913 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/staging/src_categories.sql
[0m17:37:53.999104 [info ] [MainThread]: 
[0m17:37:53.999414 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m17:37:54.001661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.93127, "process_in_blocks": "0", "process_kernel_time": 0.41118, "process_mem_max_rss": "333774848", "process_out_blocks": "0", "process_user_time": 2.549474}
[0m17:37:54.001979 [debug] [MainThread]: Command `dbt run` failed at 17:37:54.001924 after 5.93 seconds
[0m17:37:54.002283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104312700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b17dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126a51f10>]}
[0m17:37:54.002524 [debug] [MainThread]: Flushing usage events
[0m17:37:54.441679 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:40:10.730894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10493a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105caf850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105caf670>]}


============================== 17:40:10.733921 | a2690207-dbf4-46cc-b6fb-328064bbb6bb ==============================
[0m17:40:10.733921 [info ] [MainThread]: Running with dbt=1.10.8
[0m17:40:10.734303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/divya21raj/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:40:12.867899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2690207-dbf4-46cc-b6fb-328064bbb6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150bdfd00>]}
[0m17:40:12.903087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2690207-dbf4-46cc-b6fb-328064bbb6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf7b20>]}
[0m17:40:12.903603 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:40:13.113822 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m17:40:13.176519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:40:13.176800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:40:13.180715 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.example
[0m17:40:13.196677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2690207-dbf4-46cc-b6fb-328064bbb6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15135e130>]}
[0m17:40:13.241868 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m17:40:13.243730 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m17:40:13.255324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2690207-dbf4-46cc-b6fb-328064bbb6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151340d00>]}
[0m17:40:13.255748 [info ] [MainThread]: Found 2 models, 496 macros
[0m17:40:13.255984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2690207-dbf4-46cc-b6fb-328064bbb6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151310d30>]}
[0m17:40:13.256805 [info ] [MainThread]: 
[0m17:40:13.257047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:13.257221 [info ] [MainThread]: 
[0m17:40:13.257517 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:40:13.260136 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m17:40:13.260388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:13.731200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m17:40:13.731965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:14.181972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2690207-dbf4-46cc-b6fb-328064bbb6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030db550>]}
[0m17:40:14.182981 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:14.189656 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m17:40:14.190920 [info ] [Thread-1  ]: 1 of 2 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m17:40:14.191827 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m17:40:14.192519 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m17:40:14.207132 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m17:40:14.208008 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m17:40:14.234702 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m17:40:14.235520 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m17:40:14.235934 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:15.316195 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:eba08c79-baff-4311-89b2-ec7e3b1c5407&page=queryresults
[0m17:40:15.721320 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:eba08c79-baff-4311-89b2-ec7e3b1c5407&page=queryresults
[0m17:40:15.737236 [debug] [Thread-1  ]: Database Error in model src_categories (models/staging/src_categories.sql)
  Unrecognized name: categoryId; Did you mean category_id? at [8:15]
  compiled code at target/run/youtubeAnalysis/models/staging/src_categories.sql
[0m17:40:15.739844 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2690207-dbf4-46cc-b6fb-328064bbb6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1514a7190>]}
[0m17:40:15.740544 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model youtubeDataAnalysis.src_categories ........ [[31mERROR[0m in 1.55s]
[0m17:40:15.740928 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m17:40:15.741221 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m17:40:15.741553 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.src_categories' to be skipped because of status 'error'.  Reason: Database Error in model src_categories (models/staging/src_categories.sql)
  Unrecognized name: categoryId; Did you mean category_id? at [8:15]
  compiled code at target/run/youtubeAnalysis/models/staging/src_categories.sql.
[0m17:40:15.741975 [info ] [Thread-1  ]: 2 of 2 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m17:40:15.742560 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m17:40:15.742796 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m17:40:15.746081 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m17:40:15.746675 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m17:40:15.748803 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m17:40:15.749266 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    defaultLanguage,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    dimension,
    definition,
    -- Convert caption to BOOLEAN
    CASE
        WHEN LOWER(caption) = 'true' THEN TRUE
        WHEN LOWER(caption) = 'false' THEN FALSE
        ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    country

FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m17:40:15.749557 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:16.403500 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:42346000-8464-4d99-9561-b65558037b41&page=queryresults
[0m17:40:16.874970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2690207-dbf4-46cc-b6fb-328064bbb6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be1730>]}
[0m17:40:16.875498 [info ] [Thread-1  ]: 2 of 2 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m17:40:16.875927 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m17:40:16.876691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:16.877896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:16.878169 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m17:40:16.878449 [info ] [MainThread]: 
[0m17:40:16.878700 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m17:40:16.879281 [debug] [MainThread]: Command end result
[0m17:40:16.901042 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m17:40:16.906039 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m17:40:16.910684 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m17:40:16.910886 [info ] [MainThread]: 
[0m17:40:16.911114 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:40:16.911307 [info ] [MainThread]: 
[0m17:40:16.911552 [error] [MainThread]: [31mFailure in model src_categories (models/staging/src_categories.sql)[0m
[0m17:40:16.911770 [error] [MainThread]:   Database Error in model src_categories (models/staging/src_categories.sql)
  Unrecognized name: categoryId; Did you mean category_id? at [8:15]
  compiled code at target/run/youtubeAnalysis/models/staging/src_categories.sql
[0m17:40:16.911950 [info ] [MainThread]: 
[0m17:40:16.912158 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/staging/src_categories.sql
[0m17:40:16.912330 [info ] [MainThread]: 
[0m17:40:16.912526 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m17:40:16.914058 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.229709, "process_in_blocks": "0", "process_kernel_time": 0.426009, "process_mem_max_rss": "327778304", "process_out_blocks": "0", "process_user_time": 2.464837}
[0m17:40:16.914328 [debug] [MainThread]: Command `dbt run` failed at 17:40:16.914279 after 6.23 seconds
[0m17:40:16.914577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10493a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1511a41f0>]}
[0m17:40:16.914784 [debug] [MainThread]: Flushing usage events
[0m17:40:17.304954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:41:38.354090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106336670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073aa8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073aa700>]}


============================== 17:41:38.357900 | 5624b2ee-226c-474d-b800-7aa546919f29 ==============================
[0m17:41:38.357900 [info ] [MainThread]: Running with dbt=1.10.8
[0m17:41:38.358251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/divya21raj/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:41:40.211209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5624b2ee-226c-474d-b800-7aa546919f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d0d400>]}
[0m17:41:40.243766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5624b2ee-226c-474d-b800-7aa546919f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c8d9a0>]}
[0m17:41:40.244147 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:41:40.416586 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m17:41:40.474860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:41:40.475117 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:41:40.478682 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.example
[0m17:41:40.492554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5624b2ee-226c-474d-b800-7aa546919f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a29e130>]}
[0m17:41:40.535463 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m17:41:40.539060 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m17:41:40.552317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5624b2ee-226c-474d-b800-7aa546919f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2b5820>]}
[0m17:41:40.552628 [info ] [MainThread]: Found 2 models, 496 macros
[0m17:41:40.552842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5624b2ee-226c-474d-b800-7aa546919f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a258a00>]}
[0m17:41:40.553548 [info ] [MainThread]: 
[0m17:41:40.553774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:40.553949 [info ] [MainThread]: 
[0m17:41:40.554239 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:41:40.556650 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m17:41:40.556888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:40.979172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m17:41:40.980440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:41.395646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5624b2ee-226c-474d-b800-7aa546919f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2b52e0>]}
[0m17:41:41.396249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:41:41.401291 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m17:41:41.401933 [info ] [Thread-1  ]: 1 of 2 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m17:41:41.402593 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m17:41:41.403149 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m17:41:41.417625 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m17:41:41.418570 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m17:41:41.447974 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m17:41:41.448715 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m17:41:41.449091 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:41:42.195547 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:87b6bd20-8193-4180-bbfa-1af5281a643a&page=queryresults
[0m17:41:42.673755 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5624b2ee-226c-474d-b800-7aa546919f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a37c820>]}
[0m17:41:42.674307 [info ] [Thread-1  ]: 1 of 2 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m17:41:42.674714 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m17:41:42.674987 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m17:41:42.675318 [info ] [Thread-1  ]: 2 of 2 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m17:41:42.675607 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m17:41:42.675843 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m17:41:42.677416 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m17:41:42.677959 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m17:41:42.680382 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m17:41:42.680850 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    defaultLanguage,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    dimension,
    definition,
    -- Convert caption to BOOLEAN
    CASE
        WHEN LOWER(caption) = 'true' THEN TRUE
        WHEN LOWER(caption) = 'false' THEN FALSE
        ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    country

FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m17:41:42.681181 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:41:43.426535 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:ea5d8349-a288-4ed9-a080-aa265d531398&page=queryresults
[0m17:41:43.814856 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5624b2ee-226c-474d-b800-7aa546919f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cf3a0>]}
[0m17:41:43.815975 [info ] [Thread-1  ]: 2 of 2 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m17:41:43.816796 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m17:41:43.818128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:41:43.820618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:43.821141 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m17:41:43.821692 [info ] [MainThread]: 
[0m17:41:43.822137 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m17:41:43.823310 [debug] [MainThread]: Command end result
[0m17:41:43.854148 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m17:41:43.855385 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m17:41:43.860301 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m17:41:43.860538 [info ] [MainThread]: 
[0m17:41:43.860812 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:41:43.861026 [info ] [MainThread]: 
[0m17:41:43.861257 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:41:43.868688 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5609746, "process_in_blocks": "0", "process_kernel_time": 0.357413, "process_mem_max_rss": "345571328", "process_out_blocks": "0", "process_user_time": 2.382034}
[0m17:41:43.869001 [debug] [MainThread]: Command `dbt run` succeeded at 17:41:43.868945 after 5.56 seconds
[0m17:41:43.869263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106336670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c8d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2b3100>]}
[0m17:41:43.869523 [debug] [MainThread]: Flushing usage events
[0m17:41:44.265957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:41:59.926071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056de610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106753610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106753430>]}


============================== 22:41:59.931801 | 4c2b22db-4520-46a7-9b98-feb488e7cf76 ==============================
[0m22:41:59.931801 [info ] [MainThread]: Running with dbt=1.10.8
[0m22:41:59.932182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/divya21raj/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:42:01.894386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c2b22db-4520-46a7-9b98-feb488e7cf76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee3b80>]}
[0m22:42:01.926508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c2b22db-4520-46a7-9b98-feb488e7cf76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679ad60>]}
[0m22:42:01.926861 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:42:02.104051 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m22:42:02.161449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:42:02.161679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:42:02.165293 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m22:42:02.180297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c2b22db-4520-46a7-9b98-feb488e7cf76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11965e130>]}
[0m22:42:02.221273 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m22:42:02.225713 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m22:42:02.236628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c2b22db-4520-46a7-9b98-feb488e7cf76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119616550>]}
[0m22:42:02.236921 [info ] [MainThread]: Found 3 models, 496 macros
[0m22:42:02.237133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c2b22db-4520-46a7-9b98-feb488e7cf76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c63460>]}
[0m22:42:02.237913 [info ] [MainThread]: 
[0m22:42:02.238133 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:42:02.238303 [info ] [MainThread]: 
[0m22:42:02.238575 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:42:02.241004 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m22:42:02.241251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:02.830731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m22:42:02.832208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:03.234441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c2b22db-4520-46a7-9b98-feb488e7cf76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c63460>]}
[0m22:42:03.235930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:42:03.243451 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m22:42:03.244432 [info ] [Thread-1  ]: 1 of 2 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m22:42:03.245194 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m22:42:03.245778 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m22:42:03.257450 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m22:42:03.258588 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m22:42:03.284877 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m22:42:03.285494 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m22:42:03.285830 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:42:03.970332 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:048648d2-4b84-4a4c-813a-16556d7615b8&page=queryresults
[0m22:42:04.639838 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2b22db-4520-46a7-9b98-feb488e7cf76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119674f70>]}
[0m22:42:04.640344 [info ] [Thread-1  ]: 1 of 2 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m22:42:04.640758 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m22:42:04.641028 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m22:42:04.641369 [info ] [Thread-1  ]: 2 of 2 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m22:42:04.641685 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m22:42:04.641938 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m22:42:04.643712 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m22:42:04.644111 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m22:42:04.646096 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m22:42:04.646528 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    COALESCE(
    CASE
        WHEN LOWER(caption) = 'true' THEN TRUE
        WHEN LOWER(caption) = 'false' THEN FALSE
        ELSE NULL
    END,
    'Not Given'
    ) AS caption,
    COALESCE(licensedContent, 'Not Given') AS licensedContent,
    COALESCE(madeForKids, 'Not Given') AS madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m22:42:04.646888 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:42:05.384746 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:0ea16f40-50d4-4781-8ed9-ae55bf2ba575&page=queryresults
[0m22:42:05.549490 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:0ea16f40-50d4-4781-8ed9-ae55bf2ba575&page=queryresults
[0m22:42:05.563750 [debug] [Thread-1  ]: Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function COALESCE
    Argument types: BOOL, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {BOOL, STRING} at [25:5]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m22:42:05.564869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2b22db-4520-46a7-9b98-feb488e7cf76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119b04a60>]}
[0m22:42:05.565984 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model youtubeDataAnalysis.src_videos ............ [[31mERROR[0m in 0.92s]
[0m22:42:05.566830 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m22:42:05.567581 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.src_videos' to be skipped because of status 'error'.  Reason: Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function COALESCE
    Argument types: BOOL, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {BOOL, STRING} at [25:5]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql.
[0m22:42:05.568929 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:42:05.571204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:05.571669 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m22:42:05.572192 [info ] [MainThread]: 
[0m22:42:05.572617 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m22:42:05.573592 [debug] [MainThread]: Command end result
[0m22:42:05.600794 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m22:42:05.602176 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m22:42:05.607347 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m22:42:05.607618 [info ] [MainThread]: 
[0m22:42:05.607902 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:42:05.608212 [info ] [MainThread]: 
[0m22:42:05.608567 [error] [MainThread]: [31mFailure in model src_videos (models/staging/src_videos.sql)[0m
[0m22:42:05.608854 [error] [MainThread]:   Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function COALESCE
    Argument types: BOOL, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {BOOL, STRING} at [25:5]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m22:42:05.609071 [info ] [MainThread]: 
[0m22:42:05.609337 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/staging/src_videos.sql
[0m22:42:05.609543 [info ] [MainThread]: 
[0m22:42:05.609770 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m22:42:05.611900 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.7353024, "process_in_blocks": "0", "process_kernel_time": 0.375966, "process_mem_max_rss": "342016000", "process_out_blocks": "0", "process_user_time": 2.366259}
[0m22:42:05.612200 [debug] [MainThread]: Command `dbt run` failed at 22:42:05.612143 after 5.74 seconds
[0m22:42:05.612480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056de610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106049dc0>]}
[0m22:42:05.612790 [debug] [MainThread]: Flushing usage events
[0m22:42:06.039233 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:44:30.846558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203e6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221ee7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221ee5e0>]}


============================== 22:44:30.850495 | 06c3ab61-6c00-4de1-88a7-657e545f7c55 ==============================
[0m22:44:30.850495 [info ] [MainThread]: Running with dbt=1.10.8
[0m22:44:30.850855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/divya21raj/.dbt', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:44:32.757864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06c3ab61-6c00-4de1-88a7-657e545f7c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1435d8a00>]}
[0m22:44:32.789902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06c3ab61-6c00-4de1-88a7-657e545f7c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1436ffaf0>]}
[0m22:44:32.790257 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:44:32.991344 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m22:44:33.049190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:44:33.049419 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:44:33.053063 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m22:44:33.066837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06c3ab61-6c00-4de1-88a7-657e545f7c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143ba0130>]}
[0m22:44:33.110884 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m22:44:33.112561 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m22:44:33.123226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06c3ab61-6c00-4de1-88a7-657e545f7c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143bc1370>]}
[0m22:44:33.123548 [info ] [MainThread]: Found 3 models, 496 macros
[0m22:44:33.123763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c3ab61-6c00-4de1-88a7-657e545f7c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1439d0400>]}
[0m22:44:33.124498 [info ] [MainThread]: 
[0m22:44:33.124753 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:44:33.124927 [info ] [MainThread]: 
[0m22:44:33.125215 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:44:33.127701 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m22:44:33.127934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:44:33.548150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m22:44:33.548939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:44:33.958407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c3ab61-6c00-4de1-88a7-657e545f7c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143bac820>]}
[0m22:44:33.959321 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:44:33.965480 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m22:44:33.966262 [info ] [Thread-1  ]: 1 of 2 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m22:44:33.966888 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m22:44:33.967386 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m22:44:33.978546 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m22:44:33.979952 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m22:44:34.005096 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m22:44:34.005690 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m22:44:34.005998 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:44:34.685120 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:e55b8248-e9bc-4ba2-a16c-64dc32856e23&page=queryresults
[0m22:44:35.260046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06c3ab61-6c00-4de1-88a7-657e545f7c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143bb36d0>]}
[0m22:44:35.260561 [info ] [Thread-1  ]: 1 of 2 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m22:44:35.260974 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m22:44:35.261288 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m22:44:35.261633 [info ] [Thread-1  ]: 2 of 2 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m22:44:35.261932 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m22:44:35.262182 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m22:44:35.264081 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m22:44:35.264496 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m22:44:35.266565 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m22:44:35.267005 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    CASE
    WHEN LOWER(caption) = 'true' THEN TRUE
    WHEN LOWER(caption) = 'false' THEN FALSE
    ELSE NULL
    END AS caption,
    COALESCE(licensedContent, 'Not Given') AS licensedContent,
    COALESCE(madeForKids, 'Not Given') AS madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m22:44:35.267378 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:44:35.953210 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:a7238f65-40a4-4f65-a6c6-ea3f2a9661c0&page=queryresults
[0m22:44:36.133866 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:a7238f65-40a4-4f65-a6c6-ea3f2a9661c0&page=queryresults
[0m22:44:36.146995 [debug] [Thread-1  ]: Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function COALESCE
    Argument types: BOOL, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {BOOL, STRING} at [30:5]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m22:44:36.148069 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06c3ab61-6c00-4de1-88a7-657e545f7c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144145d30>]}
[0m22:44:36.149043 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model youtubeDataAnalysis.src_videos ............ [[31mERROR[0m in 0.89s]
[0m22:44:36.149799 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m22:44:36.150545 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.src_videos' to be skipped because of status 'error'.  Reason: Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function COALESCE
    Argument types: BOOL, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {BOOL, STRING} at [30:5]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql.
[0m22:44:36.152107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:44:36.154248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:44:36.154609 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m22:44:36.155038 [info ] [MainThread]: 
[0m22:44:36.155420 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m22:44:36.156440 [debug] [MainThread]: Command end result
[0m22:44:36.184483 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m22:44:36.185690 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m22:44:36.190457 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m22:44:36.190690 [info ] [MainThread]: 
[0m22:44:36.190943 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:44:36.191165 [info ] [MainThread]: 
[0m22:44:36.191559 [error] [MainThread]: [31mFailure in model src_videos (models/staging/src_videos.sql)[0m
[0m22:44:36.191859 [error] [MainThread]:   Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function COALESCE
    Argument types: BOOL, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {BOOL, STRING} at [30:5]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m22:44:36.192072 [info ] [MainThread]: 
[0m22:44:36.192313 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/staging/src_videos.sql
[0m22:44:36.192515 [info ] [MainThread]: 
[0m22:44:36.192738 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m22:44:36.194902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.39248, "process_in_blocks": "0", "process_kernel_time": 0.384622, "process_mem_max_rss": "340443136", "process_out_blocks": "0", "process_user_time": 2.360968}
[0m22:44:36.195183 [debug] [MainThread]: Command `dbt run` failed at 22:44:36.195131 after 5.39 seconds
[0m22:44:36.195443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203e6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a837f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1435d8a00>]}
[0m22:44:36.195685 [debug] [MainThread]: Flushing usage events
[0m22:44:36.595359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:22.297079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cb26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d25580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d253a0>]}


============================== 22:49:22.300052 | 737616be-862f-4523-adfb-9b3d2eb709d4 ==============================
[0m22:49:22.300052 [info ] [MainThread]: Running with dbt=1.10.8
[0m22:49:22.300437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'profiles_dir': '/Users/divya21raj/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:49:22.309005 [info ] [MainThread]: dbt version: 1.10.8
[0m22:49:22.309263 [info ] [MainThread]: python version: 3.9.7
[0m22:49:22.309451 [info ] [MainThread]: python path: /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/venv/bin/python
[0m22:49:22.309634 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m22:49:24.005124 [info ] [MainThread]: Using profiles dir at /Users/divya21raj/.dbt
[0m22:49:24.005470 [info ] [MainThread]: Using profiles.yml file at /Users/divya21raj/.dbt/profiles.yml
[0m22:49:24.005663 [info ] [MainThread]: Using dbt_project.yml file at /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/dbt_project.yml
[0m22:49:24.005852 [info ] [MainThread]: adapter type: bigquery
[0m22:49:24.006022 [info ] [MainThread]: adapter version: 1.10.1
[0m22:49:24.066929 [info ] [MainThread]: Configuration:
[0m22:49:24.067320 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:49:24.067586 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:49:24.067798 [info ] [MainThread]: Required dependencies:
[0m22:49:24.068064 [debug] [MainThread]: Executing "git --help"
[0m22:49:24.161232 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:49:24.162093 [debug] [MainThread]: STDERR: "b''"
[0m22:49:24.162383 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:49:24.162614 [info ] [MainThread]: Connection:
[0m22:49:24.162901 [info ] [MainThread]:   method: service-account
[0m22:49:24.163074 [info ] [MainThread]:   database: third-flare-425403-c0
[0m22:49:24.163240 [info ] [MainThread]:   execution_project: third-flare-425403-c0
[0m22:49:24.163404 [info ] [MainThread]:   schema: youtubeDataAnalysis
[0m22:49:24.163565 [info ] [MainThread]:   location: US
[0m22:49:24.163725 [info ] [MainThread]:   priority: interactive
[0m22:49:24.163884 [info ] [MainThread]:   maximum_bytes_billed: None
[0m22:49:24.164044 [info ] [MainThread]:   impersonate_service_account: None
[0m22:49:24.164202 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m22:49:24.164362 [info ] [MainThread]:   job_retries: 1
[0m22:49:24.164520 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m22:49:24.164677 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m22:49:24.164835 [info ] [MainThread]:   timeout_seconds: 300
[0m22:49:24.164991 [info ] [MainThread]:   client_id: None
[0m22:49:24.165147 [info ] [MainThread]:   token_uri: None
[0m22:49:24.165303 [info ] [MainThread]:   compute_region: None
[0m22:49:24.165460 [info ] [MainThread]:   dataproc_cluster_name: None
[0m22:49:24.165620 [info ] [MainThread]:   gcs_bucket: None
[0m22:49:24.165776 [info ] [MainThread]:   dataproc_batch: None
[0m22:49:24.166212 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:49:24.342149 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m22:49:24.342538 [debug] [MainThread]: On debug: select 1 as id
[0m22:49:24.342758 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:49:25.103444 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:694f61b2-4454-459e-a6f3-829a95dbeebb&page=queryresults
[0m22:49:25.577496 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:49:25.578594 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:49:25.582747 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.3294816, "process_in_blocks": "0", "process_kernel_time": 0.37092, "process_mem_max_rss": "331939840", "process_out_blocks": "0", "process_user_time": 2.000298}
[0m22:49:25.583591 [debug] [MainThread]: Command `dbt debug` succeeded at 22:49:25.583432 after 3.33 seconds
[0m22:49:25.584121 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:49:25.584652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cb26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10459e880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028a1d00>]}
[0m22:49:25.585213 [debug] [MainThread]: Flushing usage events
[0m22:49:25.994574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:37.982247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dee670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e638e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e63700>]}


============================== 22:49:37.985365 | ff14d99b-aa50-45bc-97cd-76a3557182a4 ==============================
[0m22:49:37.985365 [info ] [MainThread]: Running with dbt=1.10.8
[0m22:49:37.985780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:49:39.464404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff14d99b-aa50-45bc-97cd-76a3557182a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040cce20>]}
[0m22:49:39.496159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff14d99b-aa50-45bc-97cd-76a3557182a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cac3a0>]}
[0m22:49:39.496489 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:49:39.663611 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m22:49:39.734830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:49:39.735058 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:49:39.738606 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m22:49:39.753008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff14d99b-aa50-45bc-97cd-76a3557182a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117da0130>]}
[0m22:49:39.796691 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m22:49:39.798175 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m22:49:39.815617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff14d99b-aa50-45bc-97cd-76a3557182a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117dc3250>]}
[0m22:49:39.815900 [info ] [MainThread]: Found 3 models, 496 macros
[0m22:49:39.816125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff14d99b-aa50-45bc-97cd-76a3557182a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103365bb0>]}
[0m22:49:39.816835 [info ] [MainThread]: 
[0m22:49:39.817050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:49:39.817225 [info ] [MainThread]: 
[0m22:49:39.817499 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:49:39.819911 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m22:49:39.820140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:40.222937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m22:49:40.224313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:49:40.645841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff14d99b-aa50-45bc-97cd-76a3557182a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178ff760>]}
[0m22:49:40.647298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:49:40.653375 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m22:49:40.654427 [info ] [Thread-1  ]: 1 of 2 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m22:49:40.655109 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m22:49:40.655625 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m22:49:40.667477 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m22:49:40.668771 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m22:49:40.694843 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m22:49:40.695445 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m22:49:40.695772 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:49:41.320938 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:7b6d00a2-e64a-4215-8d96-c3bc71ad3672&page=queryresults
[0m22:49:41.771631 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff14d99b-aa50-45bc-97cd-76a3557182a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117db6e20>]}
[0m22:49:41.772124 [info ] [Thread-1  ]: 1 of 2 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m22:49:41.772538 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m22:49:41.772817 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m22:49:41.773162 [info ] [Thread-1  ]: 2 of 2 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m22:49:41.773461 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m22:49:41.773712 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m22:49:41.775520 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m22:49:41.776025 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m22:49:41.778186 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m22:49:41.778715 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
        video_id,
        -- Convert publishedAt to TIMESTAMP
        SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
        COALESCE(channel_Id, 'Not Given') AS channel_Id,
        COALESCE(video_title, 'Not Given') AS video_title,
        COALESCE(channel_Title, 'Not Given') AS channel_Title,
        -- Convert categoryId to INT64
        SAFE_CAST(categoryId AS INT64) AS categoryId,
        -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
        (
            COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
            COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
            COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
        COALESCE(dimension, 'Not Given') AS dimension,
        COALESCE(definition, 'Not Given') AS definition,
        -- Convert caption to BOOLEAN (no COALESCE with string)
        CASE
            WHEN LOWER(caption) = 'true' THEN TRUE
            WHEN LOWER(caption) = 'false' THEN FALSE
            ELSE NULL
        END AS caption,
        COALESCE(licensedContent, 'Not Given') AS licensedContent,
        COALESCE(madeForKids, 'Not Given') AS madeForKids,
        -- Convert viewCount, likeCount, commentCount to INT64
        SAFE_CAST(viewCount AS INT64) AS viewCount,
        SAFE_CAST(likeCount AS INT64) AS likeCount,
        SAFE_CAST(commentCount AS INT64) AS commentCount,
        COALESCE(country, 'Not Given') AS country
    FROM
        `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;;


[0m22:49:41.779102 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:49:42.174193 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:007de186-19e5-4536-869c-0b870659ab12&page=queryresults
[0m22:49:42.175980 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:007de186-19e5-4536-869c-0b870659ab12&page=queryresults
[0m22:49:42.187648 [debug] [Thread-1  ]: Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Unexpected ";" at [40:26]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m22:49:42.188907 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff14d99b-aa50-45bc-97cd-76a3557182a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182bfd30>]}
[0m22:49:42.189981 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model youtubeDataAnalysis.src_videos ............ [[31mERROR[0m in 0.42s]
[0m22:49:42.190744 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m22:49:42.191415 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.src_videos' to be skipped because of status 'error'.  Reason: Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Unexpected ";" at [40:26]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql.
[0m22:49:42.192747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:49:42.194955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:42.195380 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m22:49:42.195863 [info ] [MainThread]: 
[0m22:49:42.196239 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m22:49:42.197260 [debug] [MainThread]: Command end result
[0m22:49:42.226526 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m22:49:42.227769 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m22:49:42.232605 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m22:49:42.232853 [info ] [MainThread]: 
[0m22:49:42.233120 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:49:42.233341 [info ] [MainThread]: 
[0m22:49:42.233608 [error] [MainThread]: [31mFailure in model src_videos (models/staging/src_videos.sql)[0m
[0m22:49:42.233861 [error] [MainThread]:   Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Unexpected ";" at [40:26]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m22:49:42.234081 [info ] [MainThread]: 
[0m22:49:42.234318 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/staging/src_videos.sql
[0m22:49:42.234519 [info ] [MainThread]: 
[0m22:49:42.234740 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m22:49:42.236438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.2942142, "process_in_blocks": "0", "process_kernel_time": 0.318133, "process_mem_max_rss": "331776000", "process_out_blocks": "0", "process_user_time": 2.326313}
[0m22:49:42.236725 [debug] [MainThread]: Command `dbt run` failed at 22:49:42.236671 after 4.29 seconds
[0m22:49:42.236988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dee670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103361e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040cce20>]}
[0m22:49:42.237246 [debug] [MainThread]: Flushing usage events
[0m22:49:42.581680 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:51.665791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039f2700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c6f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c6f670>]}


============================== 22:49:51.668606 | 550d1ed7-7ba1-4026-a89d-873e7aef87a7 ==============================
[0m22:49:51.668606 [info ] [MainThread]: Running with dbt=1.10.8
[0m22:49:51.668952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:49:53.216309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '550d1ed7-7ba1-4026-a89d-873e7aef87a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c8a8b0>]}
[0m22:49:53.248526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '550d1ed7-7ba1-4026-a89d-873e7aef87a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb6b20>]}
[0m22:49:53.248884 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:49:53.421146 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m22:49:53.479139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:49:53.479376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:49:53.482983 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m22:49:53.497405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '550d1ed7-7ba1-4026-a89d-873e7aef87a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137e1f130>]}
[0m22:49:53.539351 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m22:49:53.543392 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m22:49:53.554624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '550d1ed7-7ba1-4026-a89d-873e7aef87a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137e42dc0>]}
[0m22:49:53.554914 [info ] [MainThread]: Found 3 models, 496 macros
[0m22:49:53.555137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '550d1ed7-7ba1-4026-a89d-873e7aef87a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137dd7520>]}
[0m22:49:53.555913 [info ] [MainThread]: 
[0m22:49:53.556150 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:49:53.556336 [info ] [MainThread]: 
[0m22:49:53.556637 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:49:53.559181 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m22:49:53.559419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:53.963785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m22:49:53.965268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:49:54.380039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '550d1ed7-7ba1-4026-a89d-873e7aef87a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f42370>]}
[0m22:49:54.380974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:49:54.386810 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m22:49:54.387623 [info ] [Thread-1  ]: 1 of 2 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m22:49:54.388262 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m22:49:54.388723 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m22:49:54.399243 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m22:49:54.400089 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m22:49:54.424867 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m22:49:54.425420 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m22:49:54.425735 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:49:55.212696 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:f7ac2986-11c4-4f49-8633-9c62438a8af3&page=queryresults
[0m22:49:55.706680 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '550d1ed7-7ba1-4026-a89d-873e7aef87a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137e34310>]}
[0m22:49:55.707220 [info ] [Thread-1  ]: 1 of 2 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m22:49:55.707658 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m22:49:55.707996 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m22:49:55.708363 [info ] [Thread-1  ]: 2 of 2 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m22:49:55.708682 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m22:49:55.708947 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m22:49:55.710845 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m22:49:55.711258 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m22:49:55.713416 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m22:49:55.713931 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
        video_id,
        -- Convert publishedAt to TIMESTAMP
        SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
        COALESCE(channel_Id, 'Not Given') AS channel_Id,
        COALESCE(video_title, 'Not Given') AS video_title,
        COALESCE(channel_Title, 'Not Given') AS channel_Title,
        -- Convert categoryId to INT64
        SAFE_CAST(categoryId AS INT64) AS categoryId,
        -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
        (
            COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
            COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
            COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
        COALESCE(dimension, 'Not Given') AS dimension,
        COALESCE(definition, 'Not Given') AS definition,
        -- Convert caption to BOOLEAN (no COALESCE with string)
        CASE
            WHEN LOWER(caption) = 'true' THEN TRUE
            WHEN LOWER(caption) = 'false' THEN FALSE
            ELSE NULL
        END AS caption,
        COALESCE(licensedContent, 'Not Given') AS licensedContent,
        COALESCE(madeForKids, 'Not Given') AS madeForKids,
        -- Convert viewCount, likeCount, commentCount to INT64
        SAFE_CAST(viewCount AS INT64) AS viewCount,
        SAFE_CAST(likeCount AS INT64) AS likeCount,
        SAFE_CAST(commentCount AS INT64) AS commentCount,
        COALESCE(country, 'Not Given') AS country
    FROM
        `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m22:49:55.714294 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:49:56.336992 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:e5249741-4f60-4b0f-8521-484375c5ccc6&page=queryresults
[0m22:49:56.507159 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:e5249741-4f60-4b0f-8521-484375c5ccc6&page=queryresults
[0m22:49:56.521341 [debug] [Thread-1  ]: Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function COALESCE
    Argument types: BOOL, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {BOOL, STRING} at [30:9]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m22:49:56.521797 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '550d1ed7-7ba1-4026-a89d-873e7aef87a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14033fa60>]}
[0m22:49:56.522190 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model youtubeDataAnalysis.src_videos ............ [[31mERROR[0m in 0.81s]
[0m22:49:56.522565 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m22:49:56.522895 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.src_videos' to be skipped because of status 'error'.  Reason: Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function COALESCE
    Argument types: BOOL, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {BOOL, STRING} at [30:9]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql.
[0m22:49:56.523647 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:49:56.524672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:56.524875 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m22:49:56.525102 [info ] [MainThread]: 
[0m22:49:56.525302 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m22:49:56.525798 [debug] [MainThread]: Command end result
[0m22:49:56.543179 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m22:49:56.544381 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m22:49:56.548319 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m22:49:56.548521 [info ] [MainThread]: 
[0m22:49:56.548744 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:49:56.548932 [info ] [MainThread]: 
[0m22:49:56.549160 [error] [MainThread]: [31mFailure in model src_videos (models/staging/src_videos.sql)[0m
[0m22:49:56.549384 [error] [MainThread]:   Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function COALESCE
    Argument types: BOOL, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {BOOL, STRING} at [30:9]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m22:49:56.549563 [info ] [MainThread]: 
[0m22:49:56.549766 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/staging/src_videos.sql
[0m22:49:56.549941 [info ] [MainThread]: 
[0m22:49:56.550132 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m22:49:56.551446 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.9246345, "process_in_blocks": "0", "process_kernel_time": 0.330955, "process_mem_max_rss": "332333056", "process_out_blocks": "0", "process_user_time": 2.41176}
[0m22:49:56.551717 [debug] [MainThread]: Command `dbt run` failed at 22:49:56.551665 after 4.92 seconds
[0m22:49:56.551961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039f2700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f3b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c8a8b0>]}
[0m22:49:56.552191 [debug] [MainThread]: Flushing usage events
[0m22:49:56.885208 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:51:31.059766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fae8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fae6d0>]}


============================== 22:51:31.063605 | 4b3b6405-90ee-496c-9255-f290f865ce12 ==============================
[0m22:51:31.063605 [info ] [MainThread]: Running with dbt=1.10.8
[0m22:51:31.063966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:51:32.636905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b3b6405-90ee-496c-9255-f290f865ce12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10484b0d0>]}
[0m22:51:32.669329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b3b6405-90ee-496c-9255-f290f865ce12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141dfaca0>]}
[0m22:51:32.669685 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:51:32.837990 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m22:51:32.895437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:51:32.895685 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:51:32.899315 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m22:51:32.914090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b3b6405-90ee-496c-9255-f290f865ce12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1424e0130>]}
[0m22:51:32.958301 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m22:51:32.961953 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m22:51:32.972824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b3b6405-90ee-496c-9255-f290f865ce12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141fe9ca0>]}
[0m22:51:32.973108 [info ] [MainThread]: Found 3 models, 496 macros
[0m22:51:32.973316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b3b6405-90ee-496c-9255-f290f865ce12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141f20550>]}
[0m22:51:32.974039 [info ] [MainThread]: 
[0m22:51:32.974295 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:51:32.974525 [info ] [MainThread]: 
[0m22:51:32.974825 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:51:32.977282 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m22:51:32.977533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:51:33.381214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m22:51:33.382205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:51:33.932206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b3b6405-90ee-496c-9255-f290f865ce12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141e0fe20>]}
[0m22:51:33.933623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:51:33.940938 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m22:51:33.941927 [info ] [Thread-1  ]: 1 of 2 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m22:51:33.942790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m22:51:33.943482 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m22:51:33.956018 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m22:51:33.957603 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m22:51:33.984113 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m22:51:33.985018 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m22:51:33.985388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:51:34.540354 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:aa29a579-604d-4b87-a358-0805220ac1a8&page=queryresults
[0m22:51:34.959885 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b3b6405-90ee-496c-9255-f290f865ce12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1425c8490>]}
[0m22:51:34.960386 [info ] [Thread-1  ]: 1 of 2 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m22:51:34.960794 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m22:51:34.961061 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m22:51:34.961395 [info ] [Thread-1  ]: 2 of 2 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m22:51:34.961681 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m22:51:34.961918 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m22:51:34.963700 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m22:51:34.964239 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m22:51:34.966225 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m22:51:34.966642 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
        video_id,
        SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
        COALESCE(channel_Id, 'Not Given') AS channel_Id,
        COALESCE(video_title, 'Not Given') AS video_title,
        COALESCE(channel_Title, 'Not Given') AS channel_Title,
        SAFE_CAST(categoryId AS INT64) AS categoryId,
        (
            COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
            COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
            COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
        COALESCE(dimension, 'Not Given') AS dimension,
        COALESCE(definition, 'Not Given') AS definition,
        -- Strictly BOOLEAN, no COALESCE with string
        CASE
            WHEN LOWER(caption) = 'true' THEN TRUE
            WHEN LOWER(caption) = 'false' THEN FALSE
            ELSE FALSE  -- or NULL if you prefer
        END AS caption,
        COALESCE(licensedContent, 'Not Given') AS licensedContent,
        COALESCE(madeForKids, 'Not Given') AS madeForKids,
        SAFE_CAST(viewCount AS INT64) AS viewCount,
        SAFE_CAST(likeCount AS INT64) AS likeCount,
        SAFE_CAST(commentCount AS INT64) AS commentCount,
        COALESCE(country, 'Not Given') AS country
    FROM
        `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;;


[0m22:51:34.967014 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:51:35.350506 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:71576aa7-e0b5-480e-85e8-e9992e03558c&page=queryresults
[0m22:51:35.351783 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:71576aa7-e0b5-480e-85e8-e9992e03558c&page=queryresults
[0m22:51:35.362576 [debug] [Thread-1  ]: Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Unexpected ";" at [36:26]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m22:51:35.363641 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b3b6405-90ee-496c-9255-f290f865ce12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144286ee0>]}
[0m22:51:35.364913 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model youtubeDataAnalysis.src_videos ............ [[31mERROR[0m in 0.40s]
[0m22:51:35.365586 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m22:51:35.366156 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.src_videos' to be skipped because of status 'error'.  Reason: Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Unexpected ";" at [36:26]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql.
[0m22:51:35.367176 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:51:35.369012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:51:35.369387 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m22:51:35.369800 [info ] [MainThread]: 
[0m22:51:35.370176 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m22:51:35.371075 [debug] [MainThread]: Command end result
[0m22:51:35.398272 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m22:51:35.399451 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m22:51:35.404006 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m22:51:35.404248 [info ] [MainThread]: 
[0m22:51:35.404502 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:51:35.404727 [info ] [MainThread]: 
[0m22:51:35.405002 [error] [MainThread]: [31mFailure in model src_videos (models/staging/src_videos.sql)[0m
[0m22:51:35.405260 [error] [MainThread]:   Database Error in model src_videos (models/staging/src_videos.sql)
  Syntax error: Unexpected ";" at [36:26]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m22:51:35.405637 [info ] [MainThread]: 
[0m22:51:35.405879 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/staging/src_videos.sql
[0m22:51:35.406083 [info ] [MainThread]: 
[0m22:51:35.406308 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m22:51:35.407941 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.390315, "process_in_blocks": "0", "process_kernel_time": 0.317551, "process_mem_max_rss": "337952768", "process_out_blocks": "0", "process_user_time": 2.350164}
[0m22:51:35.408219 [debug] [MainThread]: Command `dbt run` failed at 22:51:35.408168 after 4.39 seconds
[0m22:51:35.408483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141fe9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1424ec3a0>]}
[0m22:51:35.408762 [debug] [MainThread]: Flushing usage events
[0m22:51:35.806563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:51:47.868678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc6640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503a820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503a640>]}


============================== 22:51:47.871532 | a89a1fa5-3f27-47be-b2df-415aa6475a95 ==============================
[0m22:51:47.871532 [info ] [MainThread]: Running with dbt=1.10.8
[0m22:51:47.871953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'profiles_dir': '/Users/divya21raj/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:51:49.323715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a89a1fa5-3f27-47be-b2df-415aa6475a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fcb0d00>]}
[0m22:51:49.355662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a89a1fa5-3f27-47be-b2df-415aa6475a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105019ee0>]}
[0m22:51:49.356018 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:51:49.525249 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m22:51:49.584615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:51:49.584854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:51:49.588497 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m22:51:49.603086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a89a1fa5-3f27-47be-b2df-415aa6475a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14029f130>]}
[0m22:51:49.646704 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m22:51:49.649104 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m22:51:49.660240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a89a1fa5-3f27-47be-b2df-415aa6475a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1402c18b0>]}
[0m22:51:49.660536 [info ] [MainThread]: Found 3 models, 496 macros
[0m22:51:49.660758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a89a1fa5-3f27-47be-b2df-415aa6475a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fd18a00>]}
[0m22:51:49.661468 [info ] [MainThread]: 
[0m22:51:49.661694 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:51:49.661872 [info ] [MainThread]: 
[0m22:51:49.662152 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:51:49.664589 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m22:51:49.664823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:51:50.315007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m22:51:50.316414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:51:50.709068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a89a1fa5-3f27-47be-b2df-415aa6475a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fdff910>]}
[0m22:51:50.710659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:51:50.718463 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m22:51:50.719514 [info ] [Thread-1  ]: 1 of 2 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m22:51:50.720328 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m22:51:50.720955 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m22:51:50.732902 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m22:51:50.734122 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m22:51:50.762134 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m22:51:50.763344 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m22:51:50.763685 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:51:51.443455 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:a98597b3-4a9d-4cc2-a630-1d2fe2e75d5c&page=queryresults
[0m22:51:52.012435 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89a1fa5-3f27-47be-b2df-415aa6475a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140253d60>]}
[0m22:51:52.013255 [info ] [Thread-1  ]: 1 of 2 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m22:51:52.013807 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m22:51:52.014125 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m22:51:52.014596 [info ] [Thread-1  ]: 2 of 2 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m22:51:52.014975 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m22:51:52.015254 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m22:51:52.017647 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m22:51:52.018286 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m22:51:52.020570 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m22:51:52.021036 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
        video_id,
        SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
        COALESCE(channel_Id, 'Not Given') AS channel_Id,
        COALESCE(video_title, 'Not Given') AS video_title,
        COALESCE(channel_Title, 'Not Given') AS channel_Title,
        SAFE_CAST(categoryId AS INT64) AS categoryId,
        (
            COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
            COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
            COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
        COALESCE(dimension, 'Not Given') AS dimension,
        COALESCE(definition, 'Not Given') AS definition,
        -- Strictly BOOLEAN, no COALESCE with string
        CASE
            WHEN LOWER(caption) = 'true' THEN TRUE
            WHEN LOWER(caption) = 'false' THEN FALSE
            ELSE FALSE  -- or NULL if you prefer
        END AS caption,
        COALESCE(licensedContent, 'Not Given') AS licensedContent,
        COALESCE(madeForKids, 'Not Given') AS madeForKids,
        SAFE_CAST(viewCount AS INT64) AS viewCount,
        SAFE_CAST(likeCount AS INT64) AS likeCount,
        SAFE_CAST(commentCount AS INT64) AS commentCount,
        COALESCE(country, 'Not Given') AS country
    FROM
        `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m22:51:52.021375 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:51:52.871442 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:d76f9bf0-13b6-4974-bfc9-cd1da1ecd36f&page=queryresults
[0m22:51:53.062846 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:d76f9bf0-13b6-4974-bfc9-cd1da1ecd36f&page=queryresults
[0m22:51:53.075881 [debug] [Thread-1  ]: Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function COALESCE
    Argument types: BOOL, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {BOOL, STRING} at [27:9]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m22:51:53.077057 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89a1fa5-3f27-47be-b2df-415aa6475a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142344a30>]}
[0m22:51:53.078074 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model youtubeDataAnalysis.src_videos ............ [[31mERROR[0m in 1.06s]
[0m22:51:53.078880 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m22:51:53.079663 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.src_videos' to be skipped because of status 'error'.  Reason: Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function COALESCE
    Argument types: BOOL, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {BOOL, STRING} at [27:9]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql.
[0m22:51:53.081243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:51:53.083112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:51:53.083483 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m22:51:53.083934 [info ] [MainThread]: 
[0m22:51:53.084393 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.42 seconds (3.42s).
[0m22:51:53.085440 [debug] [MainThread]: Command end result
[0m22:51:53.111536 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m22:51:53.113553 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m22:51:53.118827 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m22:51:53.119073 [info ] [MainThread]: 
[0m22:51:53.119344 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:51:53.119579 [info ] [MainThread]: 
[0m22:51:53.119857 [error] [MainThread]: [31mFailure in model src_videos (models/staging/src_videos.sql)[0m
[0m22:51:53.120125 [error] [MainThread]:   Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function COALESCE
    Argument types: BOOL, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {BOOL, STRING} at [27:9]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m22:51:53.120336 [info ] [MainThread]: 
[0m22:51:53.120597 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/staging/src_videos.sql
[0m22:51:53.120810 [info ] [MainThread]: 
[0m22:51:53.121045 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m22:51:53.122803 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.294051, "process_in_blocks": "0", "process_kernel_time": 0.336093, "process_mem_max_rss": "334331904", "process_out_blocks": "0", "process_user_time": 2.356401}
[0m22:51:53.123128 [debug] [MainThread]: Command `dbt run` failed at 22:51:53.123073 after 5.29 seconds
[0m22:51:53.123418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc6640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105019ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1402b6a30>]}
[0m22:51:53.123671 [debug] [MainThread]: Flushing usage events
[0m22:51:53.465798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:56:41.557215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10341e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044938b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044936d0>]}


============================== 22:56:41.560305 | 1628b0ae-0dfb-4852-a61f-ea74401ad983 ==============================
[0m22:56:41.560305 [info ] [MainThread]: Running with dbt=1.10.8
[0m22:56:41.560849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'profiles_dir': '/Users/divya21raj/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:56:43.371299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1628b0ae-0dfb-4852-a61f-ea74401ad983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116dce100>]}
[0m22:56:43.402927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1628b0ae-0dfb-4852-a61f-ea74401ad983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116dad160>]}
[0m22:56:43.403281 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:56:43.570996 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m22:56:43.628608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:56:43.628835 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:56:43.632682 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m22:56:43.646867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1628b0ae-0dfb-4852-a61f-ea74401ad983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1173a0f40>]}
[0m22:56:43.690209 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m22:56:43.691749 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m22:56:43.703300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1628b0ae-0dfb-4852-a61f-ea74401ad983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1173c2280>]}
[0m22:56:43.703597 [info ] [MainThread]: Found 3 models, 496 macros
[0m22:56:43.703815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1628b0ae-0dfb-4852-a61f-ea74401ad983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116f2f5e0>]}
[0m22:56:43.704546 [info ] [MainThread]: 
[0m22:56:43.704758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:56:43.704929 [info ] [MainThread]: 
[0m22:56:43.705210 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:56:43.707616 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m22:56:43.707849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:44.140739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m22:56:44.142158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:56:44.586780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1628b0ae-0dfb-4852-a61f-ea74401ad983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116f21790>]}
[0m22:56:44.588333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:56:44.595155 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m22:56:44.596128 [info ] [Thread-1  ]: 1 of 2 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m22:56:44.596793 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m22:56:44.597296 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m22:56:44.609037 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m22:56:44.612257 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m22:56:44.638092 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m22:56:44.638892 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m22:56:44.639246 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:56:45.330932 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:ec6e7f13-0879-4cd3-beb5-fddf0732d832&page=queryresults
[0m22:56:45.757234 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1628b0ae-0dfb-4852-a61f-ea74401ad983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1173536d0>]}
[0m22:56:45.757673 [info ] [Thread-1  ]: 1 of 2 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m22:56:45.758033 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m22:56:45.758279 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m22:56:45.758573 [info ] [Thread-1  ]: 2 of 2 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m22:56:45.758822 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m22:56:45.759035 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m22:56:45.760684 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m22:56:45.761325 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m22:56:45.763130 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m22:56:45.763531 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
        video_id,
        SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
        COALESCE(channel_Id, 'Not Given') AS channel_Id,
        COALESCE(video_title, 'Not Given') AS video_title,
        COALESCE(channel_Title, 'Not Given') AS channel_Title,
        SAFE_CAST(categoryId AS INT64) AS categoryId,
        (
            COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
            COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
            COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
        COALESCE(dimension, 'Not Given') AS dimension,
        COALESCE(definition, 'Not Given') AS definition,
        -- Strictly BOOLEAN, no COALESCE with string
        CAST(
            CASE
            WHEN LOWER(caption) = 'true' THEN TRUE
            WHEN LOWER(caption) = 'false' THEN FALSE
            ELSE FALSE
            END AS BOOL
        ) AS caption,
        COALESCE(licensedContent, 'Not Given') AS licensedContent,
        COALESCE(madeForKids, 'Not Given') AS madeForKids,
        SAFE_CAST(viewCount AS INT64) AS viewCount,
        SAFE_CAST(likeCount AS INT64) AS likeCount,
        SAFE_CAST(commentCount AS INT64) AS commentCount,
        COALESCE(country, 'Not Given') AS country
    FROM
        `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m22:56:45.763843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:56:46.386145 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:da3cc7a8-1c43-4c5a-adfe-57ca60dccb1f&page=queryresults
[0m22:56:46.560179 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:da3cc7a8-1c43-4c5a-adfe-57ca60dccb1f&page=queryresults
[0m22:56:46.575172 [debug] [Thread-1  ]: Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function COALESCE
    Argument types: BOOL, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {BOOL, STRING} at [29:9]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m22:56:46.576277 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1628b0ae-0dfb-4852-a61f-ea74401ad983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178bfbb0>]}
[0m22:56:46.577215 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model youtubeDataAnalysis.src_videos ............ [[31mERROR[0m in 0.82s]
[0m22:56:46.577991 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m22:56:46.578684 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.src_videos' to be skipped because of status 'error'.  Reason: Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function COALESCE
    Argument types: BOOL, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {BOOL, STRING} at [29:9]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql.
[0m22:56:46.580053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:56:46.582377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:46.582755 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m22:56:46.583184 [info ] [MainThread]: 
[0m22:56:46.583612 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m22:56:46.584506 [debug] [MainThread]: Command end result
[0m22:56:46.614295 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m22:56:46.615477 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m22:56:46.620107 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m22:56:46.620340 [info ] [MainThread]: 
[0m22:56:46.620595 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:56:46.620847 [info ] [MainThread]: 
[0m22:56:46.621116 [error] [MainThread]: [31mFailure in model src_videos (models/staging/src_videos.sql)[0m
[0m22:56:46.621377 [error] [MainThread]:   Database Error in model src_videos (models/staging/src_videos.sql)
  No matching signature for function COALESCE
    Argument types: BOOL, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {BOOL, STRING} at [29:9]
  compiled code at target/run/youtubeAnalysis/models/staging/src_videos.sql
[0m22:56:46.621587 [info ] [MainThread]: 
[0m22:56:46.621820 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/staging/src_videos.sql
[0m22:56:46.622017 [info ] [MainThread]: 
[0m22:56:46.622246 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m22:56:46.624579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.109885, "process_in_blocks": "0", "process_kernel_time": 0.369829, "process_mem_max_rss": "344506368", "process_out_blocks": "0", "process_user_time": 2.352308}
[0m22:56:46.624897 [debug] [MainThread]: Command `dbt run` failed at 22:56:46.624837 after 5.11 seconds
[0m22:56:46.625174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10341e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102995a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116dce100>]}
[0m22:56:46.625433 [debug] [MainThread]: Flushing usage events
[0m22:56:47.021978 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:09.580223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727a8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727a6d0>]}


============================== 23:03:09.584308 | 1c600860-c42f-43ba-adbc-00cb77b76479 ==============================
[0m23:03:09.584308 [info ] [MainThread]: Running with dbt=1.10.8
[0m23:03:09.584673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:03:11.370920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c600860-c42f-43ba-adbc-00cb77b76479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722a970>]}
[0m23:03:11.403014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c600860-c42f-43ba-adbc-00cb77b76479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b26cd0>]}
[0m23:03:11.403347 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m23:03:11.576528 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m23:03:11.634462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:03:11.634722 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:03:11.638332 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m23:03:11.652776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c600860-c42f-43ba-adbc-00cb77b76479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1a4e80>]}
[0m23:03:11.704684 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:03:11.706071 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:03:11.717245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c600860-c42f-43ba-adbc-00cb77b76479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1b35b0>]}
[0m23:03:11.717529 [info ] [MainThread]: Found 3 models, 496 macros
[0m23:03:11.717738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c600860-c42f-43ba-adbc-00cb77b76479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a15a730>]}
[0m23:03:11.718475 [info ] [MainThread]: 
[0m23:03:11.718705 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:03:11.718880 [info ] [MainThread]: 
[0m23:03:11.719158 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:03:11.721633 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m23:03:11.721880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:12.206904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m23:03:12.208246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:12.636991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c600860-c42f-43ba-adbc-00cb77b76479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a14fc10>]}
[0m23:03:12.638507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:03:12.646031 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m23:03:12.647057 [info ] [Thread-1  ]: 1 of 2 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m23:03:12.647879 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m23:03:12.648505 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m23:03:12.660960 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m23:03:12.662553 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m23:03:12.689111 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m23:03:12.689953 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m23:03:12.690300 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:03:13.428244 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:de2f585b-7d38-4778-b237-04b36cc3836e&page=queryresults
[0m23:03:14.030407 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c600860-c42f-43ba-adbc-00cb77b76479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a27ee50>]}
[0m23:03:14.030926 [info ] [Thread-1  ]: 1 of 2 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m23:03:14.031344 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m23:03:14.031622 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m23:03:14.031994 [info ] [Thread-1  ]: 2 of 2 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m23:03:14.032339 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m23:03:14.032604 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m23:03:14.034254 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m23:03:14.034695 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m23:03:14.037143 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m23:03:14.037646 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    CASE
    WHEN LOWER(caption) = 'true' THEN TRUE
    WHEN LOWER(caption) = 'false' THEN FALSE
    ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m23:03:14.037992 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:03:14.765505 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:919e313c-0e32-4488-a8fb-660b88eec15c&page=queryresults
[0m23:03:15.145880 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c600860-c42f-43ba-adbc-00cb77b76479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc2250>]}
[0m23:03:15.147522 [info ] [Thread-1  ]: 2 of 2 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m23:03:15.148524 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m23:03:15.150233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:03:15.153299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:15.153842 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m23:03:15.154372 [info ] [MainThread]: 
[0m23:03:15.154824 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.44 seconds (3.44s).
[0m23:03:15.155972 [debug] [MainThread]: Command end result
[0m23:03:15.189715 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:03:15.191084 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:03:15.196007 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m23:03:15.196289 [info ] [MainThread]: 
[0m23:03:15.196592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:03:15.196807 [info ] [MainThread]: 
[0m23:03:15.197069 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:03:15.199391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.662039, "process_in_blocks": "0", "process_kernel_time": 0.387396, "process_mem_max_rss": "339230720", "process_out_blocks": "0", "process_user_time": 2.365644}
[0m23:03:15.199714 [debug] [MainThread]: Command `dbt run` succeeded at 23:03:15.199654 after 5.66 seconds
[0m23:03:15.199989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b26cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a14f970>]}
[0m23:03:15.200250 [debug] [MainThread]: Flushing usage events
[0m23:03:15.587714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:06:28.307182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ad700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105123850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105123670>]}


============================== 23:06:28.310749 | 86d37172-0df4-4bf7-8d15-daba5ea068a9 ==============================
[0m23:06:28.310749 [info ] [MainThread]: Running with dbt=1.10.8
[0m23:06:28.311109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:06:30.115777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86d37172-0df4-4bf7-8d15-daba5ea068a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516bbe0>]}
[0m23:06:30.149577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86d37172-0df4-4bf7-8d15-daba5ea068a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125050700>]}
[0m23:06:30.149965 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m23:06:30.321148 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m23:06:30.382881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:06:30.383111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:06:30.386823 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m23:06:30.402066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86d37172-0df4-4bf7-8d15-daba5ea068a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125664e50>]}
[0m23:06:30.444595 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:06:30.446083 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:06:30.457535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86d37172-0df4-4bf7-8d15-daba5ea068a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125681ac0>]}
[0m23:06:30.457822 [info ] [MainThread]: Found 3 models, 496 macros
[0m23:06:30.458031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86d37172-0df4-4bf7-8d15-daba5ea068a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125621550>]}
[0m23:06:30.458757 [info ] [MainThread]: 
[0m23:06:30.458978 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:06:30.459165 [info ] [MainThread]: 
[0m23:06:30.459438 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:06:30.461994 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m23:06:30.462260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:30.896009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m23:06:30.897531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:06:31.345324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86d37172-0df4-4bf7-8d15-daba5ea068a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125681f70>]}
[0m23:06:31.346237 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:06:31.351562 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_daily
[0m23:06:31.352356 [info ] [Thread-1  ]: 1 of 3 START sql view model youtubeDataAnalysis.combined_daily ................. [RUN]
[0m23:06:31.352966 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.combined_daily)
[0m23:06:31.353677 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_daily
[0m23:06:31.367583 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_daily"
[0m23:06:31.368677 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_daily
[0m23:06:31.396345 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_daily"
[0m23:06:31.397057 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
  OPTIONS()
  as SELECT
    v.*,
    c.category_title
FROM `youtubeDataAnalysis.src_videos` v
LEFT JOIN `youtubeDataAnalysis.src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name;;


[0m23:06:31.397428 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:06:31.792065 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:20febd2f-4bd0-47e1-9252-97e9f57816f0&page=queryresults
[0m23:06:31.793545 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:20febd2f-4bd0-47e1-9252-97e9f57816f0&page=queryresults
[0m23:06:31.806128 [debug] [Thread-1  ]: Database Error in model combined_daily (models/daily/combined_daily.sql)
  Syntax error: Unexpected ";" at [12:35]
  compiled code at target/run/youtubeAnalysis/models/daily/combined_daily.sql
[0m23:06:31.809932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86d37172-0df4-4bf7-8d15-daba5ea068a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12566f0a0>]}
[0m23:06:31.811326 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model youtubeDataAnalysis.combined_daily ........ [[31mERROR[0m in 0.45s]
[0m23:06:31.812356 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_daily
[0m23:06:31.813026 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m23:06:31.813748 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.combined_daily' to be skipped because of status 'error'.  Reason: Database Error in model combined_daily (models/daily/combined_daily.sql)
  Syntax error: Unexpected ";" at [12:35]
  compiled code at target/run/youtubeAnalysis/models/daily/combined_daily.sql.
[0m23:06:31.815077 [info ] [Thread-1  ]: 2 of 3 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m23:06:31.816150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_daily, now model.youtubeAnalysis.src_categories)
[0m23:06:31.816797 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m23:06:31.820293 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m23:06:31.821213 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m23:06:31.824664 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m23:06:31.825884 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m23:06:31.826343 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:06:32.496027 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:aa330832-e435-4287-b081-d266e8912723&page=queryresults
[0m23:06:33.111733 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86d37172-0df4-4bf7-8d15-daba5ea068a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104355730>]}
[0m23:06:33.112366 [info ] [Thread-1  ]: 2 of 3 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m23:06:33.112866 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m23:06:33.113171 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m23:06:33.113583 [info ] [Thread-1  ]: 3 of 3 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m23:06:33.113998 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m23:06:33.114288 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m23:06:33.116074 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m23:06:33.116516 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m23:06:33.118720 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m23:06:33.119245 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    CASE
    WHEN LOWER(caption) = 'true' THEN TRUE
    WHEN LOWER(caption) = 'false' THEN FALSE
    ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m23:06:33.119581 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:06:33.824583 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:3a8612e3-d33b-49ab-94fe-53f53c12a364&page=queryresults
[0m23:06:34.351351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86d37172-0df4-4bf7-8d15-daba5ea068a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12566f0a0>]}
[0m23:06:34.353208 [info ] [Thread-1  ]: 3 of 3 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m23:06:34.354194 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m23:06:34.356274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:06:34.359216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:06:34.359781 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m23:06:34.360448 [info ] [MainThread]: 
[0m23:06:34.361155 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.90 seconds (3.90s).
[0m23:06:34.362626 [debug] [MainThread]: Command end result
[0m23:06:34.392718 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:06:34.400548 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:06:34.407765 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m23:06:34.408032 [info ] [MainThread]: 
[0m23:06:34.408321 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:06:34.408560 [info ] [MainThread]: 
[0m23:06:34.408857 [error] [MainThread]: [31mFailure in model combined_daily (models/daily/combined_daily.sql)[0m
[0m23:06:34.409134 [error] [MainThread]:   Database Error in model combined_daily (models/daily/combined_daily.sql)
  Syntax error: Unexpected ";" at [12:35]
  compiled code at target/run/youtubeAnalysis/models/daily/combined_daily.sql
[0m23:06:34.409346 [info ] [MainThread]: 
[0m23:06:34.409595 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/daily/combined_daily.sql
[0m23:06:34.409808 [info ] [MainThread]: 
[0m23:06:34.410046 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m23:06:34.412424 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.1531773, "process_in_blocks": "0", "process_kernel_time": 0.376426, "process_mem_max_rss": "340836352", "process_out_blocks": "0", "process_user_time": 2.465334}
[0m23:06:34.412866 [debug] [MainThread]: Command `dbt run` failed at 23:06:34.412784 after 6.15 seconds
[0m23:06:34.413239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ad700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125681ac0>]}
[0m23:06:34.413510 [debug] [MainThread]: Flushing usage events
[0m23:06:34.848033 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:06:46.643095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ef850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ef670>]}


============================== 23:06:46.646449 | 805c68a3-c400-4480-90f1-62418894966e ==============================
[0m23:06:46.646449 [info ] [MainThread]: Running with dbt=1.10.8
[0m23:06:46.646809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'debug': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:06:48.266453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '805c68a3-c400-4480-90f1-62418894966e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130d51af0>]}
[0m23:06:48.298942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '805c68a3-c400-4480-90f1-62418894966e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110795c10>]}
[0m23:06:48.299306 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m23:06:48.511583 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m23:06:48.575748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:06:48.576051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:06:48.580146 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m23:06:48.599410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '805c68a3-c400-4480-90f1-62418894966e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14355ffd0>]}
[0m23:06:48.651667 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:06:48.653663 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:06:48.666753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '805c68a3-c400-4480-90f1-62418894966e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143575ca0>]}
[0m23:06:48.667139 [info ] [MainThread]: Found 3 models, 496 macros
[0m23:06:48.667411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '805c68a3-c400-4480-90f1-62418894966e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143573670>]}
[0m23:06:48.668268 [info ] [MainThread]: 
[0m23:06:48.668511 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:06:48.668689 [info ] [MainThread]: 
[0m23:06:48.668994 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:06:48.671687 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m23:06:48.671965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:49.105245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m23:06:49.106644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:06:49.606595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '805c68a3-c400-4480-90f1-62418894966e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14356e310>]}
[0m23:06:49.607920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:06:49.614604 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_daily
[0m23:06:49.615612 [info ] [Thread-1  ]: 1 of 3 START sql view model youtubeDataAnalysis.combined_daily ................. [RUN]
[0m23:06:49.616406 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.combined_daily)
[0m23:06:49.617030 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_daily
[0m23:06:49.630571 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_daily"
[0m23:06:49.631485 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_daily
[0m23:06:49.658449 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_daily"
[0m23:06:49.659083 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
  OPTIONS()
  as SELECT
    v.*,
    c.category_title
FROM `youtubeDataAnalysis.src_videos` v
LEFT JOIN `youtubeDataAnalysis.src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name;


[0m23:06:49.659459 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:06:50.519568 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:4bf564ac-13a0-4ec1-8da2-cc3d0f0d8235&page=queryresults
[0m23:06:50.932967 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '805c68a3-c400-4480-90f1-62418894966e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143513d00>]}
[0m23:06:50.933707 [info ] [Thread-1  ]: 1 of 3 OK created sql view model youtubeDataAnalysis.combined_daily ............ [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m23:06:50.934158 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_daily
[0m23:06:50.934479 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m23:06:50.934868 [info ] [Thread-1  ]: 2 of 3 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m23:06:50.935321 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_daily, now model.youtubeAnalysis.src_categories)
[0m23:06:50.935625 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m23:06:50.938280 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m23:06:50.938793 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m23:06:50.941547 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m23:06:50.942080 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m23:06:50.942506 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:06:51.511783 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:7d110dc5-bd3a-4bea-a0e1-b62c71d3d0c3&page=queryresults
[0m23:06:52.073992 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '805c68a3-c400-4480-90f1-62418894966e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110121730>]}
[0m23:06:52.074826 [info ] [Thread-1  ]: 2 of 3 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m23:06:52.075241 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m23:06:52.075554 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m23:06:52.075927 [info ] [Thread-1  ]: 3 of 3 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m23:06:52.076207 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m23:06:52.076440 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m23:06:52.078487 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m23:06:52.078966 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m23:06:52.081030 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m23:06:52.081565 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    CASE
    WHEN LOWER(caption) = 'true' THEN TRUE
    WHEN LOWER(caption) = 'false' THEN FALSE
    ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m23:06:52.082039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:06:52.696293 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:e1654734-70b5-4ddb-953c-29bfeaccbecc&page=queryresults
[0m23:06:53.565069 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '805c68a3-c400-4480-90f1-62418894966e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110121730>]}
[0m23:06:53.566936 [info ] [Thread-1  ]: 3 of 3 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m23:06:53.568142 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m23:06:53.570833 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:06:53.574080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:06:53.574690 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m23:06:53.575428 [info ] [MainThread]: 
[0m23:06:53.576050 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m23:06:53.577708 [debug] [MainThread]: Command end result
[0m23:06:53.608856 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:06:53.612078 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:06:53.618487 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m23:06:53.618748 [info ] [MainThread]: 
[0m23:06:53.619050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:06:53.619286 [info ] [MainThread]: 
[0m23:06:53.619547 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:06:53.621602 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0304036, "process_in_blocks": "0", "process_kernel_time": 0.358291, "process_mem_max_rss": "327204864", "process_out_blocks": "0", "process_user_time": 2.501027}
[0m23:06:53.621971 [debug] [MainThread]: Command `dbt run` succeeded at 23:06:53.621905 after 7.03 seconds
[0m23:06:53.622303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145393460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120c56d0>]}
[0m23:06:53.622593 [debug] [MainThread]: Flushing usage events
[0m23:06:53.955829 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:23:27.102244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e6670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123ef8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123ef700>]}


============================== 23:23:27.105255 | fb5c9ec1-9e75-46dd-8c97-244a865233c8 ==============================
[0m23:23:27.105255 [info ] [MainThread]: Running with dbt=1.10.8
[0m23:23:27.105629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:23:29.036046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb5c9ec1-9e75-46dd-8c97-244a865233c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144912250>]}
[0m23:23:29.068972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb5c9ec1-9e75-46dd-8c97-244a865233c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12298ed60>]}
[0m23:23:29.069359 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m23:23:29.237321 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m23:23:29.295646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:23:29.295885 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:23:29.299531 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m23:23:29.313801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb5c9ec1-9e75-46dd-8c97-244a865233c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144fe5e80>]}
[0m23:23:29.355332 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:23:29.357060 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:23:29.406724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb5c9ec1-9e75-46dd-8c97-244a865233c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144fed970>]}
[0m23:23:29.407131 [info ] [MainThread]: Found 3 models, 496 macros
[0m23:23:29.407360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb5c9ec1-9e75-46dd-8c97-244a865233c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126db20>]}
[0m23:23:29.408195 [info ] [MainThread]: 
[0m23:23:29.408427 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:23:29.408611 [info ] [MainThread]: 
[0m23:23:29.408902 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:23:29.411430 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m23:23:29.411676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:29.894487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m23:23:29.895182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:30.310321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb5c9ec1-9e75-46dd-8c97-244a865233c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144fa0520>]}
[0m23:23:30.311885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:23:30.320579 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_daily
[0m23:23:30.321733 [info ] [Thread-1  ]: 1 of 3 START sql view model youtubeDataAnalysis.combined_daily ................. [RUN]
[0m23:23:30.322624 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.combined_daily)
[0m23:23:30.323274 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_daily
[0m23:23:30.335960 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_daily"
[0m23:23:30.337108 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_daily
[0m23:23:30.364145 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_daily"
[0m23:23:30.364755 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
  OPTIONS()
  as SELECT
    v.*,
    c.category_title,
    CURRENT_DATE() AS trending_date
FROM `youtubeDataAnalysis.src_videos` v
LEFT JOIN `youtubeDataAnalysis.src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name;;


[0m23:23:30.365088 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:23:30.892667 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:6d5c6966-00c2-43e9-9dd2-085ec0f7df96&page=queryresults
[0m23:23:30.894742 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:6d5c6966-00c2-43e9-9dd2-085ec0f7df96&page=queryresults
[0m23:23:30.907786 [debug] [Thread-1  ]: Database Error in model combined_daily (models/daily/combined_daily.sql)
  Syntax error: Unexpected ";" at [13:35]
  compiled code at target/run/youtubeAnalysis/models/daily/combined_daily.sql
[0m23:23:30.910894 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb5c9ec1-9e75-46dd-8c97-244a865233c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b123a0>]}
[0m23:23:30.911881 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model youtubeDataAnalysis.combined_daily ........ [[31mERROR[0m in 0.59s]
[0m23:23:30.913302 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_daily
[0m23:23:30.913907 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m23:23:30.914541 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.combined_daily' to be skipped because of status 'error'.  Reason: Database Error in model combined_daily (models/daily/combined_daily.sql)
  Syntax error: Unexpected ";" at [13:35]
  compiled code at target/run/youtubeAnalysis/models/daily/combined_daily.sql.
[0m23:23:30.915161 [info ] [Thread-1  ]: 2 of 3 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m23:23:30.915941 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_daily, now model.youtubeAnalysis.src_categories)
[0m23:23:30.916426 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m23:23:30.919313 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m23:23:30.920862 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m23:23:30.924205 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m23:23:30.925191 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m23:23:30.925602 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:23:31.606297 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:89b58b79-4d41-434d-ba6d-39cbfdbd44c4&page=queryresults
[0m23:23:32.027220 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb5c9ec1-9e75-46dd-8c97-244a865233c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144a465b0>]}
[0m23:23:32.027746 [info ] [Thread-1  ]: 2 of 3 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m23:23:32.028175 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m23:23:32.028485 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m23:23:32.028854 [info ] [Thread-1  ]: 3 of 3 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m23:23:32.029215 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m23:23:32.029482 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m23:23:32.031100 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m23:23:32.031977 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m23:23:32.034081 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m23:23:32.034695 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    CASE
    WHEN LOWER(caption) = 'true' THEN TRUE
    WHEN LOWER(caption) = 'false' THEN FALSE
    ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m23:23:32.035186 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:23:32.626260 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:ad317803-cb0e-4c7e-a675-667efc72bdaa&page=queryresults
[0m23:23:33.033666 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb5c9ec1-9e75-46dd-8c97-244a865233c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123a14c0>]}
[0m23:23:33.035315 [info ] [Thread-1  ]: 3 of 3 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m23:23:33.036241 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m23:23:33.037455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:23:33.039646 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:33.040087 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m23:23:33.040592 [info ] [MainThread]: 
[0m23:23:33.041044 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.63 seconds (3.63s).
[0m23:23:33.042322 [debug] [MainThread]: Command end result
[0m23:23:33.069592 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:23:33.070940 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:23:33.075995 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m23:23:33.076256 [info ] [MainThread]: 
[0m23:23:33.076525 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:23:33.076760 [info ] [MainThread]: 
[0m23:23:33.077043 [error] [MainThread]: [31mFailure in model combined_daily (models/daily/combined_daily.sql)[0m
[0m23:23:33.077316 [error] [MainThread]:   Database Error in model combined_daily (models/daily/combined_daily.sql)
  Syntax error: Unexpected ";" at [13:35]
  compiled code at target/run/youtubeAnalysis/models/daily/combined_daily.sql
[0m23:23:33.077531 [info ] [MainThread]: 
[0m23:23:33.077780 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/daily/combined_daily.sql
[0m23:23:33.077995 [info ] [MainThread]: 
[0m23:23:33.078234 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m23:23:33.079911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.020162, "process_in_blocks": "0", "process_kernel_time": 0.370352, "process_mem_max_rss": "337903616", "process_out_blocks": "0", "process_user_time": 2.451786}
[0m23:23:33.080194 [debug] [MainThread]: Command `dbt run` failed at 23:23:33.080144 after 6.02 seconds
[0m23:23:33.080455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e6670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12298ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144ff5b50>]}
[0m23:23:33.080731 [debug] [MainThread]: Flushing usage events
[0m23:23:33.518807 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:23:44.099968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105797730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10680f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10680f640>]}


============================== 23:23:44.102908 | d437eba1-c9d1-4476-a2c2-e75b01680279 ==============================
[0m23:23:44.102908 [info ] [MainThread]: Running with dbt=1.10.8
[0m23:23:44.103253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:23:45.668176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd437eba1-c9d1-4476-a2c2-e75b01680279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f742e0>]}
[0m23:23:45.703005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd437eba1-c9d1-4476-a2c2-e75b01680279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dd3d0>]}
[0m23:23:45.703451 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m23:23:45.876475 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m23:23:45.937830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:23:45.938099 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:23:45.942071 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m23:23:45.957185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd437eba1-c9d1-4476-a2c2-e75b01680279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13779fee0>]}
[0m23:23:46.000361 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:23:46.002010 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:23:46.012268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd437eba1-c9d1-4476-a2c2-e75b01680279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1377c1190>]}
[0m23:23:46.012573 [info ] [MainThread]: Found 3 models, 496 macros
[0m23:23:46.012815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd437eba1-c9d1-4476-a2c2-e75b01680279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137696070>]}
[0m23:23:46.013546 [info ] [MainThread]: 
[0m23:23:46.013781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:23:46.013989 [info ] [MainThread]: 
[0m23:23:46.014274 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:23:46.016859 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m23:23:46.017086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:46.419764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m23:23:46.420883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:46.809590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd437eba1-c9d1-4476-a2c2-e75b01680279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e0ca0>]}
[0m23:23:46.811178 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:23:46.818129 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_daily
[0m23:23:46.819174 [info ] [Thread-1  ]: 1 of 3 START sql view model youtubeDataAnalysis.combined_daily ................. [RUN]
[0m23:23:46.819930 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.combined_daily)
[0m23:23:46.820545 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_daily
[0m23:23:46.832941 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_daily"
[0m23:23:46.834134 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_daily
[0m23:23:46.861145 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_daily"
[0m23:23:46.861795 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
  OPTIONS()
  as SELECT
    v.*,
    c.category_title,
    CURRENT_DATE() AS trending_date
FROM `youtubeDataAnalysis.src_videos` v
LEFT JOIN `youtubeDataAnalysis.src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name;


[0m23:23:46.862137 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:23:47.888734 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:585c4be8-67ba-418d-8703-e419d513a93a&page=queryresults
[0m23:23:48.338138 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd437eba1-c9d1-4476-a2c2-e75b01680279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137754b50>]}
[0m23:23:48.338730 [info ] [Thread-1  ]: 1 of 3 OK created sql view model youtubeDataAnalysis.combined_daily ............ [[32mCREATE VIEW (0 processed)[0m in 1.52s]
[0m23:23:48.339166 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_daily
[0m23:23:48.339465 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m23:23:48.339837 [info ] [Thread-1  ]: 2 of 3 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m23:23:48.340141 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_daily, now model.youtubeAnalysis.src_categories)
[0m23:23:48.340396 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m23:23:48.342373 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m23:23:48.342810 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m23:23:48.344920 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m23:23:48.345376 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m23:23:48.345719 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:23:49.116923 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:d9e7d0e6-325a-489a-b76d-ae9b99e68298&page=queryresults
[0m23:23:49.689981 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd437eba1-c9d1-4476-a2c2-e75b01680279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105256880>]}
[0m23:23:49.691899 [info ] [Thread-1  ]: 2 of 3 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m23:23:49.693087 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m23:23:49.693769 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m23:23:49.694543 [info ] [Thread-1  ]: 3 of 3 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m23:23:49.695178 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m23:23:49.695620 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m23:23:49.698567 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m23:23:49.699403 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m23:23:49.703380 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m23:23:49.704133 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    CASE
    WHEN LOWER(caption) = 'true' THEN TRUE
    WHEN LOWER(caption) = 'false' THEN FALSE
    ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m23:23:49.704615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:23:50.376903 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:d818dea0-2cb8-413a-9517-a502b75d57a5&page=queryresults
[0m23:23:50.753312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd437eba1-c9d1-4476-a2c2-e75b01680279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1409502b0>]}
[0m23:23:50.754829 [info ] [Thread-1  ]: 3 of 3 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m23:23:50.756005 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m23:23:50.758259 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:23:50.761625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:50.762314 [debug] [MainThread]: Connection 'model.youtubeAnalysis.src_videos' was properly closed.
[0m23:23:50.763058 [info ] [MainThread]: 
[0m23:23:50.763683 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m23:23:50.765346 [debug] [MainThread]: Command end result
[0m23:23:50.795638 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:23:50.797704 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:23:50.803201 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m23:23:50.803464 [info ] [MainThread]: 
[0m23:23:50.803762 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:23:50.803993 [info ] [MainThread]: 
[0m23:23:50.804242 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:23:50.806018 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7477946, "process_in_blocks": "0", "process_kernel_time": 0.320707, "process_mem_max_rss": "336756736", "process_out_blocks": "0", "process_user_time": 2.471958}
[0m23:23:50.806366 [debug] [MainThread]: Command `dbt run` succeeded at 23:23:50.806308 after 6.75 seconds
[0m23:23:50.806671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105797730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13788b2b0>]}
[0m23:23:50.806942 [debug] [MainThread]: Flushing usage events
[0m23:23:51.215118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:35:12.743459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107972610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e7430>]}


============================== 23:35:12.747501 | 958b58c5-2366-4254-a4c3-e7dc3e6c304d ==============================
[0m23:35:12.747501 [info ] [MainThread]: Running with dbt=1.10.8
[0m23:35:12.747876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'profiles_dir': '/Users/divya21raj/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:35:14.675986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '958b58c5-2366-4254-a4c3-e7dc3e6c304d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106177b80>]}
[0m23:35:14.708630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '958b58c5-2366-4254-a4c3-e7dc3e6c304d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b319790>]}
[0m23:35:14.708974 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m23:35:14.881961 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m23:35:14.954430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:35:14.954659 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:35:14.958308 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m23:35:14.972837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '958b58c5-2366-4254-a4c3-e7dc3e6c304d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8e4130>]}
[0m23:35:15.013775 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:35:15.015285 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:35:15.026047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '958b58c5-2366-4254-a4c3-e7dc3e6c304d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b9074c0>]}
[0m23:35:15.026334 [info ] [MainThread]: Found 4 models, 496 macros
[0m23:35:15.026545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '958b58c5-2366-4254-a4c3-e7dc3e6c304d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b35fdf0>]}
[0m23:35:15.027386 [info ] [MainThread]: 
[0m23:35:15.027636 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:35:15.027860 [info ] [MainThread]: 
[0m23:35:15.028160 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:35:15.030815 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m23:35:15.031088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:15.463277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m23:35:15.464776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:15.905940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '958b58c5-2366-4254-a4c3-e7dc3e6c304d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8a55e0>]}
[0m23:35:15.907450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:35:15.913844 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_daily
[0m23:35:15.914857 [info ] [Thread-1  ]: 1 of 4 START sql view model youtubeDataAnalysis.combined_daily ................. [RUN]
[0m23:35:15.915656 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.combined_daily)
[0m23:35:15.916275 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_daily
[0m23:35:15.928529 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_daily"
[0m23:35:15.929931 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_daily
[0m23:35:15.956607 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_daily"
[0m23:35:15.957187 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
  OPTIONS()
  as SELECT
    v.*,
    c.category_title,
    CURRENT_DATE() AS trending_date
FROM `youtubeDataAnalysis.src_videos` v
LEFT JOIN `youtubeDataAnalysis.src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name;


[0m23:35:15.957511 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:35:16.847400 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:5970b17e-4511-467d-8165-76eb46bddc97&page=queryresults
[0m23:35:17.304994 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '958b58c5-2366-4254-a4c3-e7dc3e6c304d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b42cbb0>]}
[0m23:35:17.305509 [info ] [Thread-1  ]: 1 of 4 OK created sql view model youtubeDataAnalysis.combined_daily ............ [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m23:35:17.305929 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_daily
[0m23:35:17.306210 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m23:35:17.306563 [info ] [Thread-1  ]: 2 of 4 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m23:35:17.306864 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_daily, now model.youtubeAnalysis.src_categories)
[0m23:35:17.307110 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m23:35:17.308995 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m23:35:17.309655 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m23:35:17.311787 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m23:35:17.312234 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m23:35:17.312520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:35:17.870729 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:0bf49ecd-efe1-4719-8277-f2f3f3c4f158&page=queryresults
[0m23:35:18.233845 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '958b58c5-2366-4254-a4c3-e7dc3e6c304d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742eb50>]}
[0m23:35:18.235497 [info ] [Thread-1  ]: 2 of 4 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m23:35:18.236695 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m23:35:18.237441 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m23:35:18.238835 [info ] [Thread-1  ]: 3 of 4 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m23:35:18.240848 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m23:35:18.241538 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m23:35:18.245866 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m23:35:18.247047 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m23:35:18.251510 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m23:35:18.252453 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    CASE
    WHEN LOWER(caption) = 'true' THEN TRUE
    WHEN LOWER(caption) = 'false' THEN FALSE
    ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m23:35:18.253016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:35:18.895539 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:b408b914-de8b-4747-8b5b-a2dd32e12205&page=queryresults
[0m23:35:19.281036 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '958b58c5-2366-4254-a4c3-e7dc3e6c304d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b42cbb0>]}
[0m23:35:19.283051 [info ] [Thread-1  ]: 3 of 4 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m23:35:19.284248 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m23:35:19.284999 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.video_stats
[0m23:35:19.285915 [info ] [Thread-1  ]: 4 of 4 START sql view model youtubeDataAnalysis.video_stats .................... [RUN]
[0m23:35:19.286682 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_videos, now model.youtubeAnalysis.video_stats)
[0m23:35:19.287254 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.video_stats
[0m23:35:19.291815 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.video_stats"
[0m23:35:19.292961 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.video_stats
[0m23:35:19.298248 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.video_stats"
[0m23:35:19.299316 [debug] [Thread-1  ]: On model.youtubeAnalysis.video_stats: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.video_stats"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`video_stats`
  OPTIONS()
  as SELECT
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    category_title,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    trending_date,
    MAX(viewCount) AS viewCount,
    MAX(likeCount) AS likeCount,
    MAX(commentCount) AS commentCount
FROM your_table_name
GROUP BY
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    category_title,
    trending_date;


[0m23:35:19.299979 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:35:19.919361 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:96b0ab3e-20a0-434f-8c19-20a29307cef7&page=queryresults
[0m23:35:19.921194 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:96b0ab3e-20a0-434f-8c19-20a29307cef7&page=queryresults
[0m23:35:19.933049 [debug] [Thread-1  ]: Database Error in model video_stats (models/daily/video_stats.sql)
  Table "your_table_name" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/youtubeAnalysis/models/daily/video_stats.sql
[0m23:35:19.933990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '958b58c5-2366-4254-a4c3-e7dc3e6c304d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bed6e50>]}
[0m23:35:19.935051 [error] [Thread-1  ]: 4 of 4 ERROR creating sql view model youtubeDataAnalysis.video_stats ........... [[31mERROR[0m in 0.65s]
[0m23:35:19.935820 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.video_stats
[0m23:35:19.936568 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.video_stats' to be skipped because of status 'error'.  Reason: Database Error in model video_stats (models/daily/video_stats.sql)
  Table "your_table_name" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/youtubeAnalysis/models/daily/video_stats.sql.
[0m23:35:19.938045 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:35:19.940191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:19.940572 [debug] [MainThread]: Connection 'model.youtubeAnalysis.video_stats' was properly closed.
[0m23:35:19.941001 [info ] [MainThread]: 
[0m23:35:19.941383 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m23:35:19.942690 [debug] [MainThread]: Command end result
[0m23:35:19.967872 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:35:19.969195 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:35:19.973872 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m23:35:19.974129 [info ] [MainThread]: 
[0m23:35:19.974382 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:35:19.974601 [info ] [MainThread]: 
[0m23:35:19.974868 [error] [MainThread]: [31mFailure in model video_stats (models/daily/video_stats.sql)[0m
[0m23:35:19.975118 [error] [MainThread]:   Database Error in model video_stats (models/daily/video_stats.sql)
  Table "your_table_name" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/youtubeAnalysis/models/daily/video_stats.sql
[0m23:35:19.975316 [info ] [MainThread]: 
[0m23:35:19.975562 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/daily/video_stats.sql
[0m23:35:19.975759 [info ] [MainThread]: 
[0m23:35:19.975976 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m23:35:19.977621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.2920656, "process_in_blocks": "0", "process_kernel_time": 0.379037, "process_mem_max_rss": "347799552", "process_out_blocks": "0", "process_user_time": 2.569215}
[0m23:35:19.977912 [debug] [MainThread]: Command `dbt run` failed at 23:35:19.977857 after 7.29 seconds
[0m23:35:19.978173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107972610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b30f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8c4fa0>]}
[0m23:35:19.978427 [debug] [MainThread]: Flushing usage events
[0m23:35:20.396258 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:36:03.486750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fa700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896f670>]}


============================== 23:36:03.490022 | fe40ce04-d18c-4b67-9468-20720034ef5e ==============================
[0m23:36:03.490022 [info ] [MainThread]: Running with dbt=1.10.8
[0m23:36:03.490402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'debug': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:36:05.453850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe40ce04-d18c-4b67-9468-20720034ef5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b928b0>]}
[0m23:36:05.486283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe40ce04-d18c-4b67-9468-20720034ef5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2e3160>]}
[0m23:36:05.486676 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m23:36:05.658047 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m23:36:05.717198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:36:05.717440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:36:05.721193 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m23:36:05.735851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe40ce04-d18c-4b67-9468-20720034ef5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8a4130>]}
[0m23:36:05.777401 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:36:05.779220 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:36:05.790073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe40ce04-d18c-4b67-9468-20720034ef5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b893d00>]}
[0m23:36:05.790368 [info ] [MainThread]: Found 4 models, 496 macros
[0m23:36:05.790584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe40ce04-d18c-4b67-9468-20720034ef5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108915a00>]}
[0m23:36:05.791378 [info ] [MainThread]: 
[0m23:36:05.791602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:36:05.791779 [info ] [MainThread]: 
[0m23:36:05.792066 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:36:05.794610 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m23:36:05.794845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:06.222345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m23:36:06.223816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:06.644593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe40ce04-d18c-4b67-9468-20720034ef5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2c4580>]}
[0m23:36:06.646182 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:36:06.653953 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_daily
[0m23:36:06.655031 [info ] [Thread-1  ]: 1 of 4 START sql view model youtubeDataAnalysis.combined_daily ................. [RUN]
[0m23:36:06.655856 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.combined_daily)
[0m23:36:06.656498 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_daily
[0m23:36:06.670002 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_daily"
[0m23:36:06.671668 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_daily
[0m23:36:06.699202 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_daily"
[0m23:36:06.699862 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
  OPTIONS()
  as SELECT
    v.*,
    c.category_title,
    CURRENT_DATE() AS trending_date
FROM `youtubeDataAnalysis.src_videos` v
LEFT JOIN `youtubeDataAnalysis.src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name;


[0m23:36:06.700210 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:36:07.398477 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:c7eec9b8-2b3b-4f8a-b305-ee184c51bf18&page=queryresults
[0m23:36:07.838656 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe40ce04-d18c-4b67-9468-20720034ef5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e6df0>]}
[0m23:36:07.839269 [info ] [Thread-1  ]: 1 of 4 OK created sql view model youtubeDataAnalysis.combined_daily ............ [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m23:36:07.839683 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_daily
[0m23:36:07.839989 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m23:36:07.840324 [info ] [Thread-1  ]: 2 of 4 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m23:36:07.840626 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_daily, now model.youtubeAnalysis.src_categories)
[0m23:36:07.840860 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m23:36:07.842842 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m23:36:07.848949 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m23:36:07.851146 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m23:36:07.851569 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m23:36:07.852019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:36:08.364437 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:f34faeb1-0e89-4fb6-af30-4ca17ae39673&page=queryresults
[0m23:36:08.920493 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe40ce04-d18c-4b67-9468-20720034ef5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba1730>]}
[0m23:36:08.921999 [info ] [Thread-1  ]: 2 of 4 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m23:36:08.922999 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m23:36:08.923673 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m23:36:08.924587 [info ] [Thread-1  ]: 3 of 4 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m23:36:08.925433 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m23:36:08.925975 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m23:36:08.929673 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m23:36:08.930682 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m23:36:08.935106 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m23:36:08.936384 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    CASE
    WHEN LOWER(caption) = 'true' THEN TRUE
    WHEN LOWER(caption) = 'false' THEN FALSE
    ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m23:36:08.937016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:36:09.584206 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:dd2ce018-4ff3-456c-a916-c9a26e7f2aab&page=queryresults
[0m23:36:09.980687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe40ce04-d18c-4b67-9468-20720034ef5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e6df0>]}
[0m23:36:09.982591 [info ] [Thread-1  ]: 3 of 4 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m23:36:09.983787 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m23:36:09.984570 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.video_stats
[0m23:36:09.985489 [info ] [Thread-1  ]: 4 of 4 START sql view model youtubeDataAnalysis.video_stats .................... [RUN]
[0m23:36:09.986253 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_videos, now model.youtubeAnalysis.video_stats)
[0m23:36:09.986951 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.video_stats
[0m23:36:09.991668 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.video_stats"
[0m23:36:09.992865 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.video_stats
[0m23:36:09.997723 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.video_stats"
[0m23:36:09.998615 [debug] [Thread-1  ]: On model.youtubeAnalysis.video_stats: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.video_stats"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`video_stats`
  OPTIONS()
  as SELECT
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    category_title,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    trending_date,
    MAX(viewCount) AS viewCount,
    MAX(likeCount) AS likeCount,
    MAX(commentCount) AS commentCount
FROM `youtubeDataAnalysis.combined_daily`
GROUP BY
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    category_title,
    trending_date;


[0m23:36:09.999185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:36:10.915901 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:49967d57-2c20-4d1b-a925-1f6a69a3eb8d&page=queryresults
[0m23:36:11.277598 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe40ce04-d18c-4b67-9468-20720034ef5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e6df0>]}
[0m23:36:11.279137 [info ] [Thread-1  ]: 4 of 4 OK created sql view model youtubeDataAnalysis.video_stats ............... [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m23:36:11.279927 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.video_stats
[0m23:36:11.281258 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:11.283645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:11.284067 [debug] [MainThread]: Connection 'model.youtubeAnalysis.video_stats' was properly closed.
[0m23:36:11.284591 [info ] [MainThread]: 
[0m23:36:11.285179 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m23:36:11.286452 [debug] [MainThread]: Command end result
[0m23:36:11.312539 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:36:11.314043 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:36:11.319336 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m23:36:11.319613 [info ] [MainThread]: 
[0m23:36:11.319911 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:36:11.320145 [info ] [MainThread]: 
[0m23:36:11.320399 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m23:36:11.322586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8804965, "process_in_blocks": "0", "process_kernel_time": 0.367638, "process_mem_max_rss": "337346560", "process_out_blocks": "0", "process_user_time": 2.594692}
[0m23:36:11.322894 [debug] [MainThread]: Command `dbt run` succeeded at 23:36:11.322840 after 7.88 seconds
[0m23:36:11.323173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fa700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2e3160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b480160>]}
[0m23:36:11.323433 [debug] [MainThread]: Flushing usage events
[0m23:36:11.666819 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:37:29.146988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10346e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e3670>]}


============================== 23:37:29.150388 | eed3727d-3f94-4e9a-9b94-1a0bd50bffcd ==============================
[0m23:37:29.150388 [info ] [MainThread]: Running with dbt=1.10.8
[0m23:37:29.150736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:37:31.415888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eed3727d-3f94-4e9a-9b94-1a0bd50bffcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122831550>]}
[0m23:37:31.448785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eed3727d-3f94-4e9a-9b94-1a0bd50bffcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10426a970>]}
[0m23:37:31.449337 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m23:37:31.627230 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m23:37:31.700586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:37:31.700922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:37:31.704696 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m23:37:31.719580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eed3727d-3f94-4e9a-9b94-1a0bd50bffcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123024fa0>]}
[0m23:37:31.762211 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:37:31.766386 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:37:31.813613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eed3727d-3f94-4e9a-9b94-1a0bd50bffcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12294d070>]}
[0m23:37:31.814049 [info ] [MainThread]: Found 4 models, 496 macros
[0m23:37:31.814290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eed3727d-3f94-4e9a-9b94-1a0bd50bffcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123034f70>]}
[0m23:37:31.815248 [info ] [MainThread]: 
[0m23:37:31.815519 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:37:31.815732 [info ] [MainThread]: 
[0m23:37:31.816047 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:37:31.818869 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m23:37:31.819110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:32.262176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m23:37:32.263445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:32.664196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eed3727d-3f94-4e9a-9b94-1a0bd50bffcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1228439a0>]}
[0m23:37:32.664764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:37:32.669049 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_daily
[0m23:37:32.669723 [info ] [Thread-1  ]: 1 of 4 START sql view model youtubeDataAnalysis.combined_daily ................. [RUN]
[0m23:37:32.670253 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.combined_daily)
[0m23:37:32.670700 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_daily
[0m23:37:32.686875 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_daily"
[0m23:37:32.690030 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_daily
[0m23:37:32.718578 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_daily"
[0m23:37:32.719195 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
  OPTIONS()
  as SELECT
    v.*,
    c.category_title,
    CURRENT_DATE() AS trending_date
FROM `youtubeDataAnalysis.src_videos` v
LEFT JOIN `youtubeDataAnalysis.src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name;


[0m23:37:32.719657 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:37:33.452257 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:b19dfc11-19de-4e5a-9bbe-75db81ae1e27&page=queryresults
[0m23:37:33.974274 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eed3727d-3f94-4e9a-9b94-1a0bd50bffcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12310d220>]}
[0m23:37:33.975115 [info ] [Thread-1  ]: 1 of 4 OK created sql view model youtubeDataAnalysis.combined_daily ............ [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m23:37:33.975547 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_daily
[0m23:37:33.975836 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m23:37:33.976223 [info ] [Thread-1  ]: 2 of 4 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m23:37:33.976595 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_daily, now model.youtubeAnalysis.src_categories)
[0m23:37:33.976871 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m23:37:33.978749 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m23:37:33.983449 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m23:37:33.985577 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m23:37:33.986013 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m23:37:33.986297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:37:34.611146 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:5527e44f-4e4d-4403-9084-03d240b191d7&page=queryresults
[0m23:37:35.044315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eed3727d-3f94-4e9a-9b94-1a0bd50bffcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122898310>]}
[0m23:37:35.046671 [info ] [Thread-1  ]: 2 of 4 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m23:37:35.048340 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m23:37:35.049354 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m23:37:35.050370 [info ] [Thread-1  ]: 3 of 4 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m23:37:35.051209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m23:37:35.051838 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m23:37:35.055956 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m23:37:35.057020 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m23:37:35.061831 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m23:37:35.064169 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    CASE
    WHEN LOWER(caption) = 'true' THEN TRUE
    WHEN LOWER(caption) = 'false' THEN FALSE
    ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m23:37:35.064721 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:37:35.715871 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:0df6d4dc-f359-4c4e-bb29-084d1e4f60f0&page=queryresults
[0m23:37:36.102847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eed3727d-3f94-4e9a-9b94-1a0bd50bffcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103715730>]}
[0m23:37:36.105031 [info ] [Thread-1  ]: 3 of 4 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m23:37:36.106047 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m23:37:36.106706 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.video_stats_daily
[0m23:37:36.107780 [info ] [Thread-1  ]: 4 of 4 START sql view model youtubeDataAnalysis.video_stats_daily .............. [RUN]
[0m23:37:36.108622 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_videos, now model.youtubeAnalysis.video_stats_daily)
[0m23:37:36.109244 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.video_stats_daily
[0m23:37:36.113316 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.video_stats_daily"
[0m23:37:36.114560 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.video_stats_daily
[0m23:37:36.118882 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.video_stats_daily"
[0m23:37:36.120051 [debug] [Thread-1  ]: On model.youtubeAnalysis.video_stats_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.video_stats_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`video_stats_daily`
  OPTIONS()
  as SELECT
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    category_title,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    trending_date,
    MAX(viewCount) AS viewCount,
    MAX(likeCount) AS likeCount,
    MAX(commentCount) AS commentCount
FROM `youtubeDataAnalysis.combined_daily`
GROUP BY
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    category_title,
    trending_date;


[0m23:37:36.120797 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:37:36.790072 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:1011e636-a537-48d2-a053-c1a18b740fa4&page=queryresults
[0m23:37:37.140927 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eed3727d-3f94-4e9a-9b94-1a0bd50bffcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103715730>]}
[0m23:37:37.142611 [info ] [Thread-1  ]: 4 of 4 OK created sql view model youtubeDataAnalysis.video_stats_daily ......... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m23:37:37.143712 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.video_stats_daily
[0m23:37:37.145597 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:37:37.147340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:37.147632 [debug] [MainThread]: Connection 'model.youtubeAnalysis.video_stats_daily' was properly closed.
[0m23:37:37.147965 [info ] [MainThread]: 
[0m23:37:37.148270 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m23:37:37.149440 [debug] [MainThread]: Command end result
[0m23:37:37.179737 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:37:37.181771 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:37:37.188155 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m23:37:37.188438 [info ] [MainThread]: 
[0m23:37:37.188729 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:37:37.188963 [info ] [MainThread]: 
[0m23:37:37.189216 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m23:37:37.191790 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.089719, "process_in_blocks": "0", "process_kernel_time": 0.41338, "process_mem_max_rss": "338313216", "process_out_blocks": "0", "process_user_time": 2.630231}
[0m23:37:37.192172 [debug] [MainThread]: Command `dbt run` succeeded at 23:37:37.192109 after 8.09 seconds
[0m23:37:37.192495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10346e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d11e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029b77f0>]}
[0m23:37:37.192775 [debug] [MainThread]: Flushing usage events
[0m23:37:37.626202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:01:11.907127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10426f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e7640>]}


============================== 00:01:11.913392 | 661d7168-5dac-4940-8287-4695b994fcdd ==============================
[0m00:01:11.913392 [info ] [MainThread]: Running with dbt=1.10.8
[0m00:01:11.913789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:01:13.863631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '661d7168-5dac-4940-8287-4695b994fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dceca0>]}
[0m00:01:13.896667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '661d7168-5dac-4940-8287-4695b994fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10532ebb0>]}
[0m00:01:13.897036 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:01:14.082610 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m00:01:14.141431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:01:14.141665 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:01:14.145323 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.youtubeAnalysis.dim
[0m00:01:14.160835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '661d7168-5dac-4940-8287-4695b994fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118225130>]}
[0m00:01:14.202601 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m00:01:14.204579 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m00:01:14.216390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '661d7168-5dac-4940-8287-4695b994fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118207430>]}
[0m00:01:14.216695 [info ] [MainThread]: Found 4 models, 496 macros
[0m00:01:14.216900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '661d7168-5dac-4940-8287-4695b994fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117d6ebb0>]}
[0m00:01:14.217661 [info ] [MainThread]: 
[0m00:01:14.217891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:01:14.218064 [info ] [MainThread]: 
[0m00:01:14.218353 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:01:14.220969 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m00:01:14.221219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:14.739767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m00:01:14.741146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:15.172455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '661d7168-5dac-4940-8287-4695b994fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118247cd0>]}
[0m00:01:15.174020 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:01:15.182098 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m00:01:15.183111 [info ] [Thread-1  ]: 1 of 4 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m00:01:15.183898 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m00:01:15.184512 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m00:01:15.197088 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m00:01:15.198165 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m00:01:15.225083 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m00:01:15.225922 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m00:01:15.226261 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:01:15.837877 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:f5cdb373-b065-4e15-8e3d-c98fd9938df2&page=queryresults
[0m00:01:16.538075 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '661d7168-5dac-4940-8287-4695b994fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117dbee50>]}
[0m00:01:16.538604 [info ] [Thread-1  ]: 1 of 4 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m00:01:16.539051 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m00:01:16.539346 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m00:01:16.539714 [info ] [Thread-1  ]: 2 of 4 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m00:01:16.540022 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m00:01:16.540270 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m00:01:16.541860 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m00:01:16.542394 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m00:01:16.544819 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m00:01:16.545452 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    CASE
    WHEN LOWER(caption) = 'true' THEN TRUE
    WHEN LOWER(caption) = 'false' THEN FALSE
    ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m00:01:16.546051 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:01:17.148710 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:5a7d2786-85c0-4d47-984a-09ed267bccbb&page=queryresults
[0m00:01:17.708417 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '661d7168-5dac-4940-8287-4695b994fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2e880>]}
[0m00:01:17.710258 [info ] [Thread-1  ]: 2 of 4 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m00:01:17.711166 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m00:01:17.711779 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.video_stats_daily
[0m00:01:17.712932 [info ] [Thread-1  ]: 3 of 4 START sql view model youtubeDataAnalysis.video_stats_daily .............. [RUN]
[0m00:01:17.713980 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_videos, now model.youtubeAnalysis.video_stats_daily)
[0m00:01:17.714658 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.video_stats_daily
[0m00:01:17.718717 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.video_stats_daily"
[0m00:01:17.720174 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.video_stats_daily
[0m00:01:17.724851 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.video_stats_daily"
[0m00:01:17.725823 [debug] [Thread-1  ]: On model.youtubeAnalysis.video_stats_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.video_stats_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`video_stats_daily`
  OPTIONS()
  as WITH video_stats_daily AS(
    SELECT
        video_id,
        publishedAt,
        channel_Id,
        video_title,
        channel_Title,
        categoryId,
        category_title,
        duration_sec,
        dimension,
        definition,
        caption,
        licensedContent,
        madeForKids,
        trending_date,
        MAX(viewCount) AS viewCount,
        MAX(likeCount) AS likeCount,
        MAX(commentCount) AS commentCount
    FROM `youtubeDataAnalysis.combined_daily`
    GROUP BY
        video_id,
        publishedAt,
        channel_Id,
        video_title,
        channel_Title,
        categoryId,
        duration_sec,
        dimension,
        definition,
        caption,
        licensedContent,
        madeForKids,
        category_title,
        trending_date
)
SELECT * FROM video_stats_daily;


[0m00:01:17.726328 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:01:18.560212 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:202ed573-aa81-4ca4-ac46-9e1af6d793aa&page=queryresults
[0m00:01:19.120524 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '661d7168-5dac-4940-8287-4695b994fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117dbee50>]}
[0m00:01:19.122161 [info ] [Thread-1  ]: 3 of 4 OK created sql view model youtubeDataAnalysis.video_stats_daily ......... [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m00:01:19.123207 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.video_stats_daily
[0m00:01:19.123861 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_daily
[0m00:01:19.124702 [info ] [Thread-1  ]: 4 of 4 START sql view model youtubeDataAnalysis.combined_daily ................. [RUN]
[0m00:01:19.125478 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.video_stats_daily, now model.youtubeAnalysis.combined_daily)
[0m00:01:19.126077 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_daily
[0m00:01:19.131403 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_daily"
[0m00:01:19.135817 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_daily
[0m00:01:19.139544 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_daily"
[0m00:01:19.140319 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
  OPTIONS()
  as SELECT
    v.*,
    c.category_title,
    CURRENT_DATE() AS trending_date
FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos` v
LEFT JOIN `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name;


[0m00:01:19.140805 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:01:19.796385 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:b05b7884-81b6-40b0-a302-d5691863b560&page=queryresults
[0m00:01:20.438941 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '661d7168-5dac-4940-8287-4695b994fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2e880>]}
[0m00:01:20.440217 [info ] [Thread-1  ]: 4 of 4 OK created sql view model youtubeDataAnalysis.combined_daily ............ [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m00:01:20.441146 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_daily
[0m00:01:20.442714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:01:20.445442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:20.445994 [debug] [MainThread]: Connection 'model.youtubeAnalysis.combined_daily' was properly closed.
[0m00:01:20.446614 [info ] [MainThread]: 
[0m00:01:20.447059 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 6.23 seconds (6.23s).
[0m00:01:20.448689 [debug] [MainThread]: Command end result
[0m00:01:20.477169 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m00:01:20.479349 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m00:01:20.485103 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m00:01:20.485362 [info ] [MainThread]: 
[0m00:01:20.485646 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:01:20.485870 [info ] [MainThread]: 
[0m00:01:20.486116 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m00:01:20.488458 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.63739, "process_in_blocks": "0", "process_kernel_time": 0.401006, "process_mem_max_rss": "333381632", "process_out_blocks": "0", "process_user_time": 2.640016}
[0m00:01:20.488782 [debug] [MainThread]: Command `dbt run` succeeded at 00:01:20.488721 after 8.64 seconds
[0m00:01:20.489148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10426f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117d4d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a4c2e0>]}
[0m00:01:20.489415 [debug] [MainThread]: Flushing usage events
[0m00:01:20.920011 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:38:50.007695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037f26a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048677c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048675e0>]}


============================== 00:38:50.010632 | 92ed7bc6-663a-4fbe-8b8c-ce397eb8f154 ==============================
[0m00:38:50.010632 [info ] [MainThread]: Running with dbt=1.10.8
[0m00:38:50.010990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:38:52.053854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92ed7bc6-663a-4fbe-8b8c-ce397eb8f154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1171e3160>]}
[0m00:38:52.088228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92ed7bc6-663a-4fbe-8b8c-ce397eb8f154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048aea90>]}
[0m00:38:52.088629 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:38:52.297755 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m00:38:52.357008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:52.357243 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:52.375309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92ed7bc6-663a-4fbe-8b8c-ce397eb8f154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177abeb0>]}
[0m00:38:52.418091 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m00:38:52.421689 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m00:38:52.434305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92ed7bc6-663a-4fbe-8b8c-ce397eb8f154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11776af10>]}
[0m00:38:52.434628 [info ] [MainThread]: Found 5 models, 496 macros
[0m00:38:52.434853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92ed7bc6-663a-4fbe-8b8c-ce397eb8f154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104146d00>]}
[0m00:38:52.435819 [info ] [MainThread]: 
[0m00:38:52.436056 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:38:52.436232 [info ] [MainThread]: 
[0m00:38:52.436536 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:38:52.439393 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m00:38:52.439651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:52.978307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m00:38:52.979145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:53.477404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92ed7bc6-663a-4fbe-8b8c-ce397eb8f154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104146d00>]}
[0m00:38:53.479080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:53.486602 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m00:38:53.487567 [info ] [Thread-1  ]: 1 of 5 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m00:38:53.488329 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m00:38:53.488928 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m00:38:53.501656 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m00:38:53.503193 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m00:38:53.530034 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m00:38:53.530612 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m00:38:53.530933 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:54.226553 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:003c7aeb-91af-492c-a713-3148dfb82cdb&page=queryresults
[0m00:38:54.682039 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed7bc6-663a-4fbe-8b8c-ce397eb8f154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178926d0>]}
[0m00:38:54.682596 [info ] [Thread-1  ]: 1 of 5 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m00:38:54.682994 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m00:38:54.683263 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m00:38:54.683616 [info ] [Thread-1  ]: 2 of 5 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m00:38:54.683949 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m00:38:54.684205 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m00:38:54.685795 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m00:38:54.686473 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m00:38:54.688874 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m00:38:54.689425 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    CASE
    WHEN LOWER(caption) = 'true' THEN TRUE
    WHEN LOWER(caption) = 'false' THEN FALSE
    ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m00:38:54.689732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:55.269276 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:75d26917-e3de-4ebb-baa5-e24b05819125&page=queryresults
[0m00:38:55.681761 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed7bc6-663a-4fbe-8b8c-ce397eb8f154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032ae4c0>]}
[0m00:38:55.682362 [info ] [Thread-1  ]: 2 of 5 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m00:38:55.682791 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m00:38:55.683325 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_daily
[0m00:38:55.683670 [info ] [Thread-1  ]: 3 of 5 START sql view model youtubeDataAnalysis.combined_daily ................. [RUN]
[0m00:38:55.683974 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_videos, now model.youtubeAnalysis.combined_daily)
[0m00:38:55.684232 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_daily
[0m00:38:55.686858 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_daily"
[0m00:38:55.687877 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_daily
[0m00:38:55.690181 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_daily"
[0m00:38:55.690709 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
  OPTIONS()
  as SELECT
    v.*,
    c.category_title,
    CURRENT_DATE() AS trending_date
FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos` v
LEFT JOIN `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name;


[0m00:38:55.691025 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:56.498766 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:7c2a5cab-b26e-4a0f-a625-95d036677d75&page=queryresults
[0m00:38:57.059184 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed7bc6-663a-4fbe-8b8c-ce397eb8f154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c93bb0>]}
[0m00:38:57.060766 [info ] [Thread-1  ]: 3 of 5 OK created sql view model youtubeDataAnalysis.combined_daily ............ [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m00:38:57.061928 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_daily
[0m00:38:57.062637 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_historical
[0m00:38:57.063570 [info ] [Thread-1  ]: 4 of 5 START sql incremental model youtubeDataAnalysis.combined_historical ..... [RUN]
[0m00:38:57.064494 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_daily, now model.youtubeAnalysis.combined_historical)
[0m00:38:57.065046 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_historical
[0m00:38:57.077060 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_historical"
[0m00:38:57.078237 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_historical
[0m00:38:57.130360 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_historical"
[0m00:38:57.131056 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_historical: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_historical"} */

  
    

    create or replace table `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_historical`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    v.*,
    c.category_title,
    CURRENT_DATE() AS trending_date
FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos` v
LEFT JOIN `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name


    );
  
[0m00:38:57.131364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:58.003061 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:dff8f921-484a-4664-9e12-1c5390432a4e&page=queryresults
[0m00:39:00.403127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed7bc6-663a-4fbe-8b8c-ce397eb8f154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ce1640>]}
[0m00:39:00.412301 [info ] [Thread-1  ]: 4 of 5 OK created sql incremental model youtubeDataAnalysis.combined_historical  [[32mCREATE TABLE (5.4k rows, 1.1 MiB processed)[0m in 3.34s]
[0m00:39:00.414852 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_historical
[0m00:39:00.415688 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.video_stats_daily
[0m00:39:00.416926 [info ] [Thread-1  ]: 5 of 5 START sql view model youtubeDataAnalysis.video_stats_daily .............. [RUN]
[0m00:39:00.417902 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_historical, now model.youtubeAnalysis.video_stats_daily)
[0m00:39:00.418605 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.video_stats_daily
[0m00:39:00.427114 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.video_stats_daily"
[0m00:39:00.428568 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.video_stats_daily
[0m00:39:00.432762 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.video_stats_daily"
[0m00:39:00.433921 [debug] [Thread-1  ]: On model.youtubeAnalysis.video_stats_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.video_stats_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`video_stats_daily`
  OPTIONS()
  as SELECT
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    category_title,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    trending_date,
    MAX(viewCount) AS viewCount,
    MAX(likeCount) AS likeCount,
    MAX(commentCount) AS commentCount
FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
GROUP BY
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    category_title,
    trending_date;


[0m00:39:00.434495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:01.423219 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:93931c12-9e88-4416-aa7b-237bc9abd4d5&page=queryresults
[0m00:39:02.001971 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed7bc6-663a-4fbe-8b8c-ce397eb8f154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117d7b880>]}
[0m00:39:02.003419 [info ] [Thread-1  ]: 5 of 5 OK created sql view model youtubeDataAnalysis.video_stats_daily ......... [[32mCREATE VIEW (0 processed)[0m in 1.58s]
[0m00:39:02.004427 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.video_stats_daily
[0m00:39:02.006602 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:39:02.009461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:02.009925 [debug] [MainThread]: Connection 'model.youtubeAnalysis.video_stats_daily' was properly closed.
[0m00:39:02.010554 [info ] [MainThread]: 
[0m00:39:02.011035 [info ] [MainThread]: Finished running 1 incremental model, 4 view models in 0 hours 0 minutes and 9.57 seconds (9.57s).
[0m00:39:02.012839 [debug] [MainThread]: Command end result
[0m00:39:02.041723 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m00:39:02.044134 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m00:39:02.050554 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m00:39:02.050819 [info ] [MainThread]: 
[0m00:39:02.051097 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:02.051322 [info ] [MainThread]: 
[0m00:39:02.051572 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m00:39:02.054310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.097917, "process_in_blocks": "0", "process_kernel_time": 0.406417, "process_mem_max_rss": "330858496", "process_out_blocks": "0", "process_user_time": 2.683408}
[0m00:39:02.055013 [debug] [MainThread]: Command `dbt run` succeeded at 00:39:02.054828 after 12.10 seconds
[0m00:39:02.055359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037f26a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c4c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104122bb0>]}
[0m00:39:02.055635 [debug] [MainThread]: Flushing usage events
[0m00:39:02.663583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:08:06.780987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106453730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eee820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eee640>]}


============================== 23:08:06.785564 | c08ded82-9145-4d33-ac61-8dbbfb6c69ab ==============================
[0m23:08:06.785564 [info ] [MainThread]: Running with dbt=1.10.8
[0m23:08:06.785931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:08:08.861136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c08ded82-9145-4d33-ac61-8dbbfb6c69ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379d1640>]}
[0m23:08:08.894812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c08ded82-9145-4d33-ac61-8dbbfb6c69ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed1be0>]}
[0m23:08:08.895218 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m23:08:09.074398 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m23:08:09.152364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:08:09.152608 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:08:09.170758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c08ded82-9145-4d33-ac61-8dbbfb6c69ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bde6130>]}
[0m23:08:09.225748 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:08:09.230783 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:08:09.242225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c08ded82-9145-4d33-ac61-8dbbfb6c69ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14be04bb0>]}
[0m23:08:09.242526 [info ] [MainThread]: Found 5 models, 496 macros
[0m23:08:09.242742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c08ded82-9145-4d33-ac61-8dbbfb6c69ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bdfae50>]}
[0m23:08:09.243526 [info ] [MainThread]: 
[0m23:08:09.243743 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:08:09.243916 [info ] [MainThread]: 
[0m23:08:09.244197 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:08:09.246977 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m23:08:09.247242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:09.831078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m23:08:09.831597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:08:10.322198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c08ded82-9145-4d33-ac61-8dbbfb6c69ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14be04c10>]}
[0m23:08:10.323746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:08:10.330546 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m23:08:10.331537 [info ] [Thread-1  ]: 1 of 5 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m23:08:10.332325 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m23:08:10.332943 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m23:08:10.344935 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m23:08:10.347512 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m23:08:10.374412 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m23:08:10.375027 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m23:08:10.375364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:08:11.050412 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:68a4f9ad-ae34-4b10-9113-24fa6fabd224&page=queryresults
[0m23:08:11.499465 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c08ded82-9145-4d33-ac61-8dbbfb6c69ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7d880>]}
[0m23:08:11.499900 [info ] [Thread-1  ]: 1 of 5 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m23:08:11.500249 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m23:08:11.500487 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m23:08:11.500779 [info ] [Thread-1  ]: 2 of 5 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m23:08:11.501036 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m23:08:11.501254 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m23:08:11.502599 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m23:08:11.503199 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m23:08:11.505230 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m23:08:11.505626 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    CASE
    WHEN LOWER(caption) = 'true' THEN TRUE
    WHEN LOWER(caption) = 'false' THEN FALSE
    ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m23:08:11.505920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:08:12.170415 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:ce4b4126-8cda-4fdb-9fcc-1e2703b79282&page=queryresults
[0m23:08:12.591471 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c08ded82-9145-4d33-ac61-8dbbfb6c69ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106346880>]}
[0m23:08:12.593686 [info ] [Thread-1  ]: 2 of 5 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m23:08:12.594902 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m23:08:12.596530 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_daily
[0m23:08:12.597459 [info ] [Thread-1  ]: 3 of 5 START sql view model youtubeDataAnalysis.combined_daily ................. [RUN]
[0m23:08:12.598405 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_videos, now model.youtubeAnalysis.combined_daily)
[0m23:08:12.599165 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_daily
[0m23:08:12.605087 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_daily"
[0m23:08:12.607250 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_daily
[0m23:08:12.611796 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_daily"
[0m23:08:12.612538 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
  OPTIONS()
  as SELECT
    v.*,
    c.category_title,
    CURRENT_DATE() AS trending_date
FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos` v
LEFT JOIN `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name;


[0m23:08:12.613078 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:08:13.491771 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:32d339c1-49d1-436d-b253-0c053d16547b&page=queryresults
[0m23:08:14.333530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c08ded82-9145-4d33-ac61-8dbbfb6c69ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bee44f0>]}
[0m23:08:14.334861 [info ] [Thread-1  ]: 3 of 5 OK created sql view model youtubeDataAnalysis.combined_daily ............ [[32mCREATE VIEW (0 processed)[0m in 1.74s]
[0m23:08:14.335841 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_daily
[0m23:08:14.336558 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_historical
[0m23:08:14.337453 [info ] [Thread-1  ]: 4 of 5 START sql incremental model youtubeDataAnalysis.combined_historical ..... [RUN]
[0m23:08:14.338348 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_daily, now model.youtubeAnalysis.combined_historical)
[0m23:08:14.338997 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_historical
[0m23:08:14.351280 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_historical"
[0m23:08:14.353087 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_historical
[0m23:08:14.434057 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:08:14.871580 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_historical"
[0m23:08:14.873710 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_historical: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_historical"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_historical` as DBT_INTERNAL_DEST
        using (

SELECT
    v.*,
    c.category_title,
    CURRENT_DATE() AS trending_date
FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos` v
LEFT JOIN `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name


-- Only insert rows that don't exist yet in the historical table
WHERE (video_id, trending_date, country) 
      NOT IN (SELECT video_id, trending_date, country FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_historical`)

        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.video_id = DBT_INTERNAL_DEST.video_id
                ) and (
                    DBT_INTERNAL_SOURCE.trending_date = DBT_INTERNAL_DEST.trending_date
                ) and (
                    DBT_INTERNAL_SOURCE.country = DBT_INTERNAL_DEST.country
                )

    
    when matched then update set
        `video_id` = DBT_INTERNAL_SOURCE.`video_id`,`publishedAt` = DBT_INTERNAL_SOURCE.`publishedAt`,`channel_Id` = DBT_INTERNAL_SOURCE.`channel_Id`,`video_title` = DBT_INTERNAL_SOURCE.`video_title`,`channel_Title` = DBT_INTERNAL_SOURCE.`channel_Title`,`categoryId` = DBT_INTERNAL_SOURCE.`categoryId`,`duration_sec` = DBT_INTERNAL_SOURCE.`duration_sec`,`dimension` = DBT_INTERNAL_SOURCE.`dimension`,`definition` = DBT_INTERNAL_SOURCE.`definition`,`caption` = DBT_INTERNAL_SOURCE.`caption`,`licensedContent` = DBT_INTERNAL_SOURCE.`licensedContent`,`madeForKids` = DBT_INTERNAL_SOURCE.`madeForKids`,`viewCount` = DBT_INTERNAL_SOURCE.`viewCount`,`likeCount` = DBT_INTERNAL_SOURCE.`likeCount`,`commentCount` = DBT_INTERNAL_SOURCE.`commentCount`,`country` = DBT_INTERNAL_SOURCE.`country`,`category_title` = DBT_INTERNAL_SOURCE.`category_title`,`trending_date` = DBT_INTERNAL_SOURCE.`trending_date`
    

    when not matched then insert
        (`video_id`, `publishedAt`, `channel_Id`, `video_title`, `channel_Title`, `categoryId`, `duration_sec`, `dimension`, `definition`, `caption`, `licensedContent`, `madeForKids`, `viewCount`, `likeCount`, `commentCount`, `country`, `category_title`, `trending_date`)
    values
        (`video_id`, `publishedAt`, `channel_Id`, `video_title`, `channel_Title`, `categoryId`, `duration_sec`, `dimension`, `definition`, `caption`, `licensedContent`, `madeForKids`, `viewCount`, `likeCount`, `commentCount`, `country`, `category_title`, `trending_date`)


    
[0m23:08:15.479302 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:58cd2497-5810-4902-bfbb-88249ad65424&page=queryresults
[0m23:08:15.831778 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:58cd2497-5810-4902-bfbb-88249ad65424&page=queryresults
[0m23:08:15.848032 [debug] [Thread-1  ]: Database Error in model combined_historical (models/historical/combined_historical.sql)
  Unrecognized name: trending_date at [35:18]
  compiled code at target/run/youtubeAnalysis/models/historical/combined_historical.sql
[0m23:08:15.849185 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c08ded82-9145-4d33-ac61-8dbbfb6c69ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2ed310>]}
[0m23:08:15.850242 [error] [Thread-1  ]: 4 of 5 ERROR creating sql incremental model youtubeDataAnalysis.combined_historical  [[31mERROR[0m in 1.51s]
[0m23:08:15.851225 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_historical
[0m23:08:15.852600 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.video_stats_daily
[0m23:08:15.853506 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.combined_historical' to be skipped because of status 'error'.  Reason: Database Error in model combined_historical (models/historical/combined_historical.sql)
  Unrecognized name: trending_date at [35:18]
  compiled code at target/run/youtubeAnalysis/models/historical/combined_historical.sql.
[0m23:08:15.854323 [info ] [Thread-1  ]: 5 of 5 START sql view model youtubeDataAnalysis.video_stats_daily .............. [RUN]
[0m23:08:15.855151 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_historical, now model.youtubeAnalysis.video_stats_daily)
[0m23:08:15.855603 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.video_stats_daily
[0m23:08:15.860215 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.video_stats_daily"
[0m23:08:15.861833 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.video_stats_daily
[0m23:08:15.865297 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.video_stats_daily"
[0m23:08:15.866040 [debug] [Thread-1  ]: On model.youtubeAnalysis.video_stats_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.video_stats_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`video_stats_daily`
  OPTIONS()
  as SELECT
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    category_title,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    trending_date,
    MAX(viewCount) AS viewCount,
    MAX(likeCount) AS likeCount,
    MAX(commentCount) AS commentCount
FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
GROUP BY
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    category_title,
    trending_date;


[0m23:08:15.866490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:08:17.343183 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:2f059a19-a57c-461c-b87d-5b8c582f009d&page=queryresults
[0m23:08:18.444709 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c08ded82-9145-4d33-ac61-8dbbfb6c69ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c303790>]}
[0m23:08:18.445919 [info ] [Thread-1  ]: 5 of 5 OK created sql view model youtubeDataAnalysis.video_stats_daily ......... [[32mCREATE VIEW (0 processed)[0m in 2.59s]
[0m23:08:18.446701 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.video_stats_daily
[0m23:08:18.448113 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:08:18.450511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:18.451012 [debug] [MainThread]: Connection 'model.youtubeAnalysis.video_stats_daily' was properly closed.
[0m23:08:18.451591 [info ] [MainThread]: 
[0m23:08:18.452052 [info ] [MainThread]: Finished running 1 incremental model, 4 view models in 0 hours 0 minutes and 9.21 seconds (9.21s).
[0m23:08:18.454313 [debug] [MainThread]: Command end result
[0m23:08:18.492166 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m23:08:18.494386 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m23:08:18.500299 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m23:08:18.500588 [info ] [MainThread]: 
[0m23:08:18.500887 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:08:18.501129 [info ] [MainThread]: 
[0m23:08:18.501458 [error] [MainThread]: [31mFailure in model combined_historical (models/historical/combined_historical.sql)[0m
[0m23:08:18.501735 [error] [MainThread]:   Database Error in model combined_historical (models/historical/combined_historical.sql)
  Unrecognized name: trending_date at [35:18]
  compiled code at target/run/youtubeAnalysis/models/historical/combined_historical.sql
[0m23:08:18.501952 [info ] [MainThread]: 
[0m23:08:18.502200 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/historical/combined_historical.sql
[0m23:08:18.502401 [info ] [MainThread]: 
[0m23:08:18.502640 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m23:08:18.504993 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.785186, "process_in_blocks": "0", "process_kernel_time": 0.474546, "process_mem_max_rss": "345030656", "process_out_blocks": "0", "process_user_time": 2.749819}
[0m23:08:18.505363 [debug] [MainThread]: Command `dbt run` failed at 23:08:18.505296 after 11.79 seconds
[0m23:08:18.505689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106453730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f35c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d2df0>]}
[0m23:08:18.505959 [debug] [MainThread]: Flushing usage events
[0m23:08:19.054458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:54:26.877848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067388b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067386d0>]}


============================== 21:54:26.880962 | d0d46aaf-6b99-4e60-8c1c-84604dd44d39 ==============================
[0m21:54:26.880962 [info ] [MainThread]: Running with dbt=1.10.8
[0m21:54:26.881303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:54:26.979161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0d46aaf-6b99-4e60-8c1c-84604dd44d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b2d60>]}
[0m21:54:26.997509 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:54:26.998395 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:54:27.006032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107228d90>]}
[0m21:54:27.007171 [debug] [MainThread]: Flushing usage events
[0m21:54:27.414990 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:29.098450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045dbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105623820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105623640>]}


============================== 19:51:29.101251 | 183126f2-f977-4609-9acd-c90aa5eebe52 ==============================
[0m19:51:29.101251 [info ] [MainThread]: Running with dbt=1.10.8
[0m19:51:29.101612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/divya21raj/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:51:31.716507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '183126f2-f977-4609-9acd-c90aa5eebe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116792370>]}
[0m19:51:31.748507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '183126f2-f977-4609-9acd-c90aa5eebe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a2e820>]}
[0m19:51:31.748857 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:51:31.949157 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m19:51:32.025564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:32.025795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:32.043159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '183126f2-f977-4609-9acd-c90aa5eebe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119fbc130>]}
[0m19:51:32.092780 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m19:51:32.094742 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m19:51:32.109229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '183126f2-f977-4609-9acd-c90aa5eebe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119fdf880>]}
[0m19:51:32.109533 [info ] [MainThread]: Found 6 models, 496 macros
[0m19:51:32.109751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '183126f2-f977-4609-9acd-c90aa5eebe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119985670>]}
[0m19:51:32.110551 [info ] [MainThread]: 
[0m19:51:32.110772 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:51:32.110946 [info ] [MainThread]: 
[0m19:51:32.111236 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:51:32.113822 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m19:51:32.114072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:32.656748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m19:51:32.658190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:33.284719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '183126f2-f977-4609-9acd-c90aa5eebe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119b11a90>]}
[0m19:51:33.286127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:33.377962 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m19:51:33.378403 [info ] [Thread-1  ]: 1 of 6 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m19:51:33.378719 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m19:51:33.378950 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m19:51:33.384183 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m19:51:33.385802 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m19:51:33.403291 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m19:51:33.403831 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m19:51:33.404091 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:51:34.192382 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:7841af1c-3320-4502-ad58-c037719aaec4&page=queryresults
[0m19:51:34.648911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183126f2-f977-4609-9acd-c90aa5eebe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a09ed30>]}
[0m19:51:34.649406 [info ] [Thread-1  ]: 1 of 6 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m19:51:34.649802 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m19:51:34.650061 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m19:51:34.650379 [info ] [Thread-1  ]: 2 of 6 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m19:51:34.650677 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m19:51:34.650907 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m19:51:34.652394 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m19:51:34.652765 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m19:51:34.655001 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m19:51:34.655423 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    CASE
    WHEN LOWER(caption) = 'true' THEN TRUE
    WHEN LOWER(caption) = 'false' THEN FALSE
    ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m19:51:34.655761 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:51:35.278385 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:61f17930-54f1-4b0b-aa2c-55da671980fe&page=queryresults
[0m19:51:35.630990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183126f2-f977-4609-9acd-c90aa5eebe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409f6d0>]}
[0m19:51:35.632011 [info ] [Thread-1  ]: 2 of 6 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m19:51:35.632815 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m19:51:35.633860 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_daily
[0m19:51:35.634479 [info ] [Thread-1  ]: 3 of 6 START sql view model youtubeDataAnalysis.combined_daily ................. [RUN]
[0m19:51:35.635050 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_videos, now model.youtubeAnalysis.combined_daily)
[0m19:51:35.635526 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_daily
[0m19:51:35.640095 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_daily"
[0m19:51:35.642810 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_daily
[0m19:51:35.646478 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_daily"
[0m19:51:35.647159 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
  OPTIONS()
  as SELECT
    v.*,
    c.category_title,
    CURRENT_DATE() AS trending_date
FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos` v
LEFT JOIN `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name;


[0m19:51:35.647593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:51:36.489922 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:f93514c3-b111-41b0-b531-eabba7b3d80a&page=queryresults
[0m19:51:37.059087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183126f2-f977-4609-9acd-c90aa5eebe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4aff10>]}
[0m19:51:37.060525 [info ] [Thread-1  ]: 3 of 6 OK created sql view model youtubeDataAnalysis.combined_daily ............ [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m19:51:37.061509 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_daily
[0m19:51:37.062163 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_historical
[0m19:51:37.063067 [info ] [Thread-1  ]: 4 of 6 START sql incremental model youtubeDataAnalysis.combined_historical ..... [RUN]
[0m19:51:37.063988 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_daily, now model.youtubeAnalysis.combined_historical)
[0m19:51:37.064649 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_historical
[0m19:51:37.077720 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_historical"
[0m19:51:37.079985 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_historical
[0m19:51:37.108496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:51:37.595366 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_historical"
[0m19:51:37.596262 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_historical: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_historical"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_historical` as DBT_INTERNAL_DEST
        using (

SELECT
    v.*,
    c.category_title,
    CURRENT_DATE() AS trending_date
FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos` v
LEFT JOIN `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name


-- Only insert rows that don't exist yet in the historical table
WHERE (video_id, trending_date, country) 
      NOT IN (SELECT video_id, trending_date, country FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_historical`)

        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.video_id = DBT_INTERNAL_DEST.video_id
                ) and (
                    DBT_INTERNAL_SOURCE.trending_date = DBT_INTERNAL_DEST.trending_date
                ) and (
                    DBT_INTERNAL_SOURCE.country = DBT_INTERNAL_DEST.country
                )

    
    when matched then update set
        `video_id` = DBT_INTERNAL_SOURCE.`video_id`,`publishedAt` = DBT_INTERNAL_SOURCE.`publishedAt`,`channel_Id` = DBT_INTERNAL_SOURCE.`channel_Id`,`video_title` = DBT_INTERNAL_SOURCE.`video_title`,`channel_Title` = DBT_INTERNAL_SOURCE.`channel_Title`,`categoryId` = DBT_INTERNAL_SOURCE.`categoryId`,`duration_sec` = DBT_INTERNAL_SOURCE.`duration_sec`,`dimension` = DBT_INTERNAL_SOURCE.`dimension`,`definition` = DBT_INTERNAL_SOURCE.`definition`,`caption` = DBT_INTERNAL_SOURCE.`caption`,`licensedContent` = DBT_INTERNAL_SOURCE.`licensedContent`,`madeForKids` = DBT_INTERNAL_SOURCE.`madeForKids`,`viewCount` = DBT_INTERNAL_SOURCE.`viewCount`,`likeCount` = DBT_INTERNAL_SOURCE.`likeCount`,`commentCount` = DBT_INTERNAL_SOURCE.`commentCount`,`country` = DBT_INTERNAL_SOURCE.`country`,`category_title` = DBT_INTERNAL_SOURCE.`category_title`,`trending_date` = DBT_INTERNAL_SOURCE.`trending_date`
    

    when not matched then insert
        (`video_id`, `publishedAt`, `channel_Id`, `video_title`, `channel_Title`, `categoryId`, `duration_sec`, `dimension`, `definition`, `caption`, `licensedContent`, `madeForKids`, `viewCount`, `likeCount`, `commentCount`, `country`, `category_title`, `trending_date`)
    values
        (`video_id`, `publishedAt`, `channel_Id`, `video_title`, `channel_Title`, `categoryId`, `duration_sec`, `dimension`, `definition`, `caption`, `licensedContent`, `madeForKids`, `viewCount`, `likeCount`, `commentCount`, `country`, `category_title`, `trending_date`)


    
[0m19:51:38.220509 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:6278b46d-9310-4e1c-ac5b-8dc6ff844ae1&page=queryresults
[0m19:51:38.543777 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:6278b46d-9310-4e1c-ac5b-8dc6ff844ae1&page=queryresults
[0m19:51:38.561195 [debug] [Thread-1  ]: Database Error in model combined_historical (models/historical/combined_historical.sql)
  Unrecognized name: trending_date at [35:18]
  compiled code at target/run/youtubeAnalysis/models/historical/combined_historical.sql
[0m19:51:38.562858 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183126f2-f977-4609-9acd-c90aa5eebe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a48bdc0>]}
[0m19:51:38.564005 [error] [Thread-1  ]: 4 of 6 ERROR creating sql incremental model youtubeDataAnalysis.combined_historical  [[31mERROR[0m in 1.50s]
[0m19:51:38.564878 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_historical
[0m19:51:38.565533 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.video_stats_summary
[0m19:51:38.566253 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.combined_historical' to be skipped because of status 'error'.  Reason: Database Error in model combined_historical (models/historical/combined_historical.sql)
  Unrecognized name: trending_date at [35:18]
  compiled code at target/run/youtubeAnalysis/models/historical/combined_historical.sql.
[0m19:51:38.566910 [info ] [Thread-1  ]: 5 of 6 START sql view model youtubeDataAnalysis.video_stats_summary ............ [RUN]
[0m19:51:38.567720 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_historical, now model.youtubeAnalysis.video_stats_summary)
[0m19:51:38.568218 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.video_stats_summary
[0m19:51:38.574115 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.video_stats_summary"
[0m19:51:38.574903 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.video_stats_summary
[0m19:51:38.578279 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.video_stats_summary"
[0m19:51:38.579059 [debug] [Thread-1  ]: On model.youtubeAnalysis.video_stats_summary: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.video_stats_summary"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`video_stats_summary`
  OPTIONS()
  as -- models/youtube_summary_story.sql
-- Description: Generates a daily, humanized, story-style summary of trending YouTube videos

WITH base AS (
    SELECT
        v.*,
        c.category_title,
        CURRENT_DATE() AS trending_date
    FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos` v
    LEFT JOIN `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories` c
        ON v.categoryId = c.category_id
        AND v.country = c.region_name
),

-- 1️⃣ Top channels by number of trending videos
top_channels AS (
    SELECT
        trending_date,
        ARRAY_AGG(channel_Title ORDER BY cnt DESC LIMIT 2) AS top_channels
    FROM (
        SELECT
            trending_date,
            channel_Title,
            COUNT(video_id) AS cnt
        FROM base
        GROUP BY trending_date, channel_Title
    )
    GROUP BY trending_date
),

-- 2️⃣ Top 3 videos by views
top_videos AS (
    SELECT
        trending_date,
        ARRAY_AGG(STRUCT(video_title, channel_Title, viewCount, likeCount, commentCount)
                  ORDER BY viewCount DESC LIMIT 3) AS top_videos
    FROM base
    GROUP BY trending_date
),

-- 3️⃣ Category counts and percentages
category_counts AS (
    SELECT
        trending_date,
        category_title,
        COUNT(video_id) AS cnt
    FROM base
    GROUP BY trending_date, category_title
),
category_pct AS (
    SELECT
        trending_date,
        ARRAY_AGG(STRUCT(category_title, ROUND(100 * cnt / total_cnt,1) AS pct)) AS category_pct
    FROM (
        SELECT
            trending_date,
            category_title,
            cnt,
            SUM(cnt) OVER(PARTITION BY trending_date) AS total_cnt
        FROM category_counts
    )
    GROUP BY trending_date
),

-- 4️⃣ Total metrics per day
agg AS (
    SELECT
        trending_date,
        COUNT(*) AS total_videos,
        SUM(viewCount) AS total_views,
        SUM(likeCount) AS total_likes,
        SUM(commentCount) AS total_comments
    FROM base
    GROUP BY trending_date
)

-- 5️⃣ Combine everything into the story summary
SELECT
    a.trending_date,
    CONCAT(
        'Today, ', a.total_videos, ' videos are trending on YouTube. ',
        'Top channels: ', ARRAY_TO_STRING(b.top_channels, ' and '), '. ',
        'Top 3 videos: ',
        ARRAY_TO_STRING(
            ARRAY(
                SELECT CONCAT('"', video_title, '" by ', channel_Title, ' (', viewCount, ' views, ', likeCount, ' likes, ', commentCount, ' comments)')
                FROM UNNEST(c.top_videos)
            ), '; '
        ),
        '. Engagement highlight: the top video has a likes-to-views ratio of ', 
        ROUND(c.top_videos[OFFSET(0)].likeCount / NULLIF(c.top_videos[OFFSET(0)].viewCount,0), 2)*100, '%',
        '. Categories leading today: ',
        ARRAY_TO_STRING(
            ARRAY(
                SELECT CONCAT(category_title, ' (', pct, '%)')
                FROM UNNEST(d.category_pct)
                ORDER BY pct DESC
                LIMIT 2
            ), ' and '
        ), '.'
    ) AS summary_text
FROM agg a
LEFT JOIN top_channels b USING (trending_date)
LEFT JOIN top_videos c USING (trending_date)
LEFT JOIN category_pct d USING (trending_date)
ORDER BY a.trending_date DESC;


[0m19:51:38.579629 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:51:39.415613 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:261f6bba-e64d-42ef-be26-8a7a96da3028&page=queryresults
[0m19:51:39.802539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183126f2-f977-4609-9acd-c90aa5eebe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0b0460>]}
[0m19:51:39.803777 [info ] [Thread-1  ]: 5 of 6 OK created sql view model youtubeDataAnalysis.video_stats_summary ....... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m19:51:39.804733 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.video_stats_summary
[0m19:51:39.805379 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.video_stats_daily
[0m19:51:39.806233 [info ] [Thread-1  ]: 6 of 6 START sql view model youtubeDataAnalysis.video_stats_daily .............. [RUN]
[0m19:51:39.807129 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.video_stats_summary, now model.youtubeAnalysis.video_stats_daily)
[0m19:51:39.807671 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.video_stats_daily
[0m19:51:39.812423 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.video_stats_daily"
[0m19:51:39.814703 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.video_stats_daily
[0m19:51:39.819038 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.video_stats_daily"
[0m19:51:39.819867 [debug] [Thread-1  ]: On model.youtubeAnalysis.video_stats_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.video_stats_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`video_stats_daily`
  OPTIONS()
  as SELECT
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    category_title,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    trending_date,
    MAX(viewCount) AS viewCount,
    MAX(likeCount) AS likeCount,
    MAX(commentCount) AS commentCount
FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
GROUP BY
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    category_title,
    trending_date;


[0m19:51:39.820367 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:51:40.611820 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:032813e1-a20d-4fbd-bb9e-3ce89cb37934&page=queryresults
[0m19:51:40.974244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183126f2-f977-4609-9acd-c90aa5eebe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a48b310>]}
[0m19:51:40.975723 [info ] [Thread-1  ]: 6 of 6 OK created sql view model youtubeDataAnalysis.video_stats_daily ......... [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m19:51:40.976822 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.video_stats_daily
[0m19:51:40.978415 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:51:41.060921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:41.061176 [debug] [MainThread]: Connection 'model.youtubeAnalysis.video_stats_daily' was properly closed.
[0m19:51:41.061424 [info ] [MainThread]: 
[0m19:51:41.061651 [info ] [MainThread]: Finished running 1 incremental model, 5 view models in 0 hours 0 minutes and 8.95 seconds (8.95s).
[0m19:51:41.062419 [debug] [MainThread]: Command end result
[0m19:51:41.081910 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m19:51:41.082901 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m19:51:41.088632 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m19:51:41.088839 [info ] [MainThread]: 
[0m19:51:41.089063 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:51:41.089255 [info ] [MainThread]: 
[0m19:51:41.089486 [error] [MainThread]: [31mFailure in model combined_historical (models/historical/combined_historical.sql)[0m
[0m19:51:41.089708 [error] [MainThread]:   Database Error in model combined_historical (models/historical/combined_historical.sql)
  Unrecognized name: trending_date at [35:18]
  compiled code at target/run/youtubeAnalysis/models/historical/combined_historical.sql
[0m19:51:41.089896 [info ] [MainThread]: 
[0m19:51:41.090102 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/historical/combined_historical.sql
[0m19:51:41.090277 [info ] [MainThread]: 
[0m19:51:41.090472 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m19:51:41.090778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.030888, "process_in_blocks": "0", "process_kernel_time": 0.480103, "process_mem_max_rss": "380469248", "process_out_blocks": "0", "process_user_time": 3.413775}
[0m19:51:41.091013 [debug] [MainThread]: Command `dbt run` failed at 19:51:41.090967 after 12.03 seconds
[0m19:51:41.091237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045dbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a2e820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119aff8e0>]}
[0m19:51:41.091438 [debug] [MainThread]: Flushing usage events
[0m19:51:41.513469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:19:04.006812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c370d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c77940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c77760>]}


============================== 20:19:04.009627 | b7511a96-808a-4c47-81f3-e4c335fe0cc6 ==============================
[0m20:19:04.009627 [info ] [MainThread]: Running with dbt=1.10.8
[0m20:19:04.010008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/divya21raj/.dbt', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:19:06.171689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7511a96-808a-4c47-81f3-e4c335fe0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a82d90>]}
[0m20:19:06.202875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7511a96-808a-4c47-81f3-e4c335fe0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c51bb0>]}
[0m20:19:06.203290 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:19:06.403410 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m20:19:06.462119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:19:06.462357 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:19:06.479723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7511a96-808a-4c47-81f3-e4c335fe0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119603eb0>]}
[0m20:19:06.523378 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m20:19:06.524866 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m20:19:06.537110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7511a96-808a-4c47-81f3-e4c335fe0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11961faf0>]}
[0m20:19:06.537410 [info ] [MainThread]: Found 6 models, 496 macros
[0m20:19:06.537625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7511a96-808a-4c47-81f3-e4c335fe0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10367c790>]}
[0m20:19:06.538470 [info ] [MainThread]: 
[0m20:19:06.538696 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:19:06.538878 [info ] [MainThread]: 
[0m20:19:06.539189 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:19:06.541795 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m20:19:06.542027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:07.025786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m20:19:07.027259 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:07.521189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7511a96-808a-4c47-81f3-e4c335fe0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025de0d0>]}
[0m20:19:07.522595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:19:07.609036 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m20:19:07.609433 [info ] [Thread-1  ]: 1 of 6 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m20:19:07.609749 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m20:19:07.609969 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m20:19:07.615169 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m20:19:07.616302 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m20:19:07.633666 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m20:19:07.634136 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m20:19:07.634389 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:19:08.430715 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:0094c053-4f44-4115-a2bf-e06e5c25f570&page=queryresults
[0m20:19:09.080914 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7511a96-808a-4c47-81f3-e4c335fe0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196e51c0>]}
[0m20:19:09.081514 [info ] [Thread-1  ]: 1 of 6 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m20:19:09.081923 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m20:19:09.082223 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m20:19:09.082559 [info ] [Thread-1  ]: 2 of 6 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m20:19:09.082849 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m20:19:09.083098 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m20:19:09.084669 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m20:19:09.085072 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m20:19:09.087385 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m20:19:09.087826 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    CASE
    WHEN LOWER(caption) = 'true' THEN TRUE
    WHEN LOWER(caption) = 'false' THEN FALSE
    ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m20:19:09.088225 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:19:09.719628 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:0cfe5aed-bb3f-44b3-8a14-a094bce42493&page=queryresults
[0m20:19:10.079862 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7511a96-808a-4c47-81f3-e4c335fe0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036da250>]}
[0m20:19:10.081708 [info ] [Thread-1  ]: 2 of 6 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m20:19:10.082829 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m20:19:10.084396 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_daily
[0m20:19:10.085172 [info ] [Thread-1  ]: 3 of 6 START sql view model youtubeDataAnalysis.combined_daily ................. [RUN]
[0m20:19:10.085898 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_videos, now model.youtubeAnalysis.combined_daily)
[0m20:19:10.086755 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_daily
[0m20:19:10.092777 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_daily"
[0m20:19:10.095445 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_daily
[0m20:19:10.100458 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_daily"
[0m20:19:10.101702 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
  OPTIONS()
  as SELECT
    v.*,
    c.category_title,
    CURRENT_DATE() AS trending_date
FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos` v
LEFT JOIN `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name;


[0m20:19:10.102216 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:19:11.003487 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:8f6f0a5d-3510-4314-84f5-0cd41dc5f69e&page=queryresults
[0m20:19:11.434780 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7511a96-808a-4c47-81f3-e4c335fe0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196ebac0>]}
[0m20:19:11.436587 [info ] [Thread-1  ]: 3 of 6 OK created sql view model youtubeDataAnalysis.combined_daily ............ [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m20:19:11.437797 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_daily
[0m20:19:11.438612 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_historical
[0m20:19:11.439617 [info ] [Thread-1  ]: 4 of 6 START sql incremental model youtubeDataAnalysis.combined_historical ..... [RUN]
[0m20:19:11.440573 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_daily, now model.youtubeAnalysis.combined_historical)
[0m20:19:11.441144 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_historical
[0m20:19:11.456789 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_historical"
[0m20:19:11.459185 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_historical
[0m20:19:11.489829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:19:11.952419 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_historical"
[0m20:19:11.953347 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_historical: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_historical"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_historical` as DBT_INTERNAL_DEST
        using (

SELECT
    v.*,
    c.category_title,
    CURRENT_DATE() AS trending_date
FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos` v
LEFT JOIN `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name


-- Only insert rows that don't exist yet in the historical table
WHERE (video_id, trending_date, country) 
      NOT IN (SELECT video_id, trending_date, country FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_historical`)

        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.video_id = DBT_INTERNAL_DEST.video_id
                ) and (
                    DBT_INTERNAL_SOURCE.trending_date = DBT_INTERNAL_DEST.trending_date
                ) and (
                    DBT_INTERNAL_SOURCE.country = DBT_INTERNAL_DEST.country
                )

    
    when matched then update set
        `video_id` = DBT_INTERNAL_SOURCE.`video_id`,`publishedAt` = DBT_INTERNAL_SOURCE.`publishedAt`,`channel_Id` = DBT_INTERNAL_SOURCE.`channel_Id`,`video_title` = DBT_INTERNAL_SOURCE.`video_title`,`channel_Title` = DBT_INTERNAL_SOURCE.`channel_Title`,`categoryId` = DBT_INTERNAL_SOURCE.`categoryId`,`duration_sec` = DBT_INTERNAL_SOURCE.`duration_sec`,`dimension` = DBT_INTERNAL_SOURCE.`dimension`,`definition` = DBT_INTERNAL_SOURCE.`definition`,`caption` = DBT_INTERNAL_SOURCE.`caption`,`licensedContent` = DBT_INTERNAL_SOURCE.`licensedContent`,`madeForKids` = DBT_INTERNAL_SOURCE.`madeForKids`,`viewCount` = DBT_INTERNAL_SOURCE.`viewCount`,`likeCount` = DBT_INTERNAL_SOURCE.`likeCount`,`commentCount` = DBT_INTERNAL_SOURCE.`commentCount`,`country` = DBT_INTERNAL_SOURCE.`country`,`category_title` = DBT_INTERNAL_SOURCE.`category_title`,`trending_date` = DBT_INTERNAL_SOURCE.`trending_date`
    

    when not matched then insert
        (`video_id`, `publishedAt`, `channel_Id`, `video_title`, `channel_Title`, `categoryId`, `duration_sec`, `dimension`, `definition`, `caption`, `licensedContent`, `madeForKids`, `viewCount`, `likeCount`, `commentCount`, `country`, `category_title`, `trending_date`)
    values
        (`video_id`, `publishedAt`, `channel_Id`, `video_title`, `channel_Title`, `categoryId`, `duration_sec`, `dimension`, `definition`, `caption`, `licensedContent`, `madeForKids`, `viewCount`, `likeCount`, `commentCount`, `country`, `category_title`, `trending_date`)


    
[0m20:19:12.678177 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:a5459d85-1023-435d-b0c5-1150dc04cfc2&page=queryresults
[0m20:19:13.000546 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:a5459d85-1023-435d-b0c5-1150dc04cfc2&page=queryresults
[0m20:19:13.013597 [debug] [Thread-1  ]: Database Error in model combined_historical (models/historical/combined_historical.sql)
  Unrecognized name: trending_date at [35:18]
  compiled code at target/run/youtubeAnalysis/models/historical/combined_historical.sql
[0m20:19:13.014538 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7511a96-808a-4c47-81f3-e4c335fe0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119afad60>]}
[0m20:19:13.014992 [error] [Thread-1  ]: 4 of 6 ERROR creating sql incremental model youtubeDataAnalysis.combined_historical  [[31mERROR[0m in 1.57s]
[0m20:19:13.015434 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_historical
[0m20:19:13.015772 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.video_stats_summary
[0m20:19:13.016074 [debug] [Thread-4  ]: Marking all children of 'model.youtubeAnalysis.combined_historical' to be skipped because of status 'error'.  Reason: Database Error in model combined_historical (models/historical/combined_historical.sql)
  Unrecognized name: trending_date at [35:18]
  compiled code at target/run/youtubeAnalysis/models/historical/combined_historical.sql.
[0m20:19:13.016360 [info ] [Thread-1  ]: 5 of 6 START sql view model youtubeDataAnalysis.video_stats_summary ............ [RUN]
[0m20:19:13.016720 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_historical, now model.youtubeAnalysis.video_stats_summary)
[0m20:19:13.016939 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.video_stats_summary
[0m20:19:13.019763 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.video_stats_summary"
[0m20:19:13.020523 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.video_stats_summary
[0m20:19:13.022381 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.video_stats_summary"
[0m20:19:13.022903 [debug] [Thread-1  ]: On model.youtubeAnalysis.video_stats_summary: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.video_stats_summary"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`video_stats_summary`
  OPTIONS()
  as -- models/youtube_summary_story.sql
-- Description: Generates a daily, humanized, story-style summary of trending YouTube videos
-- with formatted numbers (K / M style)

WITH base AS (
    SELECT
        v.*,
        c.category_title,
        CURRENT_DATE() AS trending_date
    FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos` v
    LEFT JOIN `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories` c
        ON v.categoryId = c.category_id
        AND v.country = c.region_name
),

-- Helper formatting function
formatted AS (
    SELECT
        *,
        CASE 
            WHEN viewCount >= 1000000 THEN CONCAT(ROUND(viewCount/1000000,1), 'M')
            WHEN viewCount >= 1000 THEN CONCAT(ROUND(viewCount/1000,1), 'K')
            ELSE CAST(viewCount AS STRING)
        END AS viewCount_fmt,
        CASE 
            WHEN likeCount >= 1000000 THEN CONCAT(ROUND(likeCount/1000000,1), 'M')
            WHEN likeCount >= 1000 THEN CONCAT(ROUND(likeCount/1000,1), 'K')
            ELSE CAST(likeCount AS STRING)
        END AS likeCount_fmt,
        CASE 
            WHEN commentCount >= 1000000 THEN CONCAT(ROUND(commentCount/1000000,1), 'M')
            WHEN commentCount >= 1000 THEN CONCAT(ROUND(commentCount/1000,1), 'K')
            ELSE CAST(commentCount AS STRING)
        END AS commentCount_fmt
    FROM base
),

-- 1️⃣ Top channels by number of trending videos
top_channels AS (
    SELECT
        trending_date,
        ARRAY_AGG(channel_Title ORDER BY cnt DESC LIMIT 2) AS top_channels
    FROM (
        SELECT
            trending_date,
            channel_Title,
            COUNT(video_id) AS cnt
        FROM formatted
        GROUP BY trending_date, channel_Title
    )
    GROUP BY trending_date
),

-- 2️⃣ Top 3 videos by views
top_videos AS (
    SELECT
        trending_date,
        ARRAY_AGG(STRUCT(video_title, channel_Title, viewCount, likeCount, commentCount,
                         viewCount_fmt, likeCount_fmt, commentCount_fmt)
                  ORDER BY viewCount DESC LIMIT 3) AS top_videos
    FROM formatted
    GROUP BY trending_date
),

-- 3️⃣ Category counts and percentages
category_counts AS (
    SELECT
        trending_date,
        category_title,
        COUNT(video_id) AS cnt
    FROM formatted
    GROUP BY trending_date, category_title
),
category_pct AS (
    SELECT
        trending_date,
        ARRAY_AGG(STRUCT(category_title, ROUND(100 * cnt / total_cnt,1) AS pct)) AS category_pct
    FROM (
        SELECT
            trending_date,
            category_title,
            cnt,
            SUM(cnt) OVER(PARTITION BY trending_date) AS total_cnt
        FROM category_counts
    )
    GROUP BY trending_date
),

-- 4️⃣ Total metrics per day
agg AS (
    SELECT
        trending_date,
        COUNT(*) AS total_videos,
        SUM(viewCount) AS total_views,
        SUM(likeCount) AS total_likes,
        SUM(commentCount) AS total_comments
    FROM formatted
    GROUP BY trending_date
)

-- 5️⃣ Combine everything into the story summary
SELECT
    a.trending_date,
    CONCAT(
        'Today, ', a.total_videos, ' videos are trending on YouTube. ',
        'Top channels: ', ARRAY_TO_STRING(b.top_channels, ' and '), '. ',
        'Top 3 videos: ',
        ARRAY_TO_STRING(
            ARRAY(
                SELECT CONCAT('"', video_title, '" by ', channel_Title, 
                              ' (', viewCount_fmt, ' views, ', likeCount_fmt, ' likes, ', commentCount_fmt, ' comments)')
                FROM UNNEST(c.top_videos)
            ), '; '
        ),
        '. Engagement highlight: the top video has a likes-to-views ratio of ', 
        ROUND(c.top_videos[OFFSET(0)].likeCount / NULLIF(c.top_videos[OFFSET(0)].viewCount,0), 2)*100, '%',
        '. Categories leading today: ',
        ARRAY_TO_STRING(
            ARRAY(
                SELECT CONCAT(category_title, ' (', pct, '%)')
                FROM UNNEST(d.category_pct)
                ORDER BY pct DESC
                LIMIT 2
            ), ' and '
        ), '.'
    ) AS summary_text
FROM agg a
LEFT JOIN top_channels b USING (trending_date)
LEFT JOIN top_videos c USING (trending_date)
LEFT JOIN category_pct d USING (trending_date)
ORDER BY a.trending_date DESC;


[0m20:19:13.023355 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:19:13.873178 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:710ec85d-d188-4145-a0c4-464f27771fb8&page=queryresults
[0m20:19:14.388285 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7511a96-808a-4c47-81f3-e4c335fe0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d10ee0>]}
[0m20:19:14.390274 [info ] [Thread-1  ]: 5 of 6 OK created sql view model youtubeDataAnalysis.video_stats_summary ....... [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m20:19:14.391347 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.video_stats_summary
[0m20:19:14.392061 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.video_stats_daily
[0m20:19:14.392878 [info ] [Thread-1  ]: 6 of 6 START sql view model youtubeDataAnalysis.video_stats_daily .............. [RUN]
[0m20:19:14.393569 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.video_stats_summary, now model.youtubeAnalysis.video_stats_daily)
[0m20:19:14.394438 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.video_stats_daily
[0m20:19:14.400230 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.video_stats_daily"
[0m20:19:14.402326 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.video_stats_daily
[0m20:19:14.406617 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.video_stats_daily"
[0m20:19:14.407583 [debug] [Thread-1  ]: On model.youtubeAnalysis.video_stats_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.video_stats_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`video_stats_daily`
  OPTIONS()
  as SELECT
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    category_title,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    trending_date,
    MAX(viewCount) AS viewCount,
    MAX(likeCount) AS likeCount,
    MAX(commentCount) AS commentCount
FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
GROUP BY
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    category_title,
    trending_date;


[0m20:19:14.408108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:19:15.232471 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:ce603d9d-8f7f-4482-81e4-10cfa3d3e25e&page=queryresults
[0m20:19:15.595199 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7511a96-808a-4c47-81f3-e4c335fe0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036da250>]}
[0m20:19:15.597138 [info ] [Thread-1  ]: 6 of 6 OK created sql view model youtubeDataAnalysis.video_stats_daily ......... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m20:19:15.598156 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.video_stats_daily
[0m20:19:15.600256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:19:15.685599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:15.685853 [debug] [MainThread]: Connection 'model.youtubeAnalysis.video_stats_daily' was properly closed.
[0m20:19:15.686103 [info ] [MainThread]: 
[0m20:19:15.686331 [info ] [MainThread]: Finished running 1 incremental model, 5 view models in 0 hours 0 minutes and 9.15 seconds (9.15s).
[0m20:19:15.687111 [debug] [MainThread]: Command end result
[0m20:19:15.725057 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m20:19:15.726070 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m20:19:15.730088 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m20:19:15.730290 [info ] [MainThread]: 
[0m20:19:15.730519 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:19:15.730735 [info ] [MainThread]: 
[0m20:19:15.730978 [error] [MainThread]: [31mFailure in model combined_historical (models/historical/combined_historical.sql)[0m
[0m20:19:15.731201 [error] [MainThread]:   Database Error in model combined_historical (models/historical/combined_historical.sql)
  Unrecognized name: trending_date at [35:18]
  compiled code at target/run/youtubeAnalysis/models/historical/combined_historical.sql
[0m20:19:15.731377 [info ] [MainThread]: 
[0m20:19:15.731581 [info ] [MainThread]:   compiled code at target/compiled/youtubeAnalysis/models/historical/combined_historical.sql
[0m20:19:15.731766 [info ] [MainThread]: 
[0m20:19:15.731960 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m20:19:15.732261 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.77192, "process_in_blocks": "0", "process_kernel_time": 0.450636, "process_mem_max_rss": "379764736", "process_out_blocks": "0", "process_user_time": 3.385333}
[0m20:19:15.732501 [debug] [MainThread]: Command `dbt run` failed at 20:19:15.732454 after 11.77 seconds
[0m20:19:15.732724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c370d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c51bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119bc7a00>]}
[0m20:19:15.732928 [debug] [MainThread]: Flushing usage events
[0m20:19:16.214519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:04:32.406653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad37940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad37760>]}


============================== 21:04:32.409787 | f856e686-83f2-45b3-9273-66dd3722f90e ==============================
[0m21:04:32.409787 [info ] [MainThread]: Running with dbt=1.10.8
[0m21:04:32.410154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/logs', 'profiles_dir': '/Users/divya21raj/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:04:34.691328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f856e686-83f2-45b3-9273-66dd3722f90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145837f40>]}
[0m21:04:34.722839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f856e686-83f2-45b3-9273-66dd3722f90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad7d8b0>]}
[0m21:04:34.723166 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:04:34.925801 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m21:04:34.983827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:04:34.984055 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:04:35.001010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f856e686-83f2-45b3-9273-66dd3722f90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145ef2f10>]}
[0m21:04:35.040824 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m21:04:35.042370 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m21:04:35.054190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f856e686-83f2-45b3-9273-66dd3722f90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145ef7520>]}
[0m21:04:35.054493 [info ] [MainThread]: Found 6 models, 496 macros
[0m21:04:35.054709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f856e686-83f2-45b3-9273-66dd3722f90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145eb45e0>]}
[0m21:04:35.055503 [info ] [MainThread]: 
[0m21:04:35.055731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:04:35.055904 [info ] [MainThread]: 
[0m21:04:35.056189 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:04:35.058757 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_third-flare-425403-c0'
[0m21:04:35.058993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:35.704559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0, now list_third-flare-425403-c0_youtubeDataAnalysis)
[0m21:04:35.705961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:04:36.171551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f856e686-83f2-45b3-9273-66dd3722f90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1458f97c0>]}
[0m21:04:36.172918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:04:36.261415 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_categories
[0m21:04:36.261796 [info ] [Thread-1  ]: 1 of 6 START sql view model youtubeDataAnalysis.src_categories ................. [RUN]
[0m21:04:36.262101 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_third-flare-425403-c0_youtubeDataAnalysis, now model.youtubeAnalysis.src_categories)
[0m21:04:36.262322 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_categories
[0m21:04:36.267553 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_categories"
[0m21:04:36.268677 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_categories
[0m21:04:36.285734 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_categories"
[0m21:04:36.286533 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_categories: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_categories"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories`
  OPTIONS()
  as With raw_categories AS(
    SELECT region_code, region_name,
    SAFE_CAST(category_id AS INT64) AS category_id,
    category_title
    FROM youtubeDataAnalysis.category_data
)
SELECT * FROM raw_categories;


[0m21:04:36.286839 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:04:37.000074 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:2d55e8c2-6d41-4468-905c-be520a711b1f&page=queryresults
[0m21:04:37.551019 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f856e686-83f2-45b3-9273-66dd3722f90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145fd60a0>]}
[0m21:04:37.551550 [info ] [Thread-1  ]: 1 of 6 OK created sql view model youtubeDataAnalysis.src_categories ............ [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m21:04:37.551975 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_categories
[0m21:04:37.552252 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.src_videos
[0m21:04:37.552592 [info ] [Thread-1  ]: 2 of 6 START sql view model youtubeDataAnalysis.src_videos ..................... [RUN]
[0m21:04:37.552876 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_categories, now model.youtubeAnalysis.src_videos)
[0m21:04:37.553112 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.src_videos
[0m21:04:37.554649 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.src_videos"
[0m21:04:37.555073 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.src_videos
[0m21:04:37.557453 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.src_videos"
[0m21:04:37.557907 [debug] [Thread-1  ]: On model.youtubeAnalysis.src_videos: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.src_videos"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos`
  OPTIONS()
  as WITH raw_videos AS (
    SELECT
    video_id,
    -- Convert publishedAt to TIMESTAMP
    SAFE_CAST(publishedAt AS TIMESTAMP) AS publishedAt,
    COALESCE(channel_Id, 'Not Given') AS channel_Id,
    COALESCE(video_title, 'Not Given') AS video_title,
    COALESCE(channel_Title, 'Not Given') AS channel_Title,
    -- Convert categoryId to INT64
    SAFE_CAST(categoryId AS INT64) AS categoryId,
    -- Convert ISO 8601 duration (e.g., PT2M3S) to seconds
    (
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(\d+)H') AS INT64), 0) * 3600 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(\d+)M') AS INT64), 0) * 60 +
        COALESCE(SAFE_CAST(REGEXP_EXTRACT(duration, r'PT(?:\d+H)?(?:\d+M)?(\d+)S') AS INT64), 0)
        ) AS duration_sec,
    COALESCE(dimension, 'Not Given') AS dimension,
    COALESCE(definition, 'Not Given') AS definition,
    -- Convert caption to BOOLEAN
    CASE
    WHEN LOWER(caption) = 'true' THEN TRUE
    WHEN LOWER(caption) = 'false' THEN FALSE
    ELSE NULL
    END AS caption,
    licensedContent,
    madeForKids,
    -- Convert viewCount, likeCount, commentCount to INT64
    SAFE_CAST(viewCount AS INT64) AS viewCount,
    SAFE_CAST(likeCount AS INT64) AS likeCount,
    SAFE_CAST(commentCount AS INT64) AS commentCount,
    COALESCE(country, 'Not Given') AS country
FROM
    `youtubeDataAnalysis.video_data`
)
SELECT * FROM raw_videos;


[0m21:04:37.558271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:04:38.305481 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:c08a1aa0-503a-4c99-9e1a-f262cbf766a5&page=queryresults
[0m21:04:38.853140 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f856e686-83f2-45b3-9273-66dd3722f90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087aa430>]}
[0m21:04:38.854363 [info ] [Thread-1  ]: 2 of 6 OK created sql view model youtubeDataAnalysis.src_videos ................ [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m21:04:38.855299 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.src_videos
[0m21:04:38.856545 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.combined_daily
[0m21:04:38.857185 [info ] [Thread-1  ]: 3 of 6 START sql view model youtubeDataAnalysis.combined_daily ................. [RUN]
[0m21:04:38.857738 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.src_videos, now model.youtubeAnalysis.combined_daily)
[0m21:04:38.858209 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.combined_daily
[0m21:04:38.863246 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.combined_daily"
[0m21:04:38.865728 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.combined_daily
[0m21:04:38.869976 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.combined_daily"
[0m21:04:38.870810 [debug] [Thread-1  ]: On model.youtubeAnalysis.combined_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.combined_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
  OPTIONS()
  as SELECT
    v.*,
    c.category_title,
    CURRENT_DATE() AS trending_date
FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos` v
LEFT JOIN `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories` c
    ON v.categoryId = c.category_id
    AND v.country = c.region_name;


[0m21:04:38.871292 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:04:39.797068 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:3a9716d3-e765-4c67-8ac8-8c03d201b610&page=queryresults
[0m21:04:40.210580 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f856e686-83f2-45b3-9273-66dd3722f90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14660b9d0>]}
[0m21:04:40.211810 [info ] [Thread-1  ]: 3 of 6 OK created sql view model youtubeDataAnalysis.combined_daily ............ [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m21:04:40.212746 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.combined_daily
[0m21:04:40.213403 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.country_wise_summary
[0m21:04:40.214302 [info ] [Thread-1  ]: 4 of 6 START sql view model youtubeDataAnalysis.country_wise_summary ........... [RUN]
[0m21:04:40.215157 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.combined_daily, now model.youtubeAnalysis.country_wise_summary)
[0m21:04:40.215647 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.country_wise_summary
[0m21:04:40.221921 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.country_wise_summary"
[0m21:04:40.222776 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.country_wise_summary
[0m21:04:40.227031 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.country_wise_summary"
[0m21:04:40.227982 [debug] [Thread-1  ]: On model.youtubeAnalysis.country_wise_summary: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.country_wise_summary"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`country_wise_summary`
  OPTIONS()
  as -- models/country_trending_summary.sql
-- Description: Generates a high-level country-wise YouTube trending summary

WITH base AS (
    -- Combine videos and categories
    SELECT
        v.*,
        c.category_title,
        CURRENT_DATE() AS trending_date,
        DATE_DIFF(CURRENT_DATE(), DATE(v.publishedAt), DAY) AS video_age_days,
        SAFE_DIVIDE(v.likeCount, NULLIF(v.viewCount, 0)) AS like_ratio
    FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos` v
    LEFT JOIN `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories` c
        ON v.categoryId = c.category_id
        AND v.country = c.region_name
),

-- 1️⃣ Global top video by views
top_video AS (
    SELECT
        video_title,
        country,
        viewCount
    FROM base
    ORDER BY viewCount DESC
    LIMIT 1
),

-- 2️⃣ Video with highest engagement ratio globally
top_engagement AS (
    SELECT
        video_title,
        country,
        like_ratio
    FROM base
    ORDER BY like_ratio DESC
    LIMIT 1
),

-- 3️⃣ Average likes-to-views ratio per country
country_engagement AS (
    SELECT
        country,
        ROUND(AVG(like_ratio)*100,1) AS avg_like_pct,
        ROUND(AVG(video_age_days),1) AS avg_video_age_days
    FROM base
    GROUP BY country
),

-- 4️⃣ Countries with longest trending videos (average video age)
long_trending AS (
    SELECT
        country,
        ROUND(AVG(video_age_days),1) AS avg_video_age_days
    FROM base
    GROUP BY country
    ORDER BY avg_video_age_days DESC
    LIMIT 2
)

SELECT
    CONCAT(
        'Trending videos today span across ', COUNT(DISTINCT country), ' countries. ',
        'The most-watched video is "', (SELECT video_title FROM top_video), '" from ', 
            (SELECT country FROM top_video), ' with ', 
            FORMAT('%0.1fM', (SELECT viewCount FROM top_video)/1000000), ' views. ',
        'The video with the highest engagement ratio is "', (SELECT video_title FROM top_engagement), '" in ',
            (SELECT country FROM top_engagement), ' with ', 
            ROUND((SELECT like_ratio FROM top_engagement)*100,1), '% likes-to-views. ',
        'Viewer engagement varies across countries. ',
        'Some countries have videos trending for longer periods. ',
        'The countries with the highest average video age are ', 
            (SELECT STRING_AGG(country, ' and ') FROM long_trending), ' with average ages of ', 
            (SELECT STRING_AGG(CAST(avg_video_age_days AS STRING), ' and ') FROM long_trending), ' days.'
    ) AS summary_text
FROM base
LIMIT 1;


[0m21:04:40.228598 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:04:41.067483 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:fd1c8638-0184-447a-b885-196b6e6763da&page=queryresults
[0m21:04:41.431409 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f856e686-83f2-45b3-9273-66dd3722f90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14660b9d0>]}
[0m21:04:41.432610 [info ] [Thread-1  ]: 4 of 6 OK created sql view model youtubeDataAnalysis.country_wise_summary ...... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m21:04:41.433573 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.country_wise_summary
[0m21:04:41.434232 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.video_stats_summary
[0m21:04:41.435102 [info ] [Thread-1  ]: 5 of 6 START sql view model youtubeDataAnalysis.video_stats_summary ............ [RUN]
[0m21:04:41.435908 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.country_wise_summary, now model.youtubeAnalysis.video_stats_summary)
[0m21:04:41.436538 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.video_stats_summary
[0m21:04:41.443959 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.video_stats_summary"
[0m21:04:41.446297 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.video_stats_summary
[0m21:04:41.450022 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.video_stats_summary"
[0m21:04:41.450987 [debug] [Thread-1  ]: On model.youtubeAnalysis.video_stats_summary: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.video_stats_summary"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`video_stats_summary`
  OPTIONS()
  as -- models/youtube_summary_story.sql
-- Description: Generates a daily, humanized, story-style summary of trending YouTube videos
-- with formatted numbers (K / M style)

WITH base AS (
    SELECT
        v.*,
        c.category_title,
        CURRENT_DATE() AS trending_date
    FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_videos` v
    LEFT JOIN `third-flare-425403-c0`.`youtubeDataAnalysis`.`src_categories` c
        ON v.categoryId = c.category_id
        AND v.country = c.region_name
),

-- Helper formatting function
formatted AS (
    SELECT
        *,
        CASE 
            WHEN viewCount >= 1000000 THEN CONCAT(ROUND(viewCount/1000000,1), 'M')
            WHEN viewCount >= 1000 THEN CONCAT(ROUND(viewCount/1000,1), 'K')
            ELSE CAST(viewCount AS STRING)
        END AS viewCount_fmt,
        CASE 
            WHEN likeCount >= 1000000 THEN CONCAT(ROUND(likeCount/1000000,1), 'M')
            WHEN likeCount >= 1000 THEN CONCAT(ROUND(likeCount/1000,1), 'K')
            ELSE CAST(likeCount AS STRING)
        END AS likeCount_fmt,
        CASE 
            WHEN commentCount >= 1000000 THEN CONCAT(ROUND(commentCount/1000000,1), 'M')
            WHEN commentCount >= 1000 THEN CONCAT(ROUND(commentCount/1000,1), 'K')
            ELSE CAST(commentCount AS STRING)
        END AS commentCount_fmt
    FROM base
),

-- 1️⃣ Top channels by number of trending videos
top_channels AS (
    SELECT
        trending_date,
        ARRAY_AGG(channel_Title ORDER BY cnt DESC LIMIT 2) AS top_channels
    FROM (
        SELECT
            trending_date,
            channel_Title,
            COUNT(video_id) AS cnt
        FROM formatted
        GROUP BY trending_date, channel_Title
    )
    GROUP BY trending_date
),

-- 2️⃣ Top 3 videos by views
top_videos AS (
    SELECT
        trending_date,
        ARRAY_AGG(STRUCT(video_title, channel_Title, viewCount, likeCount, commentCount,
                         viewCount_fmt, likeCount_fmt, commentCount_fmt)
                  ORDER BY viewCount DESC LIMIT 3) AS top_videos
    FROM formatted
    GROUP BY trending_date
),

-- 3️⃣ Category counts and percentages
category_counts AS (
    SELECT
        trending_date,
        category_title,
        COUNT(video_id) AS cnt
    FROM formatted
    GROUP BY trending_date, category_title
),
category_pct AS (
    SELECT
        trending_date,
        ARRAY_AGG(STRUCT(category_title, ROUND(100 * cnt / total_cnt,1) AS pct)) AS category_pct
    FROM (
        SELECT
            trending_date,
            category_title,
            cnt,
            SUM(cnt) OVER(PARTITION BY trending_date) AS total_cnt
        FROM category_counts
    )
    GROUP BY trending_date
),

-- 4️⃣ Total metrics per day
agg AS (
    SELECT
        trending_date,
        COUNT(*) AS total_videos,
        SUM(viewCount) AS total_views,
        SUM(likeCount) AS total_likes,
        SUM(commentCount) AS total_comments
    FROM formatted
    GROUP BY trending_date
)

-- 5️⃣ Combine everything into the story summary
SELECT
    a.trending_date,
    CONCAT(
        'Today, ', a.total_videos, ' videos are trending on YouTube. ',
        'Top channels: ', ARRAY_TO_STRING(b.top_channels, ' and '), '. ',
        'Top 3 videos: ',
        ARRAY_TO_STRING(
            ARRAY(
                SELECT CONCAT('"', video_title, '" by ', channel_Title, 
                              ' (', viewCount_fmt, ' views, ', likeCount_fmt, ' likes, ', commentCount_fmt, ' comments)')
                FROM UNNEST(c.top_videos)
            ), '; '
        ),
        '. Engagement highlight: the top video has a likes-to-views ratio of ', 
        ROUND(c.top_videos[OFFSET(0)].likeCount / NULLIF(c.top_videos[OFFSET(0)].viewCount,0), 2)*100, '%',
        '. Categories leading today: ',
        ARRAY_TO_STRING(
            ARRAY(
                SELECT CONCAT(category_title, ' (', pct, '%)')
                FROM UNNEST(d.category_pct)
                ORDER BY pct DESC
                LIMIT 2
            ), ' and '
        ), '.'
    ) AS summary_text
FROM agg a
LEFT JOIN top_channels b USING (trending_date)
LEFT JOIN top_videos c USING (trending_date)
LEFT JOIN category_pct d USING (trending_date)
ORDER BY a.trending_date DESC;


[0m21:04:41.451582 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:04:42.309436 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:b68e563e-9812-4f49-aeb3-dbf85791d090&page=queryresults
[0m21:04:42.884065 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f856e686-83f2-45b3-9273-66dd3722f90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465bc100>]}
[0m21:04:42.885431 [info ] [Thread-1  ]: 5 of 6 OK created sql view model youtubeDataAnalysis.video_stats_summary ....... [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m21:04:42.886408 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.video_stats_summary
[0m21:04:42.887063 [debug] [Thread-1  ]: Began running node model.youtubeAnalysis.video_stats_daily
[0m21:04:42.887928 [info ] [Thread-1  ]: 6 of 6 START sql view model youtubeDataAnalysis.video_stats_daily .............. [RUN]
[0m21:04:42.888759 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtubeAnalysis.video_stats_summary, now model.youtubeAnalysis.video_stats_daily)
[0m21:04:42.889381 [debug] [Thread-1  ]: Began compiling node model.youtubeAnalysis.video_stats_daily
[0m21:04:42.894102 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtubeAnalysis.video_stats_daily"
[0m21:04:42.895688 [debug] [Thread-1  ]: Began executing node model.youtubeAnalysis.video_stats_daily
[0m21:04:42.900234 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtubeAnalysis.video_stats_daily"
[0m21:04:42.901058 [debug] [Thread-1  ]: On model.youtubeAnalysis.video_stats_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "youtubeAnalysis", "target_name": "dev", "node_id": "model.youtubeAnalysis.video_stats_daily"} */


  create or replace view `third-flare-425403-c0`.`youtubeDataAnalysis`.`video_stats_daily`
  OPTIONS()
  as SELECT
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    category_title,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    trending_date,
    MAX(viewCount) AS viewCount,
    MAX(likeCount) AS likeCount,
    MAX(commentCount) AS commentCount
FROM `third-flare-425403-c0`.`youtubeDataAnalysis`.`combined_daily`
GROUP BY
    video_id,
    publishedAt,
    channel_Id,
    video_title,
    channel_Title,
    categoryId,
    duration_sec,
    dimension,
    definition,
    caption,
    licensedContent,
    madeForKids,
    category_title,
    trending_date;


[0m21:04:42.901547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:04:43.893701 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=third-flare-425403-c0&j=bq:US:c398a7de-909f-4d5a-966f-a0af9a9b1c32&page=queryresults
[0m21:04:44.304590 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f856e686-83f2-45b3-9273-66dd3722f90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465bab50>]}
[0m21:04:44.306262 [info ] [Thread-1  ]: 6 of 6 OK created sql view model youtubeDataAnalysis.video_stats_daily ......... [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m21:04:44.307215 [debug] [Thread-1  ]: Finished running node model.youtubeAnalysis.video_stats_daily
[0m21:04:44.308921 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:04:44.393481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:44.393705 [debug] [MainThread]: Connection 'model.youtubeAnalysis.video_stats_daily' was properly closed.
[0m21:04:44.393940 [info ] [MainThread]: 
[0m21:04:44.394167 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 9.34 seconds (9.34s).
[0m21:04:44.394954 [debug] [MainThread]: Command end result
[0m21:04:44.411149 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/manifest.json
[0m21:04:44.412104 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/semantic_manifest.json
[0m21:04:44.416184 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/divya21raj/Documents/Sunny_Documents/Projects/youtubeDataAnalysis/youtubeAnalysis/target/run_results.json
[0m21:04:44.416390 [info ] [MainThread]: 
[0m21:04:44.416632 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:04:44.416817 [info ] [MainThread]: 
[0m21:04:44.417015 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m21:04:44.417336 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.057269, "process_in_blocks": "0", "process_kernel_time": 0.445705, "process_mem_max_rss": "384466944", "process_out_blocks": "0", "process_user_time": 3.370489}
[0m21:04:44.417576 [debug] [MainThread]: Command `dbt run` succeeded at 21:04:44.417531 after 12.06 seconds
[0m21:04:44.417803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459ec700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8cf70>]}
[0m21:04:44.418009 [debug] [MainThread]: Flushing usage events
[0m21:04:44.942194 [debug] [MainThread]: An error was encountered while trying to flush usage events
